---
title: Custom Instrumentation
sidebar_order: 20
supported:
  - javascript
  - javascript.cordova
  - node
  - react-native
  - dotnet
  - python
  - go
  - java
  - android
  - ruby
  - java.spring-boot
  - apple
  - unity
  - dart
  - flutter
  - rust
  - native
  - php
notSupported:
  - native.breakpad
  - native.crashpad
  - native.minidumps
  - unreal
  - native.wasm
description: "Learn how to capture performance data on any action in your app."
redirect_from:
  - /performance/custom-instrumentation
---


<Note>

This is just a THOUGHT experiment and should not be merged!

</Note>



## Creating Spans

```javascript
function doWork() {
  const result = Sentry.startSpan({ name: "Important Function" }, () => {
    return expensiveFunction();
  });
}
```

## Creacting Nested Spans

If you have a distinct sub-operation you’d like to track as a part of another one, you can create spans to represent the relationship:

```javascript
function doWork() {
  const result = Sentry.startSpan({ name: "Parent Span" }, () => {
    return expensiveParentFunction();

    const res = Sentry.startSpan({ name: "Child Span" }, () => {
      return expensiveChildFunction();
    });
  });
}
```


## Creating Spans with Decorators

It’s common to have a single span track the execution of an entire function. In that scenario, there is a decorator you can use to reduce code:

```javascript
???

// TBD
```

Use of the decorator is equivalent to creating the span inside do_work() and ending it when do_work() is finished.

The function name will be used as the spans name.


## Creating Spans That Need Manual Finishing

Sometimes you do not want to use context managers, and do want to finish spans on your own. You can do this:

```javascript
const parentSpan = Sentry.startSpan({ name: "Parent Span" });

parentWork();

const childSpan = Sentry.startSpan({ name: "Child Span" });

childWork();

childSpan.finish();
parentSpan.finish();
```

If you want to create independend spans that are not in a parent/child relation ship a as above you can create them like this:

```javascript
const span1 = Sentry.startSpan({ name: "first-step", independend: true });

firstStep();

const span2 = Sentry.startSpan({ name: "second-step", independend: true });

secondStep();

const span3 = Sentry.startSpan({ name: "third-step", independend: true });

thirdStep();

span1.finish();
span2.finish();
span3.finish();
```

Now there will be no child relation between the spans, they will be siblings in the span tree.


## Accessing the Current Span

Sometimes it’s helpful to access whatever the current span is at a point in time so that you can enrich it with more information.

```javascript
const currentSpan = Sentry.getActiveSpan();
// enrich 'currentSpan' with some information
```

## Add Data to a Span

You can add additional data to a span so it carries more information about the current operation that it’s tracking.

```javascript
const currentSpan = Sentry.getActiveSpan();

currentSpan?.setData("operation.value", 1);
currentSpan?.setData("operation.name", "Saying hello!");
currentSpan?.setData("operation.other-stuff", [1, 2, 3]);
```
