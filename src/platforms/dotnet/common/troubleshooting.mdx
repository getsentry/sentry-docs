---
title:  Troubleshooting
sidebar_order: 100
description: "Learn more about how to troubleshoot common issues with the .NET SDK. "
---

## Sentry CLI not configured

The following message may appear in your build output:

> The Sentry CLI is not fully configured with authentication, organization, and project.

The message currently appears as information only, though we may change it to a warning in the future.
This means that you are building in `Release` configuration, and you have not fully configured
[MSBuild for Sentry CLI](../configuration/msbuild/).  You can handle this in one of the following ways:

- You can enable the Sentry CLI in your build by providing configuration details, as described in [the documentation here](../configuration/msbuild/).

- You can prevent the message from being generated by setting the property `<UseSentryCLI>false</UseSentryCLI>` in your .NET project file,
  or with `/p:UseSentryCLI=false` on the command line to `dotnet build` or `msbuild`.  Sentry CLI will be disabled.

- You can do nothing, and just ignore the message.  Sentry CLI will be disabled.

Keep in mind that if the Sentry CLI is disabled, then debug information files such as PDB symbols
will not be sent to Sentry.  If Sentry cannot locate symbols, then it cannot perform symbolication of stack traces.
This means that for some types of projects (depending on configuration), you may not see filenames and line numbers
to help you locate the source of an exception.

## The event is dropped by Sentry because it's too large

> Sentry: (Error) Sentry rejected the envelope 5bfe4129cb2446c08768b16479865035. Status code: RequestEntityTooLarge. Error detail: failed to read request body. Error causes: A payload reached size limit..

You can have the [Sentry .NET SDK write these envelopes to a path](https://github.com/getsentry/sentry-dotnet/blob/e62013ca63436d2a786fb229570e96f42c7c4044/src/Sentry/Http/HttpTransportBase.cs#L341-L363) in order to troubleshoot why they are too large.
Set the environment variable `SENTRY_KEEP_LARGE_ENVELOPE_PATH` to the directory you want these to be written to.
Make sure the process the SDK is running in has write access to it.

## User IP address in Sentry shows up as the server IP

If you're using a proxy server that relies on `X-Forwarded-For`, you might need to [configure ASP.NET Core
so that it's aware of it](https://docs.microsoft.com/aspnet/core/host-and-deploy/proxy-load-balancer).

See [this GitHub issue](https://github.com/getsentry/sentry-dotnet/issues/258) for more context.

## Unhandled exceptions are not captured when using an async `Main` method

Starting with C# 7.1, a program's [`Main` method](https://docs.microsoft.com/dotnet/csharp/fundamentals/program-structure/main-command-line) can be declared either synchronously or asynchronously. However, the asynchronous approach is not fully compatible with the Sentry SDK. If your application uses an async `Main` method, the Sentry SDK will be disposed before an unhandled exception can be captured.

In other words, this is insufficient:

```csharp
static async Task Main()
{
    using var _ = SentrySdk.Init(o => { /* your options */ });
    await DoSomethingAsync(); // an unhandled exception here will not be captured by Sentry
}
```

There are two different ways to work around this issue:

- You can avoid unhandled exceptions by wrapping your code in a try/catch block:
  ```csharp
  static async Task Main()
  {
      using var _ = SentrySdk.Init(o => { /* your options */ });
      try
      {
          await DoSomethingAsync();
      }
      catch (Exception ex)
      {
          SentrySdk.CaptureException(ex);
      }
  }
  ```

- You can use a synchronous `Main` method to ensure the Sentry SDK isn't disposed prematurely:

  ```csharp
  static void Main()
  {
      using var _ = SentrySdk.Init(o => { /* your options */ });
      MainAsync().GetAwaiter().GetResult();
  }

  static async Task MainAsync()
  {
      await DoSomethingAsync();
  }
  ```

  Note that with this approach, it is not advised to use `.Wait()` or `.Result`, as that would wrap unhandled exceptions in an `AggregateException`.

See [this GitHub issue](https://github.com/getsentry/sentry-dotnet/issues/321) for more context.

<PlatformContent includePath="troubleshooting" />
