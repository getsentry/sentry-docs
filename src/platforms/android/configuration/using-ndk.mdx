---
title: Android Native Development Kit (NDK)
sidebar_order: 2
redirect_from:
  - /platforms/android/advanced-usage/
  - /platforms/android/using-ndk/
description: "Learn how to configure the NDK integration."
---

The Android Native Development Kit (NDK) allows you to implement parts of your app in native code, using languages such as C and C++.

NDK integration is packed with the SDK and requires API level 16. The package `sentry-android-ndk` works by bundling Sentry's native SDK, [`sentry-native`](/platforms/native/). As a result, even if a native library in your app causes the crash, Sentry is able to capture it.

You can [disable the NDK integration](#disable-ndk-integration), use our Sentry Android SDK [without the NDK](#using-the-sdk-without-the-ndk), and support devices on [API levels lower than 16](#api-level-lower-than-16).

## Symbolicate Stack Traces

To symbolicate the stack trace from native code, we need to have access to the debug symbols of your application.

Use the [Sentry Android Gradle Plugin](/platforms/android/configuration/gradle/) to upload the debug symbols and sources automatically.

Alternatively, in case you're not using Gradle, you can upload your `.so` files manually via `sentry-cli`.
Please check the full documentation on [uploading files](/platforms/android/data-management/debug-files/upload/) to learn more about the upload of the debug symbols.

## Allowing the Compiler to Link Libraries

To use the Android NDK in your native code, include the Sentry NDK libraries into your project so that the compiler can link the libraries during the build.

To do so, use the AndroidNativeBundle Gradle plugin that copies the native libraries from the Sentry NDK into the location that can provide links via the `CmakeLists.txt` configuration file.

First, we need to declare the dependency in the project build.gradle file:

```groovy {filename:build.gradle}
buildscript {
    repositories {
        mavenCentral()
    }

    dependencies {
        // Add the line below, the plugin that copies the binaries
        // https://github.com/howardpang/androidNativeBundle/releases
        classpath 'io.github.howardpang:androidNativeBundle:{version}'
    }
}
```

Once the dependency is declared, you can use it in the application `build.gradle`:

```groovy
apply plugin: 'com.ydq.android.gradle.native-aar.import'
```

Then update the `CmakeLists.txt` configuration to link the Sentry NDK libraries:

```
# include paths generated by androidNativeBundle
include (${ANDROID_GRADLE_NATIVE_BUNDLE_PLUGIN_MK})
# change native-lib to your native lib's name
target_link_libraries(native-lib ${ANDROID_GRADLE_NATIVE_MODULES})
```

Now you can use the Sentry NDK API just by including the `sentry.h` in your code:

```c
#include <jni.h>
#include <android/log.h>
#include <sentry.h>

#define TAG "sentry-android-demo"
extern "C" JNIEXPORT jstring JNICALL

Java_io_sentry_demo_NativeDemo_crash(JNIEnv *env, jclass cls) {
    __android_log_print(ANDROID_LOG_WARN, "", "Capture a message.");
    sentry_value_t event = sentry_value_new_message_event(
            /*   level */ SENTRY_LEVEL_INFO,
            /*  logger */ "custom",
            /* message */ "Sample message!"
    );
    sentry_capture_event(event);
}
```

## Disable NDK Integration

You can disable the NDK integration by adding the following to your `AndroidManifest.xml`:

```xml {filename:AndroidManifest.xml}
<application>
    <meta-data android:name="io.sentry.ndk.enable" android:value="false" />
</application>
```

## Using the SDK without the NDK

You can use Sentry's Android SDK without the Android Native Development Kit (NDK) by either:

- [Disabling the NDK](#disable-ndk-integration)
- Using `sentry-android-core`, which doesn't contain the NDK and can be used separately instead of `sentry-android`, when adding the dependency. The minimal required API level for `sentry-android-core` is 14.

If you're using our [Gradle plugin](/platforms/android/configuration/gradle/), it'll still pull the NDK integration in as part of the auto-installation feature. To disable it, remove the `sentry-android-ndk` dependency from the app configurations in `app/build.gradle`:

```groovy
configurations.configureEach {
  exclude group: "io.sentry", module: "sentry-android-ndk"
}
```

```kotlin
configurations.configureEach {
  exclude(group = "io.sentry", module = "sentry-android-ndk")
}
```

## API Level Lower Than 16

To support the devices on the API level lower than 16, update your `AndroidManifest.xml`:

```xml {filename:AndroidManifest.xml}
<manifest>
    <!-- Merging strategy for the imported manifests -->
    <uses-sdk tools:overrideLibrary="io.sentry.android" />
</manifest>
```

With these changes the SDK will be enabled on all devices with API level ≥ 14 and the SDK with NDK will be enabled on all devices with API level ≥ 16.

## Troubleshooting

### Missing Debug Images or Unsymbolicated Stack Traces

Unsymbolicated stack traces may be caused by module-caching on the SDK side. Be sure to clear any existing module cache if your modules are loaded dynamically:

```cpp
// load a new module
sentry_clear_modulecache();
```
