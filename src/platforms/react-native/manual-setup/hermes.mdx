---
title: Hermes
sidebar_order: 30
description: "Learn about using the Hermes engine with our React Native SDK."
redirect_from:
  - /platforms/react-native/hermes/
---

Sentry added support for `react-native` builds that use the `hermes` engine, which required changes to the sentry SDK, `sentry-cli` as well as Sentry itself.

Sentry customers using the SaaS product (sentry.io) will need to update the SDK, and `sentry-cli`.
The minimum required version for the SDK is `@sentry/react-native` [SDK version `1.3.3`](https://github.com/getsentry/sentry-react-native/releases/tag/1.3.3),
and `@sentry/cli` [version `1.51.1`](https://github.com/getsentry/sentry-cli/releases/tag/1.51.1).

For self-hosted Sentry users, the minimum version required is [f07352b](https://hub.docker.com/r/getsentry/sentry/tags?page=1&name=f07352b).

Once you have the minimum version of the SDK, Sentry provides the standard integration as described in the [React Native Sentry documentation](/platforms/react-native/).

<Note>

If you are using Hermes, you should not have the [RAM bundles](/platforms/react-native/manual-setup/ram-bundles/) feature enabled. In Hermes, when loading the bytecode, `mmap` ensures that the entire file is not loaded. Using Hermes with RAM bundles might lead to issues, because those mechanisms are not compatible with each other.

</Note>

## Source Maps

If you do not need custom source maps, the `sentry.gradle` build step fully supports Hermes source maps.

## Custom Source Maps

This document walks through the steps to manually generate and upload custom source maps. When generating your source maps, it's important to match the steps of your React Native tooling exactly, otherwise the generated bundle won't work correctly, and your errors may point to unrelated lines.

The React Native tooling steps are extracted from [`react-native-xcode.sh`](https://github.com/facebook/react-native/blob/0.71-stable/scripts/react-native-xcode.sh) for iOS and from [`BundleHermesCTask.kt`](https://github.com/facebook/react-native/blob/0.71-stable/packages/react-native-gradle-plugin/src/main/kotlin/com/facebook/react/tasks/BundleHermesCTask.kt) for Android.

<Note>

[`BundleHermesCTask.kt`](https://github.com/facebook/react-native/blob/0.71-stable/packages/react-native-gradle-plugin/src/main/kotlin/com/facebook/react/tasks/BundleHermesCTask.kt) is only available from version `0.71` on. For previous versions, use [`react.gradle`](https://github.com/facebook/react-native/blob/0.70-stable/react.gradle).

</Note>

### Compile Source maps

Depending on how your app bundle was generated not all these compilation steps are required:

- If you use `EXTRA_PACKAGER_ARGS` on `iOS`, only the first step applies. This is the default behavior if you used [`@sentry/wizard`](/platforms/react-native/#install).
- If you use [`SOURCEMAP_FILE`](https://reactnative.dev/docs/sourcemaps#enable-source-maps-on-ios), all steps are necessary.

<Note>

We recommend using the bundle and source maps generated by React Native tooling. If you are having issues with the manually generated artifacts see [this issue](https://github.com/facebook/react-native/issues/34043) for more information.

</Note>

1. Bundle/minify with `metro` (`react-native`) to get the bundle (`.bundle` or `.jsbundle`) and packager source map (`.map`):

<Note>

React Native [`0.70`](https://github.com/facebook/react-native/blob/e3a5fbe72f966b27b967192317d7072db52d1c8c/scripts/react-native-xcode.sh#L141) and CodePush Update minifies the packager bundle by default.

</Note>

```bash {tabTitle:Android}
npx react-native bundle --platform android --dev false --entry-file index.js --reset-cache --bundle-output index.android.bundle --sourcemap-output index.android.bundle.packager.map --minify false
```

```bash {tabTitle:iOS}
npx react-native bundle --platform ios --dev false --entry-file index.js --reset-cache --bundle-output main.jsbundle --sourcemap-output main.jsbundle.map --minify false
```

2. Compile to bytecode using `hermes` to get the compiler source map (`.hbc.map`):

<Note>

`OS-BIN` is `osx-bin`, `win64-bin`, or `linux64-bin`, depending on which operating system you are using.

</Note>

If you're using Hermes with **React Native 0.68 or below**:

```bash {tabTitle:Android}
node_modules/hermes-engine/{OS-BIN}/hermesc -O -emit-binary -output-source-map -out=index.android.bundle.hbc index.android.bundle
rm -f index.android.bundle
mv index.android.bundle.hbc index.android.bundle
```

```bash {tabTitle:iOS}
ios/Pods/hermes-engine/destroot/bin/hermesc -O -emit-binary -output-source-map -out=main.jsbundle.hbc main.jsbundle
rm -f main.jsbundle
mv main.jsbundle.hbc main.jsbundle
```

Starting with **React Native 0.69**, `hermes` has been [shipped with React Native](https://reactnative.dev/blog/2022/06/21/version-069#bundled-hermes), so you should use `hermesc` from `react-native`:

```bash {tabTitle:Android}
node_modules/react-native/sdks/hermesc/{OS-BIN}/hermesc -O -emit-binary -output-source-map -out=index.android.bundle.hbc index.android.bundle
rm -f index.android.bundle
mv index.android.bundle.hbc index.android.bundle
```

```bash {tabTitle:iOS}
ios/Pods/hermes-engine/destroot/bin/hermesc -O -emit-binary -output-source-map -out=main.jsbundle.hbc main.jsbundle
rm -f main.jsbundle
mv main.jsbundle.hbc main.jsbundle
```

3. Merge the two source maps using `compose-source-maps` to get the final source map (`.map`):

```bash {tabTitle:Android}
node node_modules/react-native/scripts/compose-source-maps.js index.android.bundle.packager.map index.android.bundle.hbc.map -o index.android.bundle.map
```

```bash {tabTitle:iOS}
mv main.jsbundle.map main.jsbundle.packager.map
node node_modules/react-native/scripts/compose-source-maps.js main.jsbundle.packager.map main.jsbundle.hbc.map -o main.jsbundle.map
```

### Upload the Bundle and Source Maps

Upload your source maps following [Step 3 on the normal source maps guide](/platforms/react-native/sourcemaps/#3-upload-the-bundle-and-source-maps).

<Note>

You will upload the `index.android.bundle` and `index.android.bundle.map` for Android, `main.jsbundle` and `main.jsbundle.map` for iOS.

</Note>

<Note>

When uploaded, the `index.android.bundle` file will be sized at 0 bytes. This is expected with Hermes bytecode and won't affect the source maps resolution.

</Note>

### Upload Using Sentry Fastlane Plugin

To upload generated sourcemaps using Fastlane, use the `sentry_upload_sourcemap` action. See how to install Sentry Fastlane Plugin [here](https://github.com/getsentry/sentry-fastlane-plugin).

```ruby {tabTitle:Android}
sentry_upload_sourcemap(
  auth_token: 'YOUR_AUTH_TOKEN',
  org_slug: '___ORG_SLUG___',
  project_slug: '___PROJECT_SLUG___',
  version: '...',
  app_identifier: '...', # bundle_identifer of your app
  build: '...', # optional build number of your app
  dist: '...', # optional distribution of the release usually the buildnumber
  sourcemap: ['index.android.bundle', 'index.android.bundle.map'],
  rewrite: true
)
```

```ruby {tabTitle:iOS}
sentry_upload_sourcemap(
  auth_token: 'YOUR_AUTH_TOKEN',
  org_slug: '___ORG_SLUG___',
  project_slug: '___PROJECT_SLUG___',
  version: '...',
  app_identifier: '...', # bundle_identifer of your app
  build: '...', # optional build number of your app
  dist: '...', # optional distribution of the release usually the buildnumber
  sourcemap: ['main.jsbundle', 'main.jsbundle.map'],
  rewrite: true
)
```
