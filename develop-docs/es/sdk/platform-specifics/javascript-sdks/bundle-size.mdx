---
title: Tamaño del bundle
description: Por qué nos lo pensamos dos veces antes de añadir una nueva línea de código al SDK
sidebar_order: 11
---

A diferencia de la mayoría de los demás SDK, debemos tener mucho cuidado con cuánto código añadimos a los SDK para navegador y _cómo_ lo hacemos.
La razón es que el código del SDK para navegador (con la excepción de nuestro Loader) se carga de forma síncrona, ya sea en su propio bundle de JS o en el bundle principal de JS de la aplicación web del frontend.

Por lo tanto, nuestro SDK contribuye directamente al tamaño del bundle de la página y puede afectar al rendimiento de la página.

<div id="what-do-we-do-against-it">
  ## ¿Qué hacemos al respecto?
</div>

Bueno, no podemos simplemente dejar de desarrollar nuevas funciones o correcciones. Pero podemos ser inteligentes al respecto:

- Ejecutamos comprobaciones del tamaño del bundle en cada PR para medir posibles aumentos (o reducciones) de tamaño.
- Nuestra configuración de CI falla si el tamaño del bundle supera cierto umbral para combinaciones específicas de empaquetado.
- Tenemos reglas de lint contra cierta sintaxis que aumenta el tamaño del bundle más de lo necesario.
- Al revisar los PR, prestamos atención al impacto en el tamaño del bundle de los cambios e intentamos identificar oportunidades de optimización.

Lo más importante: siempre que añadimos una nueva función, intentamos escribirla de forma que se pueda tree-shakear.

<div id="writing-tree-shakeable-code">
  ### Escribir código compatible con el tree-shaking
</div>

Si quieres contribuir con una nueva funcionalidad al SDK, recuerda diseñarla de forma opcional (opt‑in) y compatible con el tree-shaking.
En la mayoría de los casos, esto significa implementar la funcionalidad como una `Integration` o —útil para funcionalidades más pequeñas— como una exportación del paquete que los usuarios puedan importar.

En particular, al crear integraciones, ten en cuenta que escribir una integración no implica que deba ser opcional para los usuarios por defecto.
Si la consideramos lo suficientemente valiosa, podemos añadir una integración de forma predeterminada, lo cual, sí, aumentará el tamaño del bundle para muchos usuarios.
Sin embargo, los usuarios aún pueden configurar el [tree-shaking avanzado](https://docs.sentry.io/platforms/javascript/configuration/tree-shaking/) para eliminar las integraciones que no necesiten.
Lo importante es que crear integraciones habilita el tree-shaking.

Teniendo en cuenta lo anterior, hacer que los usuarios adopten una funcionalidad que debe seguir siendo compatible con el tree-shaking implica que no podemos habilitarla con un simple flag en el SDK.
En su lugar, necesitamos que los usuarios importen la funcionalidad explícitamente y la registren:

```js
// No se puede eliminar con tree-shaking
Sentry.init({
  enableReplay: true, // internamente: if (enableReplay) { ...código de replay }
});

// Se puede eliminar con tree-shaking
Sentry.init({
  integrations: [replayIntegration()],
});
```


<div id="what-were-not-doing">
  ## Lo que no estamos haciendo
</div>

Como en todo, hay excepciones a estas reglas y en el pasado hemos añadido funciones que aumentan el tamaño.

- Aunque somos cautos con el tamaño del paquete (bundle), eso no significa que no añadamos cosas nuevas al SDK.
- Si un cambio aporta suficiente valor como para habilitarlo por defecto, aumentaremos el tamaño del paquete.
- Si corregir un comportamiento incorrecto requiere más código, aumentaremos el tamaño del paquete.
- No sacrificamos por completo la legibilidad del código en favor del tamaño del paquete. Procuramos encontrar un equilibrio.