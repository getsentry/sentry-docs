---
title: IDs de depuración
description: Requisitos para que el SDK de JS detecte los IDs de depuración
sidebar_order: 12
---

<div id="requirements">
  ## Requisitos
</div>

Esta sección describe todo lo necesario para que Sentry y el SDK de Sentry detecten los Debug IDs y desminifiquen/simboliquen archivos JavaScript.
Explica las modificaciones necesarias en los artefactos generados para que el mapeo de código fuente funcione.

Seguimos nuestra [propuesta de Debug ID de TC39](https://github.com/tc39/source-map/blob/main/proposals/debug-id.md). Sin embargo, como los Debug IDs aún no son un estándar, necesitamos emplear una solución alternativa.

<div id="the-shape-of-debug-ids">
  ### El formato de los Debug IDs
</div>

Los Debug IDs deben ser UUID, p. ej., `85314830-023f-4cf1-a267-535f4e37bb17`. La versión del UUID no importa.

<div id="debug-id-references">
  ### Referencias de Debug ID
</div>

Incorpora Debug IDs en los archivos JavaScript y en su mapa de origen (source map) para la indexación en Sentry.

Los archivos JavaScript deben tener un comentario `//# debugId=...` al final:

```js
"use strict";
console.log("¡Hola, mundo!");
//# debugId=85314830-023f-4cf1-a267-535f4e37bb17
```

Si un archivo JS tiene una referencia a un mapa de fuentes, agrega el comentario `debugId` después del comentario `sourceMappingURL`:

```js
"use strict";
console.log("Hello world!");
//# sourceMappingURL=index.js.map
//# debugId=85314830-023f-4cf1-a267-535f4e37bb17
```

El mapa de origen correspondiente debe incluir el mismo Debug ID utilizando ambos campos `debug_id` y `debugId` para garantizar la compatibilidad:

```json
{
  "version": 3,
  "file": "index.js",
  "sources": [],
  "sourcesContent": [],
  "names": [],
  "mappings": "...",
  "debug_id": "85314830-023f-4cf1-a267-535f4e37bb17",
  "debugId": "85314830-023f-4cf1-a267-535f4e37bb17"
}
```

Dado que los entornos de ejecución de JS no proporcionan acceso al comentario `//# debugId=...`, informa al SDK de Sentry sobre los Debug IDs de todos los archivos JavaScript cargados mediante una variable global.

Precede cada archivo JavaScript con un fragmento que escriba la información del archivo y los Debug IDs en una variable global. **Asegúrate de que cualquier cambio en un archivo JavaScript también actualice los `mappings` en el mapa de origen correspondiente.**

El fragmento debería verse así:

```js
{
  var globalObject =
    typeof window !== "undefined"
      ? window
      : typeof global !== "undefined"
        ? global
        : typeof self !== "undefined"
          ? self
          : {};

  var stack = new globalObject.Error().stack;

  if (stack) {
    globalObject._sentryDebugIds = globalObject._sentryDebugIds || {};
    globalObject._sentryDebugIds[stack] =
      "85314830-023f-4cf1-a267-535f4e37bb17";
  }
}
```

Este fragmento crea un error para capturar la traza de pila, que incluye el nombre y la ruta del archivo. La traza de pila se usa como clave para asociarla con el Debug ID de ese archivo dentro de un objeto global `_sentryDebugIds`. El SDK de Sentry extrae los Debug IDs y los nombres de archivo de este objeto cuando se captura un error.

Puedes minificar este fragmento en una sola línea, lo que simplificará la actualización de los `mappings` del mapa de orígenes.
