---
title: Desarrollo con ngrok
description: Este documento explica cómo usar ngrok con el servidor de desarrollo.
sidebar_title: ngrok
sidebar_order: 70
---

<div id="using-ngrok">
  # Uso de Ngrok
</div>

El servidor de desarrollo puede ejecutarse detrás de ngrok cuando necesites recibir tráfico desde el exterior. Esto es común al trabajar con integraciones.

Se recomienda usar `getsentry` al trabajar con integraciones, ya que configurará automáticamente las opciones correctas por ti.

Nota: si las siguientes instrucciones no funcionan y estás usando `getsentry`, verifica si hay alguna configuración definida para tu entorno que esté actualizando las siguientes opciones y configuraciones:

```
SENTRY_OPTIONS["system.url-prefix"]
SENTRY_OPTIONS["system.base-hostname"]
SENTRY_FEATURES["system:multi-region"]

CSRF_TRUSTED_ORIGINS
ALLOWED_HOSTS
SESSION_COOKIE_DOMAIN
CSRF_COOKIE_DOMAIN
SUDO_COOKIE_DOMAIN
```

`dev.py` en `getsentry` debería configurar automáticamente los valores correctos para estas configuraciones.


<div id="ngrok-in-monolith-mode">
  ## Ngrok en modo monolith
</div>

Los siguientes pasos configurarán ngrok en modo `monolith`:

<div id="step-1-create-ngrok-config-file">
  ### Paso 1: Crear el archivo de configuración de Ngrok
</div>

Empieza por definir un archivo de configuración para `ngrok`, por ejemplo `ngrok.yml`:

```yaml
version: '2'
authtoken: <TU-NGROK-AUTHTOKEN>
tunnels:
  acme-org:
    proto: http
    hostname: <tunombre>.ngrok.io
    addr: 8000
    host_header: "rewrite"
```

Puedes obtener tu token de autenticación en https://dashboard.ngrok.com/get-started/your-authtoken


<div id="step-2-start-ngrok">
  ### Paso 2: Inicia Ngrok
</div>

Ahora, inicia ngrok con tu archivo de configuración:

```shell
ngrok start --all --config ngrok.yml
```


<div id="step-3-start-devserver">
  ### Paso 3: Inicia el servidor de desarrollo
</div>

Al iniciar el servidor de desarrollo, usa la opción `--ngrok`:

```shell
getsentry devserver --ngrok=<tunombre>.ngrok.io
```


<div id="ngrok-in-silo-mode">
  ## Ngrok en modo silo
</div>

Para depurar problemas relacionados con el middleware de integración, así como la latencia provocada por llamadas RPC, puedes ejecutar tu entorno local en modo silo.

Para obtener más información sobre cómo funciona el modo silo en el entorno de desarrollo, consulta <Link to="/development/environment/#running-siloed-instances">Instancias en silo</Link>.

<div id="step-1-split-local-db-into-silos">
  ### Paso 1: Dividir la base de datos local en silos
</div>

De forma predeterminada, `sentry devserver` ejecuta un servidor de aplicaciones en modo monolito. También puedes ejecutar `devserver` con instancias de aplicación en silos. Antes de hacerlo, debes <Link to="/backend/database-migrations/#cloning-a-monolith-database">crear bases de datos separadas por silos</Link>.

<div id="step-2-create-ngrok-config-file">
  ### Paso 2: Crear el archivo de configuración de ngrok
</div>

Para combinar ngrok con servidores de desarrollo locales, necesitarás reservar varios dominios en ngrok y crear un archivo de configuración para ngrok:

```yaml
version: "2"
authtoken: <TU-NGROK-AUTHTOKEN>
tunnels:
  acme-org:
    proto: http
    hostname: acme-org.<tunombre>.ngrok.io
    addr: 8000
  control-silo:
    proto: http
    hostname: <tunombre>.ngrok.io
    host_header: "rewrite"
    addr: 8000
  region-silo:
    proto: http
    hostname: us.<tunombre>.ngrok.io
    addr: 8010
    host_header: "rewrite"
```


<div id="step-3-start-ngrok">
  ### Paso 3: Inicia Ngrok
</div>

Ahora inicia Ngrok con tu archivo de configuración:

```shell
ngrok start --all --config region.yml
```


<div id="step-4-start-devserver">
  ### Paso 4: Iniciar el servidor de desarrollo
</div>

En dos ventanas de terminal separadas, inicia el servidor de desarrollo para los silos de control y de región:

Primero, inicia el taskbroker:

```shell
devservices up --mode=taskbroker
```

```shell
getsentry devserver --ngrok <tu-nombre>.ngrok.io --workers --celery-beat --silo=region
getsentry devserver --ngrok <tu-nombre>.ngrok.io --workers --celery-beat --silo=control
```

Esta configuración hará que tanto los servidores de región como el de control respondan en dominios distintos. La configuración multirregional con ngrok también habilita los dominios de cliente y necesitarás dominios de ngrok para cada organización que planees usar. En esta configuración, CORS funcionará de forma similar a producción.


<div id="setting-up-integrations">
  ### Configuración de integraciones
</div>

Al configurar integraciones para tu entorno local y la configuración anterior, debes agregar los secretos y las configuraciones de las integraciones en el archivo `getsentry/conf/settings/devlocal.py`.