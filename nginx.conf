add_header X-Frame-Options sameorigin always;
add_header X-Content-Type-Options nosniff always;
add_header X-XSS-Protection "1; mode=block" always;

add_header Content-Security-Policy-Report-Only "upgrade-insecure-requests; default-src 'none'; script-src 'self' 'unsafe-inline' www.googletagmanager.com www.google-analytics.com; connect-src 'self' sentry.io *.algolia.net; img-src 'self' www.google-analytics.com; style-src 'self' 'unsafe-inline'; font-src 'self'; report-uri https://sentry.io/api/1297620/security/?sentry_key=b3cfba5788cb4c138f855c8120f70eab" always;

rewrite ^/(?:hosted|on-premise)/(.*)$ /$1$is_args$args redirect;

# develop redirects
rewrite ^/internal/?$ https://develop.sentry.dev/ redirect;
rewrite ^/internal/(api|docs|contributing|environment)/?$ https://develop.sentry.dev/ redirect;
rewrite ^/development/contribute/(.*)$ https://develop.sentry.dev/ redirect;
rewrite ^/development/server/(.*)$ https://develop.sentry.dev/ redirect;
rewrite ^/development/sdk-dev/(.*)$ https://develop.sentry.dev/sdk/ redirect;
rewrite ^/clientdev/(.*)$ https://develop.sentry.dev/sdk/ redirect;
rewrite ^/server/config/?$ https://develop.sentry.dev/config/ redirect;
# /develop redirects

# self-hosting redirects
rewrite ^/server/(.*)$ https://develop.sentry.dev/self-hosted/ redirect;
# /self-hosting redirects

rewrite ^/learn/cli/(configuration|dif|installation|releases|send-event)/?$ /cli/$1/$is_args$args redirect;
rewrite ^/learn/cli/(breakpad|dsym|elf|pdb|proguard)/?$ /cli/dif/$is_args$args redirect;
rewrite ^/cli/dif/(breakpad|dsym|elf|pdb|proguard)/?$ /cli/dif/$is_args$args redirect;

location = /api/releases/post-project-releases/ {
  return 302 /api/releases/create-a-new-release-for-an-organization/$is_args$args;
}

location = /api/releases/delete-project-release-details/ {
  return 302 /api/releases/delete-organization-release-details/$is_args$args;
}

location = /api/releases/put-project-release-details/ {
  return 302 /api/releases/put-organization-release-details/$is_args$args;
}

location = /api/releases/get-project-releases/ {
  return 302 /api/releases/get-organization-releases/$is_args$args;
}

location = /api/projects/post-project-user-reports/ {
  return 302 /api/projects/submit-user-feedback/
}

location = /api/projects/post-project-keys/ {
  return 302 /api/projects/create-a-new-client-key/
}

location = /api/events/get-group-events-latest/ {
  return 302 /api/events/retrieve-the-latest-event-for-an-issue/
}

location = /api/organizations/get-event-id-lookup/ {
  return 302 /api/organizations/resolve-an-event-id/
}

location = /api/events/get-project-group-index/ {
  return 302 /api/events/list-a-projects-issues/
}

location = /api/events/get-group-hashes/ {
  return 302 /api/events/list-an-issues-hashes/
}

location = /api/projects/get-project-stats/ {
  return 302 /api/projects/retrieve-event-counts-for-a-project/
}

location = /api/projects/get-project-index/ {
  return 302 /api/projects/list-your-projects/
}

location = /api/organizations/get-organization-users/ {
  return 302 /api/organizations/list-an-organizations-users/
}

location = /api/events/get-group-details/ {
  return 302 /api/events/retrieve-an-issue/
}

location = /api/events/get-project-event-details/ {
  return 302 /api/events/retrieve-an-event-for-a-project/
}

location = /api/events/get-group-tag-key-details/ {
  return 302 /api/events/retrieve-tag-details/
}

location = /api/organizations/get-organization-projects/ {
  return 302 /api/organizations/list-an-organizations-projects/
}

location = /api/releases/post-project-release-files/ {
  return 302 /api/releases/upload-a-new-project-release-file/
}

location = /api/projects/get-project-users/ {
  return 302 /api/projects/list-a-projects-users/
}

location = /api/projects/put-project-details/ {
  return 302 /api/projects/update-a-project/
}

location = /api/projects/post-debug-files/ {
  return 302 /api/projects/upload-a-new-file/
}

location = /api/organizations/get-organization-stats/ {
  return 302 /api/organizations/retrieve-event-counts-for-an-organization/
}

location = /api/releases/post-organization-releases/ {
  return 302 /api/releases/create-a-new-release-for-an-organization/
}

location = /api/projects/get-project-keys/ {
  return 302 /api/projects/list-a-projects-client-keys/
}

location = /api/teams/get-organization-teams/ {
  return 302 /api/teams/list-an-organizations-teams/
}

location = /api/teams/post-team-projects/ {
  return 302 /api/teams/create-a-new-project/
}

location = /api/events/put-project-group-index/ {
  return 302 /api/events/bulk-mutate-a-list-of-issues/
}

location = /api/projects/delete-project-details/ {
  return 302 /api/projects/delete-a-project/
}

location = /api/events/get-group-events/ {
  return 302 /api/events/list-an-issues-events/
}

location = /api/organizations/get-organization-details/ {
  return 302 /api/organizations/retrieve-an-organization/
}
