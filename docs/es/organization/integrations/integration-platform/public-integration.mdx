---
title: Integraciones públicas
sidebar_order: 1
description: 'Obtén más información sobre las integraciones públicas, disponibles para todos los usuarios de Sentry.'
og_image: >-
  /og-images/organization-integrations-integration-platform-public-integration.png
---

<Alert>
  Hemos creado una [aplicación de ejemplo](https://github.com/getsentry/integration-platform-example) para ayudarte a empezar a desarrollar en la plataforma de integraciones de Sentry. Échale un vistazo para ver fragmentos de código útiles para añadir estas funciones en Python y TypeScript. Consulta la [documentación](/es/organization/integrations/integration-platform/#example-app) para obtener más información.
</Alert>

Las integraciones públicas están pensadas para el “público general” de usuarios de Sentry. Comienzan en un estado no publicado con fines de desarrollo y pueden enviarse más adelante para su aprobación y publicación. Para obtener más información, consulta la [sección de Publicación](#publication) de esta página.

Los ejemplos de código en las secciones a continuación muestran un posible caso de uso que implica una aplicación Flask que recibe webhooks de nuevos issues desde Sentry, llama a la API de Sentry para obtener más datos sobre el issue y lo envía a Pushover como generador de notificaciones en escritorio y móvil.

<div id="installation">
  ## Instalación
</div>

Los usuarios podrán instalar tus integraciones en la página de **Integrations** de [sentry.io](https://sentry.io). Si tu integración aún no está publicada, la única organización de Sentry que podrá verla o instalarla será la que la creó. Una vez publicada, al hacer clic en el nombre de la integración, los usuarios verán una descripción de la integración y los permisos que se concederán si deciden instalarla.

![Una lista de integraciones que un usuario puede instalar.](./img/integration-directory.png)

<div id="oauth-process">
  ## Proceso de OAuth
</div>

Después de la instalación, si tu usuario ha aprobado todos los permisos, Sentry generará un código de concesión y un ID de instalación. Esta información se envía mediante el webhook `installation.created` a la URL de webhook especificada en tu configuración.

Sin embargo, si tu integración tiene configurada una URL de redirección, la integración redirige el navegador del usuario a la URL configurada con el código de concesión y el ID de instalación en los parámetros de consulta.

Comienza a crear tu integración implementando el endpoint de la URL de redirección, `/setup`, que suele ser donde intercambias el código de concesión por un token que te permite realizar llamadas a la API de Sentry:

```python
import requests
from flask import redirect, request

@app.route('/setup', methods=['GET'])
def setup():
    code = request.args.get('code')
    install_id = request.args.get('installationId')

    url = u'https://sentry.io/api/0/sentry-app-installations/{}/authorizations/'
    url = url.format(install_id)

    payload = {
        'grant_type': 'authorization_code',
        'code': code,
        'client_id': 'your-client-id',
        'client_secret': 'your-client-secret',
    }

    resp = requests.post(url, json=payload)
    data = resp.json()

    token = data['token']
    refresh_token = data['refreshToken']
    # ... Almacena de forma segura install_id, token y refresh_token en la BD ...

    return redirect('https://sentry.io/settings/')
```

Todas las integraciones públicas pueden instalarse mediante una URL externa fija: `https://sentry.io/sentry-apps/<your-integration-slug>/external-install/`, que puedes poner a disposición de los usuarios. Consulta este ejemplo de `Linear`: https://sentry.io/sentry-apps/linear/external-install/. Nota: si un usuario tiene varias organizaciones, se le pedirá que elija en cuál quiere realizar la instalación desde un menú desplegable.

<div id="auth-tokens">
  ## Tokens de autenticación
</div>

Las integraciones públicas generan [tokens de autenticación](/es/organization/integrations/integration-platform/#auth-tokens) tras una [instalación de OAuth](#oauth-process) exitosa.
Estos tokens caducan automáticamente cada ocho horas, por lo que deben renovarse manualmente.

<div id="refreshing-tokens">
  ### Actualización de tokens
</div>

En la instalación inicial, necesitarás el código de autorización que recibiste ya sea en la solicitud del webhook de instalación o en la URL de redirección, además del ID de cliente y el secreto de cliente de tu integración:

```python
url = u'https://sentry.io/api/0/sentry-app-installations/{}/authorizations/'
url = url.format(install_id)

payload = {
    'grant_type': 'authorization_code',
    'code': code,
    'client_id': 'your-client-id',
    'client_secret': 'your-client-secret',
}
```

Los tokens caducan a las ocho horas, así que tendrás que renovarlos en consecuencia:

```python
def refresh_token(install_id):
    url = u'https://sentry.io/api/0/sentry-app-installations/{}/authorizations/'
    url = url.format(install_id)

    refresh_token = retrieve_refresh_token_from_db(install_id)

    payload = {
        'grant_type': 'refresh_token',
        'refresh_token': refresh_token,
        'client_id': 'your-client-id',
        'client_secret': 'your-client-secret',
    }

    resp = requests.post(url, json=payload)
    data = resp.json()

    new_token = data['token']
    new_refresh_token = data['refreshToken']
    # ... Actualiza de forma segura el token y el refresh_token en la BD...

    return new_token
```

Los datos que puedes esperar recibir tanto en el intercambio inicial del código de concesión como en las posteriores renovaciones del token son los siguientes:

```json
{
  "id": "38",
  "token": "ec48bf98637d44c294ead7566513686237e74ab67a074c64b3aaca2d93dbb8f1",
  "refreshToken": "c866f154a65841638d44ee26364409b0a1a67bd642bd46e7a476f34f810712d6",
  "dateCreated": "2019-08-07T20:25:09.870Z",
  "expiresAt": "2019-08-08T04:25:09.870Z",
  "state": null,
  "application": null
}
```

<div id="verifying-installations">
  ## Verificación de instalaciones
</div>

Por lo general, si ya tienes configurada la URL de redirección, tendrás que hacer algo de trabajo de tu lado para “finalizar” la instalación. Si es así, te recomendamos habilitar la opción “Verificar instalación” para tu integración. Una vez habilitada, deberás enviar una solicitud que marque la instalación como oficialmente “instalada”:

```python
requests.put(
    u'https://sentry.io/api/0/sentry-app-installations/{}/'.format(install_id),
    json={'status': 'installed'},
)
```

<div id="uninstallation">
  ## Desinstalación
</div>

Cuando un usuario desinstale tu integración, recibirás una solicitud `installation.deleted` en la URL de tu webhook. Para más información, consulta la [documentación completa de webhooks](/es/organization/integrations/integration-platform/webhooks/).

<div id="authorized-origins">
  ## Orígenes autorizados
</div>

Puedes usar tokens de autenticación desde el navegador si permites los orígenes de las páginas que hacen las solicitudes. En el campo &quot;Authorized JavaScript Origins&quot;, agrega cada origen (por ejemplo, docs.sentry.io) en una línea separada. No necesitas incluir el protocolo (http o https) en el origen. Actualmente no puedes usar comodines (por ejemplo, `*.sentry.io`), así que si tienes varios subdominios, tendrás que agregarlos individualmente.

<div id="image-requirements">
  ## Requisitos de imagen
</div>

Las integraciones públicas requieren cargar una imagen de logotipo. Los requisitos son:

* El tamaño del logotipo debe estar entre 256 × 256 px y 1024 × 1024 px
* El formato de archivo debe ser PNG
* El fondo debe ser transparente (a menos que el logotipo ocupe todo el espacio)

Si la integración tiene un [componente de UI](/es/organization/integrations/integration-platform/ui-components), también debes cargar un icono que cumpla estos requisitos:

* El tamaño del icono debe estar entre 256 × 256 px y 1024 × 1024 px
* El archivo debe ser un PNG en formato RGBA
* Todos los píxeles deben ser negros o transparentes

<div id="publication">
  ## Publicación
</div>

Cuando estés listo para el proceso de publicación, haz clic en &quot;Publish&quot; junto a la integración que quieres enviar. Esto enviará un correo electrónico a integrations-platform@sentry.io para informarnos de que tu integración está lista para revisión:

![Botones con las opciones de publicar o eliminar.](./img/publish-button.png)