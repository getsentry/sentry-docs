---
title: Explorador de trazas con métricas de spans
sidebar_order: 31
description: >-
  Aprende a usar el Explorador de trazas de Sentry para buscar datos de spans, encontrar
  trazas distribuidas y depurar problemas de rendimiento en toda tu pila de aplicaciones.
og_image: /og-images/product-explore-trace-explorer.png
---

El [**Explorador de trazas**](https://sentry.io/orgredirect/organizations/:orgslug/traces/) de Sentry está diseñado para facilitar y hacer más intuitiva la investigación de rendimiento. Ahora puedes explorar muestras de spans, visualizar atributos de spans y agregar tus datos con consultas y filtros flexibles. Esta guía te explicará los conceptos y las características clave del Explorador de trazas.

![Captura de pantalla del Explorador de trazas](./img/Trace_Explorer_home.png)

<div id="key-concepts">
  ## Conceptos clave
</div>

<div id="traces">
  ### Trazas
</div>

* Una traza representa una serie de transacciones o solicitudes dentro de un único sistema. Esto incluye sesiones del navegador del usuario, solicitudes HTTP, consultas a la base de datos, middleware, cachés y más.
* Recoge una serie de operaciones (*spans*) que muestran cómo interactuaron las distintas partes de tu aplicación durante cada transacción.
* Cada traza se identifica con un **Trace ID**, que puedes usar para seguir una solicitud a través de servicios o proyectos.
* Una [traza distribuida](/es/platforms/javascript/tracing/trace-propagation/#what-is-distributed-tracing) se compone de transacciones y spans que atraviesan múltiples servidores, clientes, edge workers y otras partes de tu sistema. Se construye pasando el Trace ID mediante los encabezados del navegador.

<div id="spans">
  ### Spans
</div>

* Un *span* representa una operación individual dentro de un trace. Puede ser una consulta a la base de datos, una solicitud HTTP o una tarea de renderizado de la UI.
* Cada span tiene:
  * **Atributos**: Pares clave-valor como `http.method`, `db.query`, `span.description`, o atributos personalizados como `cart.value`, que proporcionan contexto adicional útil para depuración e investigación de patrones. Estos son números o cadenas. Nota: los atributos numéricos de un span pueden usarse para calcular **métricas del span**, como se muestra a continuación.
  * **Duración (`span.duration`)**: El tiempo que tardó la operación, usado para medir el rendimiento.

<div id="span-metrics">
  ### Métricas de spans
</div>

* [Las métricas de spans](/es/concepts/key-terms/tracing/span-metrics/) se obtienen aplicando una función a los atributos de tus spans (predeterminados o personalizados), como `p50(cart.value)` o `sum(ai.token_use)`, durante un periodo de tiempo granular. Este cálculo genera métricas que luego alimentan paneles y alertas, en función de esa ventana de tiempo continua.
* Estas “métricas” no se almacenan por separado de los datos de tus spans; se consultan en tiempo real. Esto reduce la necesidad de gestionar, ingerir y almacenar métricas personalizadas.

<div id="practical-examples">
  ## Ejemplos prácticos
</div>

* **Mira tus cambios en acción**: Buscar `span.domain is localhost:XXXX` y ordenar por marca de tiempo para ver trazas de tu entorno de desarrollo.
* **Diagnosticar páginas lentas**: Buscar `span.op:navigation` y visualizar `p90(span.duration)` para detectar cargas de página lentas.
* **Encontrar llamadas a API problemáticas**: Agregar por `http.url` y filtrar donde `avg(span.duration) > 2s` para identificar llamadas a APIs externas lentas.
* **Análisis de consultas de base de datos**: Agregar por `db.query` y ordenar por `avg(span.duration)` para encontrar consultas ineficientes.

Con estas herramientas, el nuevo Trace Explorer te ofrece potentes maneras de entender el rendimiento de tu aplicación, identificar cuellos de botella y realizar optimizaciones fundamentadas.

<Alert>
  Tu tipo de plan determina tu ventana de consultas: Developer: 7 días | Team: 14 días | Business: 30 días.
</Alert>

<div id="browsing-span-and-trace-samples">
  ## Exploración de muestras de Span y Trace
</div>

Trace Explorer te permite explorar muestras de spans y traces e inspeccionarlas. Así es como hacerlo:

1. **Buscar muestras**:
   * Usa la barra de búsqueda para filtrar resultados según atributos predeterminados o personalizados, etiquetas y cadenas como `http.request_method is "GET"`
   * **Edita y agrega** columnas en la tabla de muestras de spans para ver cualquier atributo
   * **Ordena** haciendo clic en el encabezado de la columna para alternar entre ascendente y descendente
   * Cambia entre las pestañas **Span Samples** y **Trace Samples** según lo que necesites.
2. **Inspeccionar muestras**:

   * Al hacer clic en un **Span ID** o **Trace ID** se abre la **Trace Waterfall View**, que muestra la secuencia de operaciones y sus duraciones.
   * Puedes explorar spans individuales en detalle o ver la estructura general del trace.

<Arcade src="https://demo.arcade.software/5W4Ra0nvz6eufKmnybix?embed" />

<div id="visualizing-span-attributes">
  ## Visualización de atributos de span
</div>

Trace Explorer facilita la visualización de métricas agregadas a partir de cualquier atributo de span.

1. **Configurar la visualización**:
   * Usa la sección **Visualize** para añadir métricas como `avg(span.duration)` o `p90(span.duration)` al mismo gráfico haciendo clic en **Add Series** o a un gráfico distinto haciendo clic en el icono **+**.
   * También puedes crear visualizaciones personalizadas, como:
     * **P90 de las duraciones de los span**: útil para identificar valores atípicos.
     * **Promedio del tamaño de la caché**: analiza atributos específicos de span de backend.
2. **Filtra tus datos**:
   * Refina tu visualización aplicando filtros en la barra de búsqueda, como `span.op:db` para centrarte en span de base de datos o `http.status_code:500` para errores.

El gráfico de líneas se actualiza dinámicamente a medida que aplicas filtros, lo que te ayuda a seguir tendencias e identificar anomalías.

<Arcade src="https://demo.arcade.software/6goWASyLCX3jx0kjKRMB?embed" />

<div id="aggregating-span-data">
  ## Agregar datos de spans
</div>

Profundiza en tus datos con las capacidades de agregación de Trace Explorer.

1. Haz clic en la pestaña **Aggregates**.

2. **Agrupa por atributos** para investigar patrones.

   * Prueba `http.method` para comparar el rendimiento de GET vs. POST, `db.table` para encontrar operaciones lentas en la base de datos, `span.op` para detectar patrones en tus trazas, o etiquetas personalizadas como el valor del carrito, el uso de CPU o de memoria, o cualquier otra cosa que se te ocurra.

3. **Filtra y ordena tus agregados** igual que lo harías con las transacciones, realizando consultas en la barra de búsqueda. Ordena la tabla de agregados haciendo clic en los encabezados de columna (valor predeterminado: `timestamp`).

4. **Mira trazas de ejemplo** que coincidan con tus agregados haciendo clic en el ícono de pila a la izquierda de las filas de la tabla. Úsalo para encontrar valores atípicos, depurar problemas y descubrir optimizaciones de rendimiento complejas.

<Arcade src="https://demo.arcade.software/rgVB85wJiopGNPO3KFJS?embed" />

<div id="create-alerts-and-dashboard-widgets-from-queries-or-compare-queries">
  ## Crear alertas y widgets del panel a partir de consultas o comparar consultas
</div>

Puedes crear alertas y widgets del panel a partir de tus consultas haciendo clic en el Button &quot;Save As&quot;:

![Trace Explorer Screenshot](./img/trace_explorer_save.png)

También puedes ejecutar comparaciones en paralelo de diferentes consultas para analizar cambios o diferencias en los datos de spans.

<div id="practical-examples">
  ## Ejemplos prácticos
</div>

* **Diagnóstico de páginas lentas**:
  * Buscar `span.op:navigation` y visualizar `p90(span.duration)` para detectar cargas de página lentas.
* **Detección de llamadas a API problemáticas**:
  * Agrupar por `http.url` y filtrar donde `avg(span.duration) > 2s` para identificar llamadas externas a la API lentas.
* **Análisis de consultas de base de datos**: Agrupar por `db.query` y ordenar por `avg(span.duration)` para encontrar consultas ineficientes.

<div id="how-sampling-affects-queries-in-trace-explorer">
  ## Cómo afecta el muestreo a las consultas en Trace Explorer
</div>

Puedes usar los SDK de Sentry para muestrear spans y controlar el volumen de datos enviados a Sentry. No todos los spans se capturan cuando el muestreo está habilitado, pero Sentry seguirá ofreciéndote resultados agregados precisos extrapolando los datos muestreados.

<div id="how-it-works">
  ### Cómo funciona
</div>

Cada span que se envía a Sentry incluye su **tasa de muestreo**. También calculamos el **peso de muestreo**, que es el inverso de esa tasa e indica cuántos spans originales representa esta muestra.

Por ejemplo:

* Con una tasa del *10%*, el peso es *10*.
* Con una tasa del *50%*, el peso es *2*.
* Con una tasa del *100%*, el peso es *1*.

Todos los spans que nos envíes tras el muestreo se almacenan.

Cuando ejecutas consultas en Trace Explorer, Sentry usa el peso de muestreo para calcular recuentos, promedios y percentiles.

<div id="example">
  ### Ejemplo
</div>

Supongamos que haces una consulta de spans donde `span.op:db` y obtienes **2 spans** en los resultados:

{" "}

<table>
  <colgroup>
    <col />

    <col />

    <col />

    <col />

    <col />
  </colgroup>

  <thead>
    <tr>
      <th>span&#95;id</th>
      <th>span.op</th>
      <th>span.duration</th>
      <th>sampling&#95;factor</th>
      <th>sampling&#95;weight</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>a1b2c3</td>
      <td>db</td>
      <td>100 ms</td>
      <td>0,1</td>
      <td>10</td>
    </tr>

    <tr>
      <td>d4e5f6</td>
      <td>db</td>
      <td>200 ms</td>
      <td>0,5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>

<div id="counts">
  ### Conteos
</div>

Como cada span se muestreó con pesos diferentes, Sentry extrapola el **conteo**:

```plaintext
10 + 2 = 12 intervalos estimados
```

Trace Explorer mostrará **Conteo: 12**.

<div id="sums">
  ### Sumas
</div>

De forma similar, Sentry incorpora el peso en la **suma**:

```plaintext
10 * 100 ms + 2 * 200 ms = 1,4 s
```

Trace Explorer mostrará **Suma: 1,4 ms**.

<div id="averages-and-percentiles">
  ### Promedios y percentiles
</div>

Los promedios y los percentiles están **ponderados**. No basta con promediar los 2 spans: Sentry tiene en cuenta que representan un conjunto de datos más grande. Por ejemplo, el promedio ponderado funciona así:

```Plaintext
(100 ms × 10 + 200 ms × 2) / (10 + 2) = 117 ms (Esta es la duración media mostrada)
```

Sentry lo toma como una representación del promedio de los 12 spans estimados. Puedes confiar en que métricas como `avg()` y `p90()` reflejan la salud real de tus servicios, ajustadas por el muestreo.

<div id="sampling-warnings">
  ### Advertencias de muestreo
</div>

Si tu tasa de muestreo es **demasiado baja** para una extrapolación precisa (por ejemplo, si conservas menos del 5% de un número ya bajo de spans), Sentry puede mostrar una **advertencia de tasa de muestreo baja**. Esto te indica que la extrapolación podría ser menos confiable, especialmente para consultas más restrictivas.

<div style={{width: '450px'}}>
  ![Trace Explorer Warning](./img/Trace_explorer_low_samples.png)
</div>

Aunque muestrees tus spans, **la extrapolación de Trace Explorer te ofrece respuestas razonablemente precisas** para conteos, promedios y percentiles, sin que tengas que hacer nada adicional.

Nota: Si quieres ver agregaciones sin extrapolar para una consulta, puedes desactivar la extrapolación usando el ícono de configuración encima del gráfico.

Con estas herramientas, el nuevo Trace Explorer te ofrece formas potentes de entender el rendimiento de tu aplicación, identificar cuellos de botella y tomar decisiones informadas de optimización.