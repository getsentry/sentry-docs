---
title: "Problemas potenciales de vulnerabilidad por inyección de consultas"
sidebar_order: 50
description: "Obtén más información sobre los problemas potenciales de vulnerabilidad por inyección de consultas y cómo diagnosticarlos y solucionarlos."
---

Se generan problemas potenciales de vulnerabilidad por inyección de consultas cuando Sentry detecta que valores tomados directamente de una solicitud entrante se incorporan a una consulta de base de datos. La interpolación de la entrada del usuario sin saneamiento puede dar lugar a [inyección SQL](https://owasp.org/www-community/attacks/SQL_Injection) y ataques relacionados.

Puedes activar este detector para tu proyecto en **Project Settings > Performance**.

<div id="detection-criteria">
  ## Criterios de detección
</div>

El detector evalúa cada solicitud en **dos etapas**:

1. **Filtrar valores de la solicitud** – Descarta tokens que son:

   - demasiado cortos,
   - palabras clave de SQL, o
   - otros valores frecuentemente benignos

2. **Comparar con consultas** – Analiza las consultas a la base de datos y, si **tanto** una clave del payload _como_ su valor aparecen en la misma consulta, Sentry crea un problema de posible vulnerabilidad de inyección de consultas.

<div id="example">
  ### Ejemplo
</div>

```
Solicitud →  GET /api?username=bob
Consulta  →  SELECT * FROM users WHERE username = 'bob'
```

Debido a que el valor `'bob'` se inserta directamente del parámetro `username` en la consulta, Sentry señala la operación como potencialmente vulnerable. **Un problema indica un *riesgo* de seguridad, no confirma que ya se haya explotado una vulnerabilidad.**


<div id="false-positives">
  ### Falsos positivos
</div>

Algunas bibliotecas ORM o de generadores de consultas forman cadenas SQL internamente antes de parametrizarlas. Suprimimos automáticamente muchas bibliotecas conocidas, pero las no reconocidas aún pueden activar el detector. Si crees que se trata de un falso positivo, deja tu comentario en la página del issue.

<div id="remediation">
  ## Mitigación
</div>

- Usa **consultas parametrizadas/sentencias preparadas** en lugar de concatenar cadenas.
- **Valida y depura** toda la entrada externa.
- Evita **consultas sin procesar** cuando haya APIs seguras del ORM disponibles.