---
title: Primeros pasos
description: "Aprende cómo empezar con Relay, la solución de seguridad de datos de Sentry."
sidebar_order: 1
og_image: /og-images/product-relay-getting-started.png
---

Empezar con [Relay](/es/product/relay/) es tan sencillo como usar la configuración predeterminada. También puedes configurar Relay para adaptarlo a las necesidades de tu organización. Consulta la página de [Opciones de configuración](../options/) para una descripción detallada de los escenarios de operación.

<Alert>
  El servidor de Relay se llama `relay`. Descarga los binarios desde [GitHub Releases](https://github.com/getsentry/relay/releases). Hay una imagen de Docker disponible en el [GitHub Container Registry](https://github.com/getsentry/relay/pkgs/container/relay).
</Alert>

<div id="initializing-configuration">
  ## Inicialización de la configuración
</div>

Para crear la configuración inicial, usa el comando `relay config init` de Relay,
que coloca los archivos de configuración en la carpeta `.relay` del
directorio de trabajo actual.

<Alert>
  En Docker, proporciona el directorio de configuración usando los mecanismos
  estándar que ofrece Docker, ya sea montando [volúmenes de
  Docker](https://docs.docker.com/storage/volumes/) o creando un nuevo
  contenedor y copiando los archivos.
</Alert>

```shell {tabTitle:Run in Docker}
# Ajustar permisos para el directorio de configuración
chown -R 65532:65532 ./config

# Generar la configuración
# La opción :z solo es necesaria en selinux.
# Ver https://docs.docker.com/storage/bind-mounts/#configure-the-selinux-label.
docker run --rm -it                   \
  -v "$(pwd)"/config/:/work/.relay/:z \
  ghcr.io/getsentry/relay             \
  config init
```

```shell {tabTitle:Run Executable}
./relay config init
```

Selecciona la configuración predeterminada para crear un archivo de configuración mínimo.
Puedes sobrescribir la configuración predeterminada seleccionando
*&quot;create custom config&quot;* y personalizando estos parámetros:

* La opción `mode`, que define el modo principal en el que opera Relay. Para obtener más información sobre los modos disponibles de Relay, consulta [Relay Modes](../modes/).

* La opción `upstream` configura el servidor al que Relay reenviará los
  eventos (de forma predeterminada, la URL principal de `sentry.io`).

* Las opciones `port` y `host` configuran el puerto TCP en el que Relay
  escuchará. Esta es la dirección a la que los SDK envían eventos.

La configuración se guarda en `.relay/config.yml`. Ten en cuenta que todos los valores de configuración
son opcionales y, de forma predeterminada, usan estos ajustes:

```yaml {tabTitle:Run in Docker}
relay:
  mode: managed
  # El nombre de host de upstream se toma de cualquiera de tus DSN.
  # Ve a la configuración del proyecto y luego a "Client Keys (DSN)" para verlos.
  upstream: https://___ORG_INGEST_DOMAIN___
  host: 0.0.0.0
  port: 3000
```

```yaml {tabTitle:Run Executable}
relay:
  mode: managed
  # El nombre de host ascendente se toma de cualquiera de tus DSN.
  # Ve a la Configuración del proyecto y luego a "Client Keys (DSN)" para verlos.
  upstream: https://___ORG_INGEST_DOMAIN___
  host: 127.0.0.1
  port: 3000
```

Las opciones de configuración están completamente documentadas en [Opciones de configuración](../options/).

<div id="creating-credentials">
  ## Creación de credenciales
</div>

<Alert>
  No aplica en modo `proxy`.
</Alert>

Además de `config.yml`, el comando `init` crea un archivo de credenciales, `credentials.json`, que se coloca en el mismo directorio `.relay`. Este archivo contiene tanto la clave pública como la privada que Relay utiliza para autenticarse con el servidor upstream.

**Por lo tanto, este archivo debe estar protegido contra modificación o visualización por entidades no autorizadas.**

Un archivo de credenciales típico es similar a este ejemplo:

```json
{
  "secret_key": "5gkTAfwOrJ0lMy9aOAOmHKO1k6gd8ApYkAInmg5VfWk",
  "public_key": "nDJI79SbEYH9-8NEJAI7ezrgYfoIPW3Bnkg00k1z0fA",
  "id": "cde0d72e-0c4e-4550-a934-c1867d8a177c"
}
```

Usa la `public_key` para registrar tu Relay en el servidor upstream cuando lo ejecutes en modo `managed`.

<div id="registering-relay-with-sentry">
  ## Registrar Relay en Sentry
</div>

<Alert>
  No aplicable en el modo `proxy`.
</Alert>

Para operar en modo `managed`, Relay obtiene la configuración para la eliminación de PII,
el filtrado y la limitación de velocidad desde los ajustes de tu organización y proyecto en
Sentry. Dado que estos ajustes pueden contener información sensible, su acceso está
restringido por Sentry y requiere autorización.

Para registrar Relay en Sentry:

1. Copia el contenido de la clave pública, ya sea inspeccionando el archivo `credentials.json` o ejecutando:

   ```shell {tabTitle:Run in Docker}
   docker run --rm -it                 \
     -v "$(pwd)"/config/:/work/.relay/ \
     ghcr.io/getsentry/relay           \
     credentials show
   ```

   ```shell {tabTitle:Run Executable}
   ./relay credentials show
   ```

2. Haz clic en *Settings* en la navegación principal de Sentry y luego selecciona *Relays*.

![](./img/add-relay-key.png)

3. Haz clic en *New Relay Key* para añadir la clave y guardarla:

![](./img/edit-relay-key.png)

Este proceso registra Relay en Sentry para que esté listo para enviar mensajes. Consulta
[Configuration Options](../options/) para obtener más información sobre las opciones de configuración de Relay.

<div id="running-relay">
  ## Ejecución de Relay
</div>

Después de registrar Relay en Sentry, ya está listo para ejecutarlo:

```shell {tabTitle:Run in Docker}
docker run --rm -it                 \
  -v "$(pwd)"/config/:/work/.relay/ \
  -p 3000:3000                      \
  ghcr.io/getsentry/relay           \
  run
```

```shell {tabTitle:Run Executable}
./relay run
```

Con la configuración predeterminada, Relay genera una salida de registro similar a:

```
 INFO  relay::setup > iniciando relay desde la carpeta de configuración .relay
 INFO  relay::setup >   modo relay: gestionado
 INFO  relay::setup >   id relay: cde0d72e-0c4e-4550-a934-c1867d8a177c
 INFO  relay::setup >   clave pública: nDJI79SbEYH9-8NEJAI7ezrgYfoIPW3Bnkg00k1z0fA
 ...
 INFO  relay_server::actors::upstream > relay registrado exitosamente con upstream
```

Consulta la página de [Logging](../monitoring/#logging) para obtener más información sobre cómo configurar el registro de Relay.

Si cambiaste la carpeta de configuración (por ejemplo, por motivos de seguridad), usa la opción `--config` para indicar su ubicación:

```shell {tabTitle:Run in Docker}
docker run --rm -it               \
  -v "$(pwd)"/config/:/etc/relay/ \
  -p 3000:3000                    \
  ghcr.io/getsentry/relay         \
  run --config /etc/relay/
```

```shell {tabTitle:Run Executable}
./relay run --config /etc/relay/
```

<div id="sending-a-test-event">
  ## Enviar un evento de prueba
</div>

Una vez que Relay esté en ejecución y autenticado con Sentry, envía un evento de prueba a uno de los proyectos de tu organización.

Obtén el DSN de tu proyecto yendo a la configuración del proyecto en *Settings &gt; Projects &gt; &#123;YOUR&#95;PROJECT&#95;NAME&#125; &gt; Client Keys (DSN)*, y selecciona uno de los DSN existentes, similar a:

`https://12345abcdef10111213141516171819@o1.ingest.sentry.io/2345`

Luego, reemplaza partes del DSN para que coincidan con la dirección a la que Relay es accesible.
Por ejemplo, si Relay escucha en `http://localhost:3000`, cambia el protocolo
y el host del DSN a:

<p>
  <code>
    <strong>
      <i>http</i>
    </strong>

    ://12345abcdef10111213141516171819@

    <strong>
      <i>localhost:3000</i>
    </strong>

    /2345
  </code>
</p>

Usa el nuevo DSN en la configuración de tu SDK. Para probarlo, puedes enviar un mensaje
con `sentry-cli` ([instrucciones de instalación](/es/cli/installation/)):

```shell
export SENTRY_DSN='http://12345abcdef10111213141516171819@127.0.0.1:3000/2345'
sentry-cli send-event -m 'Un evento de prueba'
```

En unos segundos, el evento debería aparecer en el flujo de incidencias de tu
proyecto.

<div id="next-steps">
  ## Próximos pasos
</div>

* **[Más información sobre nuestras directrices operativas](../operating-guidelines/)**

Con una instancia de Relay en funcionamiento, puedes supervisar y escalar tu implementación de Relay.