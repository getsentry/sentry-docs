<div id="legacy-endpoint-migration">
  # Migraci√≥n de endpoints heredados
</div>

En la fase inicial de la beta del producto Crons, los endpoints de Check-In estaban bajo el
namespace de la API `sentry.io/api/0/`. Este namespace no est√° dise√±ado para
tr√°fico de ingesta, por lo que desde entonces hemos movido las API de Check-In para usar
[Relay](/es/product/relay/) en la ingesta de eventos de Check-In.

Si est√°s usando endpoints heredados para Crons, migra a los nuevos endpoints para evitar problemas.

<Alert>
  Los endpoints heredados **est√°n obsoletos** y se eliminar√°n en el futuro;
  sin embargo, a√∫n no se ha establecido una fecha para su eliminaci√≥n. Comunicaremos una
  fecha cuando se establezca.
</Alert>

<div id="am-i-using-legacy-endpoints">
  ## ¬øEstoy usando endpoints heredados?
</div>

Los SDK no utilizan nuestros endpoints heredados.

<Alert level="warning" title="Sentry CLI">
  Las versiones de `sentry-cli` **anteriores a la v2.19.0** usan los endpoints heredados de la API. [Actualiza](/es/cli/installation/#updating-and-uninstalling) a la versi√≥n m√°s reciente.

  Si tu CLI est√° configurada con un token de autenticaci√≥n, utilizar√° los endpoints heredados de la API. Actualiza la configuraci√≥n de tu CLI para usar el DSN de tu proyecto en su lugar. Consulta la [gu√≠a de configuraci√≥n](/es/cli/crons/#configuration) para m√°s informaci√≥n.
</Alert>

Al usar los endpoints HTTP, puedes diferenciarlos as√≠:

```
# ‚ùå Endpoints heredados
https://sentry.io/api/0/organizations/___ORG_SLUG___/monitors/<monitor_slug/

# ‚ùå Endpoint heredado sin contexto de organizaci√≥n
https://sentry.io/api/0/monitors/<monitor_slug/

# ‚ùå Endpoint heredado de detalles de check-in
https://sentry.io/api/0/monitors/<monitor_slug/checkins/<check_in_id>/

# ‚úÖ Endpoint de ingesta de Relay Check-In
https://___ORG_INGEST_DOMAIN___/api/___PROJECT_ID___/cron/<monitor_slug>/___PUBLIC_KEY___/
```

<div id="what-changed">
  ### ¬øQu√© cambi√≥?
</div>

Hay algunos cambios incompatibles con versiones anteriores que debes tener en cuenta.

* Ahora solo hay un √∫nico endpoint de Check-In. El endpoint de &quot;Check-In details&quot;
  ha sido eliminado.

* El endpoint de la API admite tanto `POST` con un cuerpo JSON como `GET`. Puedes usar par√°metros de consulta para especificar `status`,
  `environment`, etc.

  El endpoint de la API siempre responder√° con un `202` sin cuerpo (a menos que
  haya un error).

* Como ya no existe un endpoint de &quot;details&quot;, el m√©todo `PUT` para un Check-In
  tambi√©n ha sido eliminado. Siempre usar√°s `POST` o `GET` para los Check-Ins.

* Para [overlapping
  jobs](/es/product/crons/getting-started/http/#overlapping-jobs-optional), a√∫n es
  posible especificar un `check_in_id` mediante par√°metros de consulta o en el cuerpo JSON. Sin embargo, la API ya no responde con un ID de Check-In autogenerado.
  Si necesitas un ID de Check-In estable, debes generarlo
  t√∫ mismo en el cliente.

* La estructura `monitor_config` ha cambiado ligeramente. `schedule` ahora es un
  objeto cuya forma var√≠a seg√∫n el tipo de programaci√≥n.

  ```json
  {"type": "crontab", "value": "0 * * * *"}
  {"type": "interval", "value": "2", "unit": "hour"}
  ```

<div id="migration-examples">
  ## Ejemplos de migraci√≥n
</div>

Consulta los ejemplos de c√≥digo a continuaci√≥n para ayudarte a migrar de los endpoints antiguos a los actuales.

<div id="simple-http-check-ins">
  ### Check-ins HTTP simples
</div>

```sh
# ‚ùå Check-in simple heredado: de `in_progress` a `ok`
curl -X POST \
    'https://sentry.io/api/0/organizations/___ORG_SLUG___/monitors/<monitor_slug>/checkins/' \
    --header 'Authorization: DSN ___PUBLIC_DSN___' \
    --header 'Content-Type: application/json' \
    --data-raw '{"status": "in_progress"}'

curl -X POST \
    'https://sentry.io/api/0/organizations/___ORG_SLUG___/monitors/<monitor_slug>/checkins/' \
    --header 'Authorization: DSN ___PUBLIC_DSN___' \
    --header 'Content-Type: application/json' \
    --data-raw '{"status": "ok"}'


# ‚úÖ Nuevo estilo de check-in: de `in_progress` a `ok`
SENTRY_INGEST="https://___ORG_INGEST_DOMAIN___"
SENTRY_CRONS="${SENTRY_INGEST}/api/___PROJECT_ID___/cron/<monitor_slug>/___PUBLIC_KEY___/"

curl "${SENTRY_CRONS}?status=in_progress"

curl "${SENTRY_CRONS}?status=ok"
```

<div id="monitor-upsert-check-in">
  ### Registro de check-in del monitor con upsert
</div>

```sh
# ‚ùå Upsert de monitor heredado con un check-in
curl -X POST \
    'https://sentry.io/api/0/organizations/___ORG_SLUG___/monitors/<monitor_slug>/checkins/' \
    --header 'Authorization: DSN ___PUBLIC_DSN___' \
    --header 'Content-Type: application/json' \
    --data-raw '{"monitor_config": {"schedule": "0 * * * *", "schedule_type": "crontab"}, "status": "in_progress"}'

# ‚úÖ Nuevo estilo de upsert de monitor con un check-in
SENTRY_INGEST="https://___ORG_INGEST_DOMAIN___"
SENTRY_CRONS="${SENTRY_INGEST}/api/___PROJECT_ID___/cron/<monitor_slug>/___PUBLIC_KEY___/"

curl -X POST "${SENTRY_CRONS}?status=in_progress" \
    --header 'Content-Type: application/json' \
    --data-raw '{"monitor_config": {"schedule": {"type": "crontab", "value": "0 * * * *"}}, "status": "in_progress"}'
    # üëâ Ten en cuenta que schedule ahora es un objeto ---^
```

<div id="overlapping-job-check-ins-specifying-check_in_id">
  ### Registro de check-ins de trabajos superpuestos (especificando `check_in_id`)
</div>

```sh
# ‚ùå Check-In heredado con ID
curl -X POST \
    'https://sentry.io/api/0/organizations/___ORG_SLUG___/monitors/<monitor_slug>/checkins/' \
    --header 'Authorization: DSN ___PUBLIC_DSN___' \
    --header 'Content-Type: application/json' \
    --data-raw '{"status": "in_progress"}'
# Respuesta { "id": "2bc1a871-a1b7-4577-82fc-fa6d2468aabc" }

# ‚úÖ Nuevo estilo: upsert de monitor con un check-in
CHECK_IN_ID="$(uuidgen)"
# üëâ Nota: ahora debes generar el UUID del Check-In

SENTRY_INGEST="https://___ORG_INGEST_DOMAIN___"
SENTRY_CRONS="${SENTRY_INGEST}/api/___PROJECT_ID___/cron/<monitor_slug>/___PUBLIC_KEY___/"

curl "${SENTRY_CRONS}?check_in_id=${CHECK_IN_ID}&status=in_progress"
# üëâ Nota: no se devuelve ning√∫n ID de Check-In
```
