---
title: Registros y fallos de procesos
description: "Obtén más información sobre cómo configurar el SDK. Estas opciones se establecen cuando el SDK se inicializa por primera vez y se pasan a la función init."
sidebar_order: 50
---

Elixir y Erlang registran automáticamente los fallos de procesos. Para capturar estos errores en Sentry, debes habilitar el controlador integrado [`:logger`](https://www.erlang.org/doc/man/logger.html) del SDK de Elixir. La forma más común de hacerlo es añadir el controlador en la configuración de tu aplicación y luego llamar a `Logger.add_handlers/1` en el [`Application.start/2` callback](https://hexdocs.pm/elixir/Application.html#start/2) de tu aplicación.

Primero, añade el controlador de Sentry a la configuración de tu aplicación. (Puedes usar cualquier identificador de controlador en lugar de `:my_sentry_handler`):

```elixir {filename:config/prod.exs}
config :my_app, :logger, [
  {:handler, :my_sentry_handler, Sentry.LoggerHandler, %{
    config: %{
      metadata: [:file, :line],
      rate_limiting: [max_events: 10, interval: _1_second = 1_000],
      capture_log_messages: true
    }
  }}
]
```

A continuación, añade el controlador al registrador en el callback `Application.start/2` de tu aplicación:

```elixir {filename:my_app/lib/application.ex}
@impl Application
def start(_type, _args) do
  children = [
    # ...
  ]

  Logger.add_handlers(:my_app)
end
```


<div id="capturing-logged-messages">
  ### Captura de mensajes de registro
</div>

Si también quieres capturar **mensajes de registro** por encima de un nivel de log específico (y no solo caídas del proceso), debes establecer `:capture_log_messages`. Luego puedes usar la opción `:level` en la configuración del handler:

```elixir {filename:config/prod.exs}
config :my_app, :logger, [
  {:handler, :my_sentry_handler, Sentry.LoggerHandler, %{
    config: %{capture_log_messages: true, level: :error}
  }}
]
```

Ahora los mensajes se reportarán a Sentry incluso si se registran con `Logger.error/1`, por ejemplo:

```elixir
Logger.error("Esto se reportará a Sentry")
```


<div id="logger-handler-configuration">
  ## Configuración del handler de Logger
</div>

Puedes configurar el handler de `:logger` bajo la clave `:config`, como se muestra arriba. A continuación se muestran las opciones de configuración.

<SdkOption name="capture_log_messages" type="bool" defaultValue="false">

De forma predeterminada está en `false` y solo enviará informes de fallos (mensajes con metadatos que parecen un motivo de salida y un stacktrace). Cuando se establece en `true`, el handler enviará a Sentry todos los mensajes registrados (siempre que no sean filtrados por `:excluded_domains` y `:level`).

</SdkOption>

<SdkOption name="level" type="atom" defaultValue=":error">

Este es el [nivel de `Logger`](https://hexdocs.pm/logger/Logger.html#module-levels) mínimo para el que se enviarán eventos y está configurado en `:error` por defecto. Puedes bajarlo a `:warning`, por ejemplo, para reportar también llamadas a `Logger.warning/1`.

</SdkOption>

<SdkOption name="metadata" type="list" defaultValue="[]">

Úsalo para incluir metadatos del logger no pertenecientes a Sentry en los reportes. Está configurado en `[]` por defecto. Si es una lista de claves, los metadatos en esas claves se añadirán en el contexto `:extra` bajo la clave `:logger_metadata`. Si se establece en `:all`, se incluirán todos los metadatos.

</SdkOption>

<SdkOption name="excluded_domains" type="list" defaultValue="[:cowboy]">

Esta opción hace que no se envíen los mensajes cuyo dominio esté en la lista configurada. Está configurada en `[:cowboy]` por defecto para evitar reportar dos veces eventos desde `Sentry.PlugCapture`.

</SdkOption>

<SdkOption name="rate_limiting" type="map">

Configura la limitación de tasa para los mensajes registrados enviados a Sentry y está deshabilitada por defecto. Puede ayudar a limitar la cantidad de mensajes que se reportan en un período corto de tiempo.

</SdkOption>