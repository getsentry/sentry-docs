---
title: Jetpack Compose
caseStyle: camelCase
supportLevel: production
sdk: sentry.java.compose
description: Obtén más información sobre la integración de Sentry con Compose.
categories:
  - mobile
og_image: /og-images/platforms-android-integrations-jetpack-compose.png
---

La biblioteca `sentry-compose-android` ofrece soporte para [Jetpack Compose](https://developer.android.com/jetpack/androidx/releases/compose) en las siguientes áreas:

* Métricas de rendimiento de `@Composable`
* Soporte de transacciones y breadcrumbs para interacciones de usuario (toques, deslizamientos y gestos de desplazamiento)
* Soporte de transacciones y breadcrumbs para eventos de navegación
* Soporte para <PlatformLink to="/enriching-events/viewhierarchy/">Jerarquías de vistas</PlatformLink>

<div id="performance-metrics">
  ## Métricas de rendimiento
</div>

*(Nuevo en la versión 6.16.0)*

Con las métricas de rendimiento de Jetpack Compose, el Sentry Android SDK puede medir automáticamente el tiempo inicial de `composition` y `rendering` como spans de rendimiento de tus elementos de UI `@Composable`.

![Métricas de rendimiento de Jetpack Compose](./img/jetpack-compose-performance-metrics.png)

<Alert>
  Esta función requiere una transacción subyacente a la que adjuntar sus spans. Las transacciones pueden crearse manualmente o automáticamente configurando:

  * <PlatformLink to="/tracing/instrumentation/automatic-instrumentation/">Instrumentación de Activity</PlatformLink>
  * [Instrumentación de Navigation](#jetpack-compose-navigation)
  * [Interacciones de usuario](#user-interactions)
</Alert>

Una vez habilitadas las métricas de rendimiento, verás dos spans dentro de tus transacciones:

* `ui.compose.composition`, que describe el tiempo que tardó en ejecutarse tu `@Composable`
* `ui.compose.rendering`, que describe el tiempo que tardó en renderizarse tu `@Composable` en el lienzo

La función `SentryTraced` también ofrece el argumento `enableUserInteractionTracing`, que aplica automáticamente un `Modifier.sentryTag()` y habilita la función *Interacciones de usuario* mencionada a continuación.

<div id="installation">
  ### Instalación
</div>

Para añadir la integración de Jetpack Compose, instala el [Android SDK](/es/platforms/android/) y luego añade la dependencia `sentry-compose-android` con Gradle:

```groovy
implementation 'io.sentry:sentry-android:{{@inject packages.version('sentry.java.android', '6.2.0') }}'
implementation 'io.sentry:sentry-compose-android:{{@inject packages.version('sentry.java.compose', '6.2.0') }}'
```

Una vez instalado, debes envolver el cuerpo de tu `@Composable` con la función `SentryTraced`.

```kotlin
import io.sentry.compose.SentryTraced

@Composable
fun LoginScreen() {
  SentryTraced("login_screen") {
    Column {
      // ...
      Button(
          onClick = { TODO() }) {
          Text(text = "Iniciar sesión")
      }
    }
  }
}
```

<div id="user-interactions">
  ## Interacciones de usuario
</div>

*(Novedad en la versión 6.10.0)*

La función de Interacciones de usuario de Sentry para Jetpack Compose puede detectar gestos de toque, desplazamiento y deslizamiento. Para cada gesto, el SDK puede recopilar automáticamente breadcrumbs e iniciar transacciones.

![Interacciones de usuario de Jetpack Compose](./img/jetpack-compose-user-interactions.png)

<div id="installation">
  ### Instalación
</div>

Para agregar la integración de Jetpack Compose, instala el [Android SDK](/es/platforms/android/) y luego agrega la dependencia `sentry-compose-android` con Gradle:

```groovy
implementation 'io.sentry:sentry-android:{{@inject packages.version('sentry.java.android', '6.2.0') }}'
implementation 'io.sentry:sentry-compose-android:{{@inject packages.version('sentry.java.compose', '6.2.0') }}'
```

<div id="configuration">
  ### Configuración
</div>

Esta función está desactivada de forma predeterminada, pero puedes habilitarla de las siguientes maneras.

<div id="using-androidmanifestxml">
  #### Uso de `AndroidManifest.xml`
</div>

```xml {filename:AndroidManifest.xml}
<application>
    <meta-data android:name="io.sentry.traces.user-interaction.enable" android:value="true" />
    <meta-data android:name="io.sentry.breadcrumbs.user-interaction" android:value="true" />
</application>
```

<div id="using-sentryoptions">
  #### Uso de `SentryOptions`
</div>

Si inicializas el SDK [manualmente, como se indica aquí](/es/platforms/android/configuration/manual-init/#manual-initialization), puedes habilitar las interacciones con el usuario así:

```kotlin {filename:MyApplication.kt}
SentryAndroid.init(this) { options ->
    // ...
    options.isEnableUserInteractionTracing = true
    options.isEnableUserInteractionBreadcrumbs = true
}
```

<div id="capture-composables">
  #### Capturar composables
</div>

El SDK de Sentry requiere que apliques `Modifier.sentryTag("<tag>")` o `Modifier.testTag("<tag>")` en cada `@Composable` que quieras capturar para determinar su identificador.
Aquí tienes un ejemplo:

```kotlin
import io.sentry.compose.sentryTag

@Composable
fun LoginScreen() {
  Column {
    // ...
    Button(
        modifier = Modifier.sentryTag("button_login"),
        onClick = { TODO() }) {
        Text(text = "Iniciar sesión")
    }
  }
}
```

<Alert>
  Si un `@Composable` no tiene un modificador `.sentryTag` o `.testTag` aplicado, no se capturarán las breadcrumbs ni las transacciones porque no pueden identificarse de forma unívoca.
  Para generar etiquetas automáticamente, consulta la documentación sobre nuestro <PlatformLink to="/enhance-errors/kotlin-compiler-plugin/">Sentry Kotlin Compiler Plugin</PlatformLink>.
</Alert>

<Alert>
  Si quieres personalizar las breadcrumbs o las transacciones registradas, puedes ir directamente a [la sección siguiente](#customize-the-recorded-breadcrumbtransaction).
</Alert>

<div id="jetpack-compose-navigation">
  ## Jetpack Compose Navigation
</div>

En esta sección te ponemos en marcha con la integración de Compose Navigation de Sentry, para que agregue automáticamente una miga de pan y comience una transacción por cada evento de navegación.

![Migas de navegación en Jetpack Compose](./img/jetpack-compose-navigation.png)

<div id="auto-installation-with-the-sentry-android-gradle-plugin">
  ### Instalación automática con el complemento Gradle de Sentry para Android
</div>

<div id="install">
  #### Instalación
</div>

Si usas el [Sentry Android Gradle Plugin](/es/platforms/android/configuration/gradle/), la integración con Jetpack Compose Navigation se aplica automáticamente y se crean automáticamente tanto los breadcrumbs como las transacciones para cada evento de navegación.

Agrega el plugin de Sentry para Android Gradle en `build.gradle`:

```groovy
plugins {
  id "io.sentry.android.gradle" version "{{@inject packages.version('sentry.java.android.gradle-plugin', '3.0.0') }}"
}
```

```kotlin
plugins {
  id("io.sentry.android.gradle") version "{{@inject packages.version('sentry.java.android.gradle-plugin', '3.0.0') }}"
}
```

<Alert>
  Obtén más información sobre el plugin Sentry Android para Gradle en nuestra documentación de [Gradle](/es/platforms/android/configuration/gradle/). Los detalles sobre la instalación automática se encuentran en la sección de [Auto-instrumentación](/es/platforms/android/configuration/gradle/#tracing-auto-instrumentation).
</Alert>

<div id="disable">
  #### Desactivar
</div>

Si quieres desactivar la función de instrumentación de Jetpack Compose, puedes adaptar tu archivo `build.gradle(.kts)` de la siguiente manera:

```groovy
import io.sentry.android.gradle.extensions.InstrumentationFeature

sentry {
  tracingInstrumentation {
    enabled = true
    features = EnumSet.allOf(InstrumentationFeature) - InstrumentationFeature.COMPOSE
  }
}
```

```kotlin
import java.util.EnumSet
import io.sentry.android.gradle.extensions.InstrumentationFeature

sentry {
  tracingInstrumentation {
    enabled.set(true)
    features.set(EnumSet.allOf(InstrumentationFeature::class.java) - InstrumentationFeature.COMPOSE)
  }
}
```

<div id="manual-installation">
  ### Instalación manual
</div>

<div id="install">
  #### Instalación
</div>

Sentry captura datos añadiendo una función de extensión, `withSentryObservableEffect`, a `NavHostController`. Para añadir la integración de Navigation, instala el [SDK de Android](/es/platforms/android/) y luego añade la dependencia `sentry-compose` usando Gradle:

```groovy
implementation 'io.sentry:sentry-android:{{@inject packages.version('sentry.java.android', '6.2.0') }}'
implementation 'io.sentry:sentry-compose-android:{{@inject packages.version('sentry.java.compose.android', '6.2.0') }}'
```

<div id="configure">
  #### Configurar
</div>

La configuración debe realizarse en la función `@Composable` correspondiente, una vez que obtengas una instancia de `NavHostController`:

```kotlin
import androidx.navigation.compose.NavHost
import androidx.navigation.compose.rememberNavController
import io.sentry.compose.withSentryObservableEffect

val navController = rememberNavController().withSentryObservableEffect(
  enableNavigationBreadcrumbs = true, // activado por defecto
  enableNavigationTracing = true  // activado por defecto
)
NavHost(
  navController = navController
) {
  ...
}
```

De forma predeterminada, la transacción de navegación finaliza automáticamente cuando alcanza el [idleTimeout](/es/platforms/android/configuration/options/#idleTimeout) especificado y todas sus spans hijas han terminado. Puedes personalizar el tiempo de espera según tus necesidades.

<div id="verify">
  ### Verificar
</div>

Este fragmento incluye una `Activity` de ejemplo con un par de eventos de navegación entre composables y registra un mensaje intencional, para que puedas comprobar que todo funciona en cuanto lo configures:

```kotlin
import android.os.Bundle
import androidx.activity.ComponentActivity
import androidx.activity.compose.setContent
import androidx.compose.foundation.layout.Arrangement
import androidx.compose.foundation.layout.Column
import androidx.compose.foundation.layout.fillMaxSize
import androidx.compose.foundation.layout.padding
import androidx.compose.material3.Button
import androidx.compose.material3.Text
import androidx.compose.runtime.Composable
import androidx.compose.ui.Alignment
import androidx.compose.ui.Modifier
import androidx.compose.ui.unit.dp
import androidx.navigation.NavHostController
import androidx.navigation.NavType
import androidx.navigation.compose.NavHost
import androidx.navigation.compose.composable
import androidx.navigation.compose.rememberNavController
import io.sentry.Sentry
import io.sentry.compose.withSentryObservableEffect

class ComposeActivity : ComponentActivity() {

  override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState)

    setContent {
      val navController = rememberNavController().withSentryObservableEffect()
      SampleNavigation(navController)
    }
  }
}

@Composable
fun SampleNavigation(navController: NavHostController) {
  NavHost(
    navController = navController,
    startDestination = "first"
  ) {
    composable("first") {
      First(
        navigateToSecond = { navController.navigate("second") }
      )
    }
    composable("second") {
      Second()
    }
  }
}

@Composable
fun First(
  navigateToSecond: () -> Unit
) {
  Column(
    verticalArrangement = Arrangement.Center,
    horizontalAlignment = Alignment.CenterHorizontally,
    modifier = Modifier.fillMaxSize()
  ) {
    Button(
      onClick = { navigateToSecond() },
      modifier = Modifier.padding(top = 32.dp)
    ) {
      Text("Navegar a la segunda")
    }
    Button(
      onClick = { Sentry.captureMessage("Some message from Compose.") },
      modifier = Modifier.padding(top = 32.dp)
    ) {
      Text("Mensaje desde Compose")
    }
  }
}

@Composable
fun Second() {
  Column(
    verticalArrangement = Arrangement.Center,
    horizontalAlignment = Alignment.CenterHorizontally,
    modifier = Modifier.fillMaxSize()
  ) {
    Text("Segunda pantalla")
  }
}
```

<div id="customize-the-recorded-breadcrumbtransaction">
  ## Personaliza la ruta de navegación/transacción registrada
</div>

De forma predeterminada, la integración de Navigation captura los argumentos de la ruta como datos adicionales en las rutas de navegación y las transacciones. Si los argumentos contienen datos personales (PII), puedes eliminarlos mediante `BeforeBreadcrumbCallback` y `EventProcessor`, respectivamente. Para hacerlo, [inicializa manualmente](/es/platforms/android/configuration/manual-init/#manual-initialization) el SDK y agrega el siguiente fragmento:

```kotlin
import io.sentry.EventProcessor
import io.sentry.android.core.SentryAndroid
import io.sentry.SentryOptions.BeforeBreadcrumbCallback
import io.sentry.android.navigation.SentryNavigationListener

SentryAndroid.init(this) { options ->
  options.beforeBreadcrumb = BeforeBreadcrumbCallback { breadcrumb, hint ->
    if (SentryNavigationListener.NAVIGATION_OP == breadcrumb.category) {
      breadcrumb.data.remove("from_arguments")
      breadcrumb.data.remove("to_arguments")
    }
    breadcrumb
  }
  options.addEventProcessor(object : EventProcessor {
    override fun process(transaction: SentryTransaction, hint: Hint): SentryTransaction? {
      if (SentryNavigationListener.NAVIGATION_OP == transaction.contexts.trace.operation) {
        transaction.removeExtra("arguments")
      }
      return transaction
    }
  })
}
```
