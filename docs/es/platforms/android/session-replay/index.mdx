---
title: Configurar Session Replay
sidebar_title: Session Replay
sidebar_order: 5500
notSupported:
description: "Aprende a habilitar Session Replay en tu aplicación móvil."
---

[Session Replay](/es/product/explore/session-replay/) te ayuda a encontrar más rápido la causa raíz de un error o de un problema de latencia al ofrecerte una reproducción de lo que ocurría en el dispositivo del usuario antes, durante y después del problema. Puedes retroceder y reproducir el estado de tu aplicación y ver interacciones clave del usuario, como toques, deslizamientos, solicitudes de red y entradas de la consola, en una única interfaz.

De forma predeterminada, nuestro SDK de Session Replay enmascara todo el contenido de texto, las imágenes y la entrada del usuario, dándote mayor tranquilidad de que ningún dato sensible saldrá del dispositivo. Para obtener más información, consulta la [documentación del producto](/es/product/explore/session-replay/).

<div id="pre-requisites">
  ## Requisitos previos
</div>

Asegúrate de que la versión de tu SDK de Sentry para Android sea al menos la 7.12.0.

<div id="install">
  ## Instalar
</div>

La forma más fácil de actualizar es mediante el complemento Sentry Android Gradle en el archivo `build.gradle` del módulo de tu app.

```groovy {filename:app/build.gradle}
plugins {
  id "com.android.application"
  id "io.sentry.android.gradle" version "{{@inject packages.version('sentry.java.android.gradle-plugin', '4.10.0') }}"
}
```

```kotlin {filename:app/build.gradle.kts}
plugins {
  id("com.android.application")
  id("io.sentry.android.gradle") version "{{@inject packages.version('sentry.java.android.gradle-plugin', '4.10.0') }}"
}
```

Si tienes el SDK instalado sin el complemento de Gradle de Sentry, puedes actualizar la versión directamente en el `build.gradle` mediante:

```groovy {filename:app/build.gradle}
dependencies {
    implementation 'io.sentry:sentry-android:{{@inject packages.version('sentry.java.android', '7.12.0') }}'
}
```

```kotlin {filename:app/build.gradle.kts}
dependencies {
    implementation("io.sentry:sentry-android:{{@inject packages.version('sentry.java.android', '7.12.0') }}")
}
```

<div id="set-up">
  ## Configuración
</div>

Para configurar la integración, añade lo siguiente a la inicialización de Sentry.

```kotlin
SentryAndroid.init(context) { options ->
  options.dsn = "___PUBLIC_DSN___"
  options.isDebug = true

  options.sessionReplay.onErrorSampleRate = 1.0
  options.sessionReplay.sessionSampleRate = 0.1
  
  // si tu aplicación tiene requisitos estrictos de PII, te recomendamos usar la estrategia de captura de pantalla Canvas
  // Nota: esta estrategia es experimental y **no** admite opciones de enmascaramiento; siempre enmascara texto e imágenes
  // Disponible a partir de la versión 8.24.0 del SDK de Android
  // options.sessionReplay.screenshotStrategy = ScreenshotStrategyType.CANVAS
}
```

```XML {filename:AndroidManifest.xml}
<meta-data android:name="io.sentry.session-replay.on-error-sample-rate" android:value="1.0" />
<meta-data android:name="io.sentry.session-replay.session-sample-rate" android:value="0.1" />

<!-- si tu aplicación tiene requisitos estrictos de PII, recomendamos usar la estrategia de captura de pantalla Canvas -->
<!-- Nota: esta estrategia es experimental y **no** admite ninguna opción de enmascaramiento, siempre enmascara texto e imágenes -->
<!-- Disponible en el SDK de Android versión 8.24.0 o superior -->
<!-- <meta-data android:name="io.sentry.session-replay.screenshot-strategy" android:value="canvas" /> -->
```

<div id="verify">
  ## Verificar
</div>

Mientras haces pruebas, te recomendamos configurar `sessionSampleRate` en `1.0`. Esto garantiza que todas las sesiones de usuario se envíen a Sentry.

Una vez que termines las pruebas, **recomendamos reducir este valor en producción**. Aun así, recomendamos mantener `onErrorSampleRate` en `1.0`.

<div id="user-session">
  ## Sesión de usuario
</div>

Una sesión de usuario comienza cuando se inicializa el SDK de Sentry o cuando la aplicación pasa a primer plano. La sesión capturará transiciones de pantalla, navegaciones, toques y otros eventos hasta que la aplicación se envíe a segundo plano. Si la aplicación vuelve a primer plano dentro de 30 segundos (por defecto), se usará el mismo `replay_id` y la sesión continuará.

La sesión terminará si la aplicación ha permanecido en segundo plano más de 30 segundos o cuando se alcance la duración máxima de 60 minutos. Puedes ajustar el [intervalo de seguimiento de sesiones](/es/platforms/android/configuration/releases/#sessions) para ampliar o acortar la duración de una única reproducción, según tus necesidades.

<div id="replay-captures-on-errors-only">
  ### Capturas de reproducción solo en caso de error
</div>

Si prefieres no grabar la sesión completa, puedes elegir capturar una reproducción solo cuando ocurra un error. En ese caso, la integración almacenará hasta un minuto de eventos anteriores al momento en que se lance el error. Luego seguirá grabando la sesión, conforme a las reglas anteriores sobre duración y actividad de la sesión. Consulta la sección de [muestreo](#sampling) para opciones de configuración.

<div id="sampling">
  ## Muestreo
</div>

El muestreo te permite controlar qué porcentaje del tráfico de tu sitio web generará una Reproducción de sesión. Hay dos tasas de muestreo que puedes ajustar para obtener las reproducciones más relevantes para ti:

1. `sessionSampleRate` - La tasa de muestreo para
   reproducciones que empiezan a grabar de inmediato y abarcan toda la sesión del usuario.
2. `onErrorSampleRate` - La tasa de muestreo para
   reproducciones que se graban cuando ocurre un error. Este tipo de reproducción registrará
   hasta un minuto de eventos previos al error y seguirá grabando hasta que la sesión
   termine.

El muestreo comienza en cuanto inicia una sesión. Primero se evalúa `sessionSampleRate`. Si la muestra, se inicia la grabación de la reproducción. De lo contrario, se evalúa `onErrorSampleRate` y, si la muestra, la integración empezará a almacenar la reproducción en búfer y solo la subirá a Sentry si ocurre un error. El resto de la reproducción se comportará de forma similar a una reproducción de sesión completa.

<div id="privacy">
  ## Privacidad
</div>

El SDK registra y enmascara de forma agresiva todo el texto, las imágenes y las vistas web de manera predeterminada. Si tu app contiene datos sensibles, solo debes desactivar el enmascaramiento predeterminado después de ocultar explícitamente esos datos sensibles, usando las API descritas a continuación.
Sin embargo, si trabajas en una app móvil sin PII u otros tipos de datos privados, puedes inhabilitar la configuración predeterminada de enmascaramiento de texto e imágenes. Para obtener más información sobre la privacidad de Session Replay, [lee nuestra documentación](/es/platforms/android/session-replay/privacy/).

<Alert>
  Si detectas que otros datos no se están enmascarando con la configuración predeterminada, avísanos creando un [issue en GitHub](https://github.com/getsentry/sentry-java/issues/new?assignees=\&labels=Platform%3A+Android%2CType%3A+Bug\&projects=\&template=bug_report_android.yml).
</Alert>

Para desactivar el enmascaramiento por completo (no debe usarse en aplicaciones con datos sensibles):

```kotlin
options.sessionReplay.maskAllText = false
options.sessionReplay.maskAllImages = false
```

```XML {filename:AndroidManifest.xml}
<meta-data android:name="io.sentry.session-replay.mask-all-text" android:value="false" />
<meta-data android:name="io.sentry.session-replay.mask-all-images" android:value="false" />
```

<div id="screenshot-strategy">
  ### Estrategia de captura de pantalla
</div>

El SDK ofrece dos estrategias para grabar reproducciones: `PixelCopy` y `Canvas`.

`PixelCopy` utiliza la API [PixelCopy](https://developer.android.com/reference/android/view/PixelCopy) de Android para capturar la pantalla actual y toma una instantánea de la jerarquía de vistas dentro del mismo fotograma. Luego, la jerarquía de vistas se usa para localizar la posición de controles como cuadros de texto, imágenes, etiquetas y botones, y enmascararlos con un bloque dibujado sobre dichos controles. Esta estrategia tiene un costo de rendimiento ligeramente menor, pero puede provocar desalineaciones del enmascaramiento debido a la naturaleza asíncrona de la API PixelCopy. Recomendamos usar esta estrategia en apps que no tengan requisitos estrictos de PII o que no requieran funcionalidad de enmascaramiento.

`Canvas` utiliza la API personalizada [Canvas](https://developer.android.com/reference/android/graphics/Canvas) de Android para volver a dibujar el contenido de la pantalla en un bitmap, enmascarando todas las operaciones `drawText` y `drawBitmap` durante el proceso para producir una captura de pantalla enmascarada. Esta estrategia tiene un costo de rendimiento ligeramente mayor, pero ofrece un enmascaramiento más confiable. Recomendamos usar esta estrategia en apps con requisitos estrictos de PII.

<Alert level="warning">
  La estrategia de captura de pantalla `Canvas` es actualmente experimental y **no** admite ninguna opción de enmascaramiento. Cuando la estrategia de captura de pantalla esté configurada en `Canvas`, **siempre** enmascarará todos los textos, campos de entrada e imágenes, sin tener en cuenta ninguna opción de enmascaramiento establecida. Si necesitas más flexibilidad con el enmascaramiento, vuelve a `PixelCopy`.
</Alert>

Puedes cambiar la estrategia de la siguiente manera:

```kotlin
import io.sentry.ScreenshotStrategyType

options.sessionReplay.screenshotStrategy = ScreenshotStrategyType.CANVAS // o ScreenshotStrategyType.PIXEL_COPY (valor predeterminado)
```

```XML {filename:AndroidManifest.xml}
<meta-data android:name="io.sentry.session-replay.screenshot-strategy" android:value="canvas|pixelCopy" />
```

<div id="error-linking">
  ## Vinculación de errores
</div>

Los errores que ocurren mientras se ejecuta una repetición se vinculan a esa repetición, lo que permite alternar entre incidencias y repeticiones relacionadas. Sin embargo, es **posible** que en algunos casos el recuento de errores que se muestra en la página de **Detalles de la repetición** no coincida con los errores reales que se han capturado. Esto se debe a que algunos errores pueden perderse y, aunque no es frecuente, hay algunas razones por las que podría ocurrir:

* La repetición se limitó por tasa y no pudo aceptarse.
* La repetición fue eliminada por un miembro de tu organización.
* Hubo errores de red y la repetición no se guardó.