---
title: Kit de Desarrollo Nativo de Android (NDK)
sidebar_order: 2
description: "Aprende a configurar la integración del NDK."
---

El Android Native Development Kit (NDK) te permite implementar partes de tu app en código nativo, usando lenguajes como C y C++.

La integración del NDK viene incluida con el SDK. El paquete `sentry-android-ndk` funciona agrupando el SDK nativo de Sentry, [`sentry-native`](/es/platforms/native/). Como resultado, incluso si una biblioteca nativa en tu app causa un bloqueo, Sentry puede capturarlo.

Puedes [desactivar la integración del NDK](#disable-ndk-integration) o usar nuestro SDK de Sentry para Android [sin el NDK](#using-the-sdk-without-the-ndk).

<div id="symbolicate-stack-traces">
  ## Simbolizar las trazas de pila
</div>

Para simbolizar la traza de pila del código nativo, necesitamos tener acceso a los símbolos de depuración de tu aplicación.

Usa el [Sentry Android Gradle Plugin](/es/platforms/android/configuration/gradle/) para subir automáticamente los símbolos de depuración y el código fuente.

Como alternativa, si no usas Gradle, puedes subir tus archivos `.so` manualmente mediante `sentry-cli`.
Consulta la documentación completa sobre [carga de archivos](/es/platforms/android/data-management/debug-files/upload/) para obtener más información sobre la subida de símbolos de depuración.

<div id="allowing-the-compiler-to-link-libraries">
  ## Permitir que el compilador enlace bibliotecas
</div>

Para usar el NDK de Android en tu código nativo, incluye las bibliotecas NDK de `sentry-native` para que el compilador pueda enlazarlas durante la compilación. Usa Android Prefab para consumir los paquetes precompilados de Sentry y enlazarlos en tu `CMakeLists.txt`.

<Alert>
  La compatibilidad con Android Prefab solo está disponible a partir de la versión 8.0.0 del SDK de Sentry para Android.
</Alert>

Activa Prefab y añade directamente a tu módulo la dependencia NDK de sentry-native:

```kotlin {filename:app/build.gradle}
android {
    buildFeatures {
        prefab = true
    }
}

dependencies {
    // La versión DEBE coincidir con la que usa el SDK de Sentry para Android.
    // Consulta https://github.com/getsentry/sentry-java/blob/{{@inject packages.version('sentry.java.android', '8.21.1') }}/gradle/libs.versions.toml
    implementation("io.sentry:sentry-native-ndk:<version>")
}
```

Vincula los paquetes precompilados con tu código nativo

```text {filename:app/CMakeLists.txt}
find_package(sentry-native-ndk REQUIRED CONFIG)

target_link_libraries(<app> PRIVATE
    sentry-native-ndk::sentry-android
    sentry-native-ndk::sentry
)
```

Ahora puedes usar la API de Sentry NDK con solo incluir `sentry.h` en tu código:

```c
#include <jni.h>
#include <android/log.h>
#include <sentry.h>

#define TAG "sentry-android-demo"
extern "C" JNIEXPORT jstring JNICALL

Java_io_sentry_demo_NativeDemo_crash(JNIEnv *env, jclass cls) {
    __android_log_print(ANDROID_LOG_WARN, "", "Capturar un mensaje.");
    sentry_value_t event = sentry_value_new_message_event(
            /*   level */ SENTRY_LEVEL_INFO,
            /*  logger */ "custom",
            /* mensaje */ "Mensaje de ejemplo"
    );
    sentry_capture_event(event);
}
```

<div id="disable-ndk-integration">
  ## Desactivar la integración de NDK
</div>

Puedes desactivar la integración de NDK agregando lo siguiente a tu `AndroidManifest.xml`:

```xml {filename:AndroidManifest.xml}
<application>
    <meta-data android:name="io.sentry.ndk.enable" android:value="false" />
</application>
```

<div id="using-the-sdk-without-the-ndk">
  ## Usar el SDK sin el NDK
</div>

Puedes usar el SDK de Android de Sentry sin el Android Native Development Kit (NDK) de cualquiera de estas formas:

* [Desactivar la integración del NDK](#disable-ndk-integration)
* Usar `sentry-android-core`, que no incluye el NDK y puede usarse por separado en lugar de `sentry-android` al agregar la dependencia. El nivel mínimo de API requerido para `sentry-android-core` es 14.

Si estás usando nuestro [plugin de Gradle](/es/platforms/android/configuration/gradle/), igual incorporará la integración del NDK como parte de la función de instalación automática. Para desactivarla, elimina la dependencia `sentry-android-ndk` de las configuraciones de la app en `app/build.gradle`:

```groovy
configurations.configureEach {
  exclude group: "io.sentry", module: "sentry-android-ndk"
}
```

```kotlin
configurations.configureEach {
  exclude(group = "io.sentry", module = "sentry-android-ndk")
}
```

<div id="troubleshooting">
  ## Solución de problemas
</div>

<div id="missing-debug-images-or-unsymbolicated-stack-traces">
  ### Imágenes de depuración faltantes o trazas de pila sin simbolizar
</div>

Las trazas de pila sin simbolizar pueden deberse al caché de módulos del lado del SDK. Asegúrate de borrar cualquier caché de módulos existente si tus módulos se cargan dinámicamente:

```cpp
// 1. Carga un módulo nuevo
load_my_module();

// 2. Limpia la caché del módulo
sentry_clear_modulecache();
```

```kotlin
// 1. Inicializar manualmente el SDK, 
// para mantener una referencia a las opciones del SDK
var optionsRef: SentryAndroidOptions? = null
SentryAndroid.init(this) { options ->
    options.dsn = "___PUBLIC_DSN___"
    // ...
    optionsRef = options
}

// 2. Cargar un nuevo módulo
System.loadLibrary("<library>")

// 3. Limpiar el caché
optionsRef?.debugImagesLoader?.clearDebugImages()
```
