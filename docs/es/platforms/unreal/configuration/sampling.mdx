---
title: Muestreo
description: "Aprende a configurar el volumen de eventos de error y transacción enviados a Sentry."
sidebar_order: 50
---

Agregar Sentry a tu aplicación te brinda muchísima información valiosa sobre errores y rendimiento que de otro modo no obtendrías. Y contar con mucha información es bueno, siempre que sea la adecuada y en una cantidad razonable.

<div id="sampling-error-events">
  ## Muestreo de eventos de error
</div>

Para enviar una muestra representativa de tus errores a Sentry, define la opción <PlatformIdentifier name="sample-rate" /> en la configuración de tu SDK con un valor entre `0` (se envía el 0% de los errores) y `1` (se envía el 100% de los errores). Es una tasa fija que se aplicará por igual a todos los errores. Por ejemplo, para muestrear el 25% de tus errores:

<PlatformContent includePath="configuration/sample-rate" />

La tasa de muestreo de errores es `1` de forma predeterminada, lo que significa que todos los errores se envían a Sentry.

<Alert>

Cambiar la tasa de muestreo de errores requiere volver a desplegar. Además, establecer una tasa de muestreo en el SDK limita la visibilidad del origen de los eventos. Configurar un límite de tasa para tu proyecto (que solo descarta eventos cuando el volumen es alto) puede ajustarse mejor a tus necesidades.

</Alert>

<div id="sampling-transaction-events">
  ## Muestreo de eventos de transacción
</div>

Recomendamos muestrear tus transacciones por dos razones:

1. Capturar una sola traza supone una sobrecarga mínima, pero capturar trazas para _cada_ nivel cargado o _cada_ solicitud a la API puede añadir una carga indeseable a tu sistema.

2. Habilitar el muestreo te permite gestionar mejor la cantidad de eventos enviados a Sentry, para ajustar tu volumen según las necesidades de tu organización.

Elige una tasa de muestreo con el objetivo de equilibrar las consideraciones de rendimiento y volumen con la precisión de los datos. No quieres recopilar _demasiados_ datos, pero sí los suficientes para extraer conclusiones significativas. Si no estás seguro de qué tasa elegir, empieza con un valor bajo y auméntalo gradualmente a medida que conozcas mejor tus patrones de tráfico y volumen.

<div id="configuring-the-transaction-sample-rate">
  ## Configuración de la tasa de muestreo de transacciones
</div>

Los SDK de Sentry tienen dos opciones de configuración para controlar el volumen de transacciones enviadas a Sentry, lo que te permite obtener una muestra representativa:

1. Tasa de muestreo uniforme (<PlatformIdentifier name="traces-sample-rate" />):

   - Proporciona una muestra equilibrada de transacciones, sin importar dónde ocurran en tu app o bajo qué circunstancias.
   - Usa el comportamiento predeterminado de [herencia](#inheritance) y [precedencia](#precedence)

2. Función de muestreo (<PlatformIdentifier name="traces-sampler" />) que:
   - Muestra distintas transacciones a diferentes tasas
   - <PlatformLink to="/configuration/filtering/">Filtra</PlatformLink> por completo algunas
     transacciones
   - Modifica el comportamiento predeterminado de [precedencia](#precedence) y [herencia](#inheritance)

De forma predeterminada, ninguna de estas opciones está configurada, lo que significa que no se enviarán transacciones a Sentry. Debes configurar una de las opciones para empezar a enviar transacciones.

<div id="setting-a-uniform-sample-rate">
  ### Configurar una tasa de muestreo uniforme
</div>

<PlatformContent includePath="performance/uniform-sample-rate" />

<div id="setting-a-sampling-function">
  ### Configuración de una función de muestreo
</div>

<PlatformContent includePath="performance/sampling-function-intro" />

<div id="sampling-context-data">
  ## Muestreo de datos de contexto
</div>

<div id="default-sampling-context-data">
  ### Datos predeterminados del contexto de muestreo
</div>

La información contenida en el objeto <PlatformIdentifier name="sampling-context" /> que se pasa a <PlatformIdentifier name="traces-sampler" /> cuando se crea una transacción varía según la plataforma y la integración.

<PlatformContent includePath="performance/default-sampling-context" />

<div id="custom-sampling-context-data">
  ### Datos de contexto de muestreo personalizados
</div>

Al usar instrumentación personalizada para crear una transacción, puedes añadir datos al <PlatformIdentifier name="sampling-context" /> pasándolos como segundo argumento opcional a <PlatformIdentifier name="start-transaction" />. Esto es útil si hay datos a los que quieres que el muestreador tenga acceso, pero no quieres adjuntarlos a la transacción como `tags` o `data`, por ejemplo porque son sensibles o demasiado grandes para enviarlos con la transacción. Por ejemplo:

<PlatformContent includePath="performance/custom-sampling-context" />

<div id="inheritance">
  ## Herencia
</div>

Independientemente de la decisión de muestreo de una transacción, esa decisión se transmitirá a sus spans hijos y, desde allí, a cualquier transacción que estas activen posteriormente en otros servicios.

(Consulta <PlatformLink to="/tracing/trace-propagation/">Trazado distribuido</PlatformLink> para obtener más información sobre cómo se realiza esa propagación).

Si la transacción que se está creando actualmente es una de esas transacciones posteriores (es decir, si tiene una transacción padre), la decisión de muestreo ascendente (del padre) se incluirá en los datos del contexto de muestreo. Tu <PlatformIdentifier name="traces-sampler" /> puede usar esta información para decidir si heredar esa decisión. En la mayoría de los casos, heredar es lo correcto, para evitar romper trazas distribuidas. Una traza rota no incluirá todos tus servicios.

Si estás usando un <PlatformIdentifier name="traces-sample-rate" /> en lugar de un <PlatformIdentifier name="traces-sampler" />, la decisión siempre se heredará.

<div id="precedence">
  ## Precedencia
</div>

Hay varias maneras en que una transacción puede acabar con una decisión de muestreo.

- Muestreo aleatorio según una tasa de muestreo estática establecida en <PlatformIdentifier name="traces-sample-rate" />
- Muestreo aleatorio según una tasa devuelta por la función <PlatformIdentifier name="traces-sampler" />
- Decisión absoluta (probabilidad del 100% o del 0%) devuelta por <PlatformIdentifier name="traces-sampler" />
- Si la transacción tiene un padre, hereda la decisión de muestreo de este
- Decisión absoluta pasada a <PlatformIdentifier name="start-transaction" />

Cuando existe la posibilidad de que más de una de estas entre en juego, se aplican las siguientes reglas de precedencia:

1. Si se pasa una decisión de muestreo a <PlatformIdentifier name="start-transaction" />, se usará esa decisión y se ignorará cualquier otra.
1. Si <PlatformIdentifier name="traces-sampler" /> está definido, se usará su decisión. Puede optar por mantener o ignorar cualquier decisión de muestreo del padre, usar los datos del contexto de muestreo para tomar su propia decisión o elegir una tasa de muestreo para la transacción. Desaconsejamos anular la decisión de muestreo del padre porque romperá los trazados distribuidos.
1. Si <PlatformIdentifier name="traces-sampler" /> no está definido, pero hay una decisión de muestreo del padre, se usará la decisión del padre.
1. Si <PlatformIdentifier name="traces-sampler" /> no está definido y no hay decisión de muestreo del padre, se usará <PlatformIdentifier name="traces-sample-rate" />.

<Alert>

Actualmente no se admite forzar una decisión de muestreo pasándola a <PlatformIdentifier name="start-transaction" />.

</Alert>