---
title: Hydrogen con Remix (legado)
description: Aprende a usar el SDK de Sentry para Remix para instrumentar tu app de Hydrogen (versiones anteriores a 2025.5.0).
---

<Alert level="info" title="Versión de Hydrogen">
  Esta guía se aplica a las versiones de Hydrogen **anteriores a 2025.5.0** que usan Remix v2. Para versiones más recientes de Hydrogen (2025.5.0+) que usan React Router 7, consulta la [guía de React Router](/es/platforms/javascript/guides/cloudflare/frameworks/hydrogen-react-router/).
</Alert>

Si usas el framework Hydrogen de Shopify con Remix v2, puedes usar el SDK de Sentry para Remix para agregar instrumentación de Sentry a tu app.

<div id="installing-sentry-remix-and-cloudflare-sdks">
  ## Instalación de los SDK de Sentry Remix y Cloudflare
</div>

Primero, instala los SDK de Sentry Remix y Cloudflare con tu gestor de paquetes:

```bash {tabTitle:npm}
npm install @sentry/remix @sentry/cloudflare --save
```

```bash {tabTitle:yarn}
yarn add @sentry/remix @sentry/cloudflare
```

```bash {tabTitle:pnpm}
pnpm add @sentry/remix @sentry/cloudflare
```

<div id="instrumenting-your-server">
  ## Instrumentación de tu servidor
</div>

Actualiza tu archivo `server.ts` para usar el método `wrapRequestHandler` de `@sentry/cloudflare/request` y `instrumentBuild` de `@sentry/remix/cloudflare`:

```ts {filename:server.ts}
import { wrapRequestHandler } from "@sentry/cloudflare/request";
import { instrumentBuild } from "@sentry/remix/cloudflare";
import { createRequestHandler } from "@remix-run/cloudflare";
// Punto de entrada virtual de la aplicación
import * as remixBuild from 'virtual:remix/server-build';

/**
 * Exporta un manejador de fetch en formato de módulo.
 */
export default {
  async fetch(
    request: Request,
    env: Env,
    executionContext: ExecutionContext
  ): Promise<Response> {
    return wrapRequestHandler(
      {
        options: {
          dsn: "YOUR_DSN_HERE",
          tracesSampleRate: 1.0,
        },
        // Es necesario hacer cast a any porque esto no está en cloudflare
        request: request as any,
        context: executionContext,
      },
      async () => {
        // Instrumenta tu compilación del servidor con Sentry
        // y usa la compilación instrumentada dentro del manejador de fetch
        const instrumentedBuild = instrumentBuild(remixBuild);

        const handleRequest = createRequestHandler({
          build: instrumentedBuild,
          mode: process.env.NODE_ENV,
          getLoadContext: (): AppLoadContext => ({
            // tu contexto de carga
          }),
        });

        return handleRequest(request);
      }
    );
  },
};
```

<div id="instrumenting-your-client">
  ## Instrumentación del cliente
</div>

Envuelve tu componente raíz de Remix con `withSentry`:

```tsx {filename:app/root.tsx}
import * as Sentry from "@sentry/remix/cloudflare";
import { useEffect } from "react";
import { useLocation, useMatches } from "@remix-run/react";

function App() {
  return (
    // El contenido de tu aplicación
  );
}

// Pasa los hooks `useEffect`, `useLocation` y `useMatches` a `withSentry`
export default Sentry.withSentry(App, useEffect, useLocation, useMatches);
```

Por último, actualiza tu archivo `entry.client.tsx` para inicializar el SDK de Sentry en el cliente:

```tsx {filename:app/entry.client.tsx}
import * as Sentry from "@sentry/remix/cloudflare";
import { useEffect } from "react";
import { useLocation, useMatches } from "@remix-run/react";

Sentry.init({
  dsn: "___PUBLIC_DSN___",
  integrations: [
    Sentry.browserTracingIntegration({
      useEffect,
      useLocation,
      useMatches,
    }),
    // Replay solo está disponible en el cliente
    Sentry.replayIntegration(),
  ],

  // Establece tracesSampleRate en 1.0 para capturar el 100%
  // de las transacciones para el rastreo.
  // Te recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,

  // Establece `tracePropagationTargets` para controlar en qué URLs se debe habilitar el rastreo distribuido
  tracePropagationTargets: ["localhost", /^https:\/\/yourserver\.io\/api/],

  // Captura Replay para el 10% de todas las sesiones,
  // más el 100% de las sesiones con error
  // Más información en
  // https://docs.sentry.io/platforms/javascript/session-replay/configuration/#general-integration-configuration
  replaysSessionSampleRate: 0.1,
  replaysOnErrorSampleRate: 1.0,
});
```
