---
title: Astro en Cloudflare
description: "Aprende a añadir instrumentación de Cloudflare a tu app de Astro."
---

<div id="install">
  ## Instalación
</div>

Si ejecutas tu aplicación de Astro en Cloudflare Pages, puedes usar el Sentry Astro SDK junto con el Sentry Cloudflare SDK para añadir la instrumentación de Sentry.

Primero, instala el Sentry Astro SDK en tu aplicación. Recomendamos [configurar el Astro SDK manualmente](/es/platforms/javascript/guides/astro/manual-setup/) e inicializar el SDK de forma manual. Asegúrate de haber creado un archivo `sentry.client.config.js`, pero no añadas un archivo `sentry.server.config.js`.

Después de instalar el Sentry Astro SDK, puedes instalar el Sentry Cloudflare SDK. Primero, instala el SDK con tu gestor de paquetes:

<PlatformContent includePath="getting-started-install" />

<div id="setup">
  ## Configuración
</div>

La configuración principal de Sentry debe realizarse lo antes posible en el ciclo de vida de tu aplicación.

<PlatformContent includePath="getting-started-config" />

Luego, crea un directorio `functions` y añade un archivo `_middleware.js` con el siguiente código:

```javascript {filename:functions/_middleware.js}
import * as Sentry from "@sentry/cloudflare";

export const onRequest = [
  // Asegúrate de que Sentry sea el primer middleware
  Sentry.sentryPagesPlugin((context) => ({
    dsn: "___PUBLIC_DSN___",
    // Establece tracesSampleRate en 1.0 para capturar el 100% de los spans para el rastreo.
    // Más información en
    // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
    tracesSampleRate: 1.0,
  })),
  // Añade más middlewares aquí
];
```
