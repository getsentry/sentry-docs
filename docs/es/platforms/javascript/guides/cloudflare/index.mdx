---
title: Cloudflare
description: "Aprende a configurar manualmente Sentry para Cloudflare Workers y Cloudflare Pages y a capturar tus primeros errores."
sdk: sentry.javascript.cloudflare
categories:
  - javascript
  - server
  - server-edge
  - serverless
---

Usa esta guía para obtener instrucciones generales sobre cómo usar el SDK de Sentry con Cloudflare. Si estás utilizando alguno de los frameworks de la lista, sigue sus instrucciones de configuración específicas:

* **[Astro](frameworks/astro/)**
* **[Hono](frameworks/hono/)**
* **[Hydrogen](frameworks/hydrogen-react-router/)**
* **[Nuxt](frameworks/nuxt/)**
* **[Remix](frameworks/remix/)**
* **[SvelteKit](frameworks/sveltekit/)**

<PlatformContent includePath="getting-started-prerequisites" />

<div id="step-1-install">
  ## Paso 1: Instalación
</div>

Elige las funciones que quieres configurar y esta guía te mostrará cómo:

<OnboardingOptionButtons options={["error-monitoring", "performance", "logs"]} />

<PlatformContent includePath="getting-started-features-expandable" />

<div id="install-the-sentry-sdk">
  ### Instala el SDK de Sentry
</div>

Ejecuta el comando de tu gestor de paquetes preferido para añadir el SDK de Sentry a tu aplicación:

<PlatformContent includePath="getting-started-install" />

<div id="step-2-configure">
  ## Paso 2: Configurar
</div>

La configuración principal de Sentry debe realizarse lo antes posible en el ciclo de vida de tu aplicación.

<div id="wrangler-configuration">
  ### Configuración de Wrangler
</div>

<PlatformContent includePath="getting-started-config" />

<div id="setup-for-cloudflare-workers">
  ### Configuración para Cloudflare Workers
</div>

<PlatformContent includePath="getting-started-config" platform="javascript.cloudflare.workers" />

<Expandable title="¿No tienes acceso a onRequest?">
  Si no tienes acceso a la API de middleware `onRequest`, puedes utilizar la API `wrapRequestHandler` en su lugar. Por ejemplo:

  ```javascript
  // hooks.server.js
  import * as Sentry from "@sentry/cloudflare";

  export const handle = ({ event, resolve }) => {
    const requestHandlerOptions = {
      options: {
        dsn: event.platform.env.SENTRY_DSN,
        tracesSampleRate: 1.0,
      },
      request: event.request,
      context: event.platform.ctx,
    };
    return Sentry.wrapRequestHandler(requestHandlerOptions, () => resolve(event));
  };
  ```
</Expandable>

<div id="setup-for-cloudflare-pages">
  ### Configuración para Cloudflare Pages
</div>

Para usar el SDK de Sentry, agrega `sentryPagesPlugin` como [middleware en tu aplicación de Cloudflare Pages](https://developers.cloudflare.com/pages/functions/middleware/).
Para ello, te recomendamos crear un archivo `functions/_middleware.js` para configurar el middleware en toda tu app:

```javascript {filename:functions/_middleware.js}
import * as Sentry from "@sentry/cloudflare";

export const onRequest = [
  // Asegúrate de que Sentry sea el primer middleware
  Sentry.sentryPagesPlugin((context) => {
    const { id: versionId } = env.CF_VERSION_METADATA;

    return {
      dsn: "___PUBLIC_DSN___",

      release: versionId,

      // Añade los encabezados de la solicitud y la IP de los usuarios; para más información, visita:
      // https://docs.sentry.io/platforms/javascript/guides/cloudflare/configuration/options/#sendDefaultPii
      sendDefaultPii: true,
      // ___PRODUCT_OPTION_START___ logs

      // Habilita el envío de logs a Sentry
      enableLogs: true,
      // ___PRODUCT_OPTION_END___ logs
      // ___PRODUCT_OPTION_START___ performance

      // Configura tracesSampleRate en 1.0 para capturar el 100% de los spans de trazado.
      // Más información en
      // https://docs.sentry.io/platforms/javascript/guides/cloudflare/configuration/options/#tracesSampleRate
      tracesSampleRate: 1.0,
      // ___PRODUCT_OPTION_END___ performance
    };
  }),
  // Añade más middlewares aquí
];
```

<div id="step-3-add-readable-stack-traces-with-source-maps-optional">
  ## Paso 3: Añade trazas de pila legibles con mapas de origen (opcional)
</div>

<PlatformContent includePath="getting-started-sourcemaps-short-version" />

<div id="step-4-verify-your-setup">
  ## Paso 4: Verifica tu configuración
</div>

Probemos tu configuración y confirmemos que Sentry funciona correctamente y está enviando datos a tu proyecto en Sentry.

<div id="issues">
  ### Incidencias
</div>

Primero, asegurémonos de que Sentry esté capturando correctamente los errores y creando incidencias en tu proyecto.

<div id="cloudflare-workers">
  #### Cloudflare Workers
</div>

Añade el siguiente fragmento de código a tu archivo principal del worker para crear una ruta `/debug-sentry` que provoque un error al invocarse:

```javascript {filename:index.js}
export default {
  async fetch(request) {
    const url = new URL(request.url);

    if (url.pathname === "/debug-sentry") {
      throw new Error("Mi primer error de Sentry!");
    }

    // Tus rutas y lógica existentes aquí...
    return new Response("...");
  },
};
```

<div id="cloudflare-pages">
  #### Cloudflare Pages
</div>

Crea una nueva ruta que arroje un error al invocarse añadiendo el siguiente fragmento de código a un archivo en tu directorio `functions`, por ejemplo `functions/debug-sentry.js`:

```javascript {filename:debug-sentry.js}
export async function onRequest(context) {
  throw new Error("Mi primer error de Sentry!");
}
```

<OnboardingOption optionId="performance">
  ### Trazado

  Para probar tu configuración de trazado, actualiza el fragmento de código anterior iniciando un trace para medir el tiempo que tarda en ejecutarse tu código.

  #### Cloudflare Workers

  ```javascript {filename:index.js}
  export default {
    async fetch(request) {
      const url = new URL(request.url);

      if (url.pathname === "/debug-sentry") {
        await Sentry.startSpan(
          {
            op: "test",
            name: "My First Test Transaction",
          },
          async () => {
            await new Promise((resolve) => setTimeout(resolve, 100)); // Espera 100 ms
            throw new Error("My first Sentry error!");
          }
        );
      }

      // Aquí tus rutas y lógica existentes...
      return new Response("...");
    },
  };
  ```

  #### Cloudflare Pages

  ```javascript {filename:debug-sentry.js}
  export async function onRequest(context) {
    await Sentry.startSpan(
      {
        op: "test",
        name: "My First Test Transaction",
      },
      async () => {
        await new Promise((resolve) => setTimeout(resolve, 100)); // Espera 100 ms
        throw new Error("My first Sentry error!");
      }
    );
  }
  ```
</OnboardingOption>

<div id="view-captured-data-in-sentry">
  ### Ver los datos capturados en Sentry
</div>

Ahora, ve a tu proyecto en [Sentry.io](https://sentry.io) para ver los datos recopilados (puede tardar unos momentos en aparecer).

<PlatformContent includePath="getting-started-verify-locate-data" />

<div id="next-steps">
  ## Próximos pasos
</div>

A estas alturas, deberías haber integrado Sentry y estar enviando datos a tu proyecto de Sentry.

Este es un buen momento para personalizar tu configuración y explorar temas más avanzados. Te recomendamos como siguientes pasos:

* Aprende a [capturar errores manualmente](/es/platforms/javascript/guides/cloudflare/usage/)
* Sigue [personalizando tu configuración](/es/platforms/javascript/guides/cloudflare/configuration/)
* Aprovecha las [funciones específicas de Cloudflare](/es/platforms/javascript/guides/cloudflare/features)
* Familiarízate con [las funciones del producto de Sentry](/es/product), como el tracing, las insights y las alertas

<Expandable permalink={false} title="¿Tienes problemas para configurar el SDK?">
  - Consulta las instrucciones de configuración para [frameworks en Cloudflare](/es/platforms/javascript/guides/cloudflare/frameworks/)
  - Encuentra varios temas de ayuda en <PlatformLink to="/troubleshooting">solución de problemas</PlatformLink>
  - [Obtén soporte](https://sentry.zendesk.com/hc/en-us/)
</Expandable>