---
title: Capa de Lambda
description: >-
  Aprende cómo agregar la capa de Lambda de Sentry para usar Sentry en tus
  funciones Lambda
sidebar_order: 1
og_image: /og-images/platforms-javascript-guides-aws-lambda-install-layer.png
---

La forma más fácil de empezar con Sentry es usar la [capa de Lambda](https://docs.aws.amazon.com/lambda/latest/dg/adding-layers.html) de Sentry en lugar de instalar `@sentry/aws-serverless` manualmente con un gestor de paquetes.
Si sigues esta guía, no tendrás que preocuparte por implementar las dependencias de Sentry junto con el código de tu función.

<div id="prerequisites">
  ## Requisitos previos
</div>

Antes de comenzar, asegúrate de contar con lo siguiente:

* Tienes una función Lambda implementada en AWS.
* Conoces la región de AWS en la que está implementada tu función.

<div id="1-add-the-sentry-lambda-layer">
  ## 1. Agrega la capa de Sentry para Lambda
</div>

Agrega la capa de Sentry navegando a tu función Lambda. Selecciona **Layers** y luego **Add a Layer**.

![](./img/lambda_view.png)

Pestaña **Specify an ARN**, como se muestra:

![](./img/add_layer.png)

Por último, establece la región y copia el ARN proporcionado en el campo de entrada.

<LambdaLayerDetail canonical="aws-layer:node" />

<br />

<div id="2-setup-options">
  ## 2. Opciones de configuración
</div>

<div id="option-a-automatic-setup-recommended">
  ### Opción A: Configuración automática (recomendada)
</div>

Además de capturar errores, puedes supervisar las interacciones entre varios servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/).

Selecciona qué funcionalidades de Sentry quieres instalar, además de Error Monitoring, para obtener a continuación las instrucciones correspondientes de instalación y configuración.

<OnboardingOptionButtons options={["error-monitoring", "performance"]} />

Configura las siguientes variables de entorno en la configuración de tu función Lambda:

```bash
NODE_OPTIONS="--import @sentry/aws-serverless/awslambda-auto"
SENTRY_DSN="___PUBLIC_DSN___"
# ___PRODUCT_OPTION_START___ performance
SENTRY_TRACES_SAMPLE_RATE="1.0"
# ___PRODUCT_OPTION_END___ performance
```

Para configurar variables de entorno, ve a tu función Lambda, selecciona **Configuration** y luego **Environment variables**:

![](./img/env_vars.png)

<div id="option-b-manual-setup">
  ### Opción B: Configuración manual
</div>

Para personalizar aún más la configuración del SDK, también puedes inicializarlo manualmente en tu función Lambda. La ventaja de este método de instalación es que puedes personalizar por completo tu configuración del SDK de Sentry en una llamada a `Sentry.init`.

Ten en cuenta que no necesitas instalar un paquete de NPM para que esto funcione, ya que el paquete ya está incluido en la Lambda Layer.

Crea un archivo nuevo, por ejemplo `instrument.js`, para inicializar el SDK:

```javascript {filename:instrument.js} {tabTitle:CommonJS}
const Sentry = require("@sentry/aws-serverless");

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega los encabezados de la solicitud y la IP de los usuarios. Para obtener más información, visita:
  // https://docs.sentry.io/platforms/javascript/guides/aws-lambda/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ performance

  // Agrega tracing configurando tracesSampleRate y añadiendo la integración
  // Establece tracesSampleRate en 1.0 para capturar el 100 % de las transacciones
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
});
```

```javascript {filename:instrument.mjs} {tabTitle:ESM}
import * as Sentry from "@sentry/aws-serverless";

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega encabezados de la solicitud y la IP de los usuarios; para más información, visita:
  // https://docs.sentry.io/platforms/javascript/guides/aws-lambda/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ performance

  // Agrega Tracing configurando tracesSampleRate y añadiendo la integración
  // Configura tracesSampleRate en 1.0 para capturar el 100% de las transacciones
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
});
```

<div id="load-the-sdk">
  ##### Carga el SDK
</div>

Para cargar el SDK antes de que se inicie tu función, debes precargar `instrument.js` configurando la variable de entorno `NODE_OPTIONS`:

```bash
NODE_OPTIONS="--import ./instrument.js"
```

¡Listo! Asegúrate de volver a desplegar tu función y todo quedará preparado.
