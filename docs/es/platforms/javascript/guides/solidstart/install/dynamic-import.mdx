---
title: Importación dinámica (experimental)
sidebar_order: 3
description: "Descubre cómo el SDK de SolidStart aprovecha input() dinámico en el resultado de la compilación."
---

<div id="understanding-the-import-expression">
  ## Comprender la expresión `import()`
</div>

<Alert level='warning'>
  Esta configuración es experimental: no se garantiza que funcione en todos los entornos y la funcionalidad subyacente podría cambiar.

  Recomendamos leer la guía para instalar el SDK con la <PlatformLink to="/install/cli-import">opción de CLI `--import`</PlatformLink> o con <PlatformLink to="/install/limited-server-tracing">trazado limitado en el servidor</PlatformLink>
</Alert>

La expresión `import()`, o importación dinámica, permite una carga de módulos flexible y condicional en ESM.
Node.js generará un grafo de módulos independiente para cualquier código envuelto en un `import()` dinámico. Este grafo independiente se evalúa **después** de todos los módulos que se importan de forma estática.

Al usar el SDK de Sentry SolidStart, la aplicación del lado del servidor se envolverá en un `import()` dinámico, mientras que el archivo de instrumentación de Sentry se importará con un `import` estático.
Esto permite inicializar el SDK de Sentry SolidStart al inicio, mientras que el tiempo de ejecución del servidor Nitro se carga más tarde porque se importa con `import()`.
Esta inicialización temprana de Sentry es necesaria para configurar correctamente la instrumentación del SDK en varias bibliotecas.

<div id="scenarios-where-import-doesnt-work">
  ## Escenarios en los que `import()` no funciona
</div>

Según tu configuración y la versión de Vinxi que uses (y, respectivamente, Nitro, ya que se ejecuta en segundo plano), a veces el lado del servidor no se inicializa correctamente.
El resultado de la compilación **no debe** incluir un `import` normal del runtime de Nitro (p. ej., `import './chunks/nitro/nitro.mjs'`).

También puedes consultar la guía para instalar el SDK con la <PlatformLink to="/install/cli-import">opción de la CLI `--import`</PlatformLink> o <PlatformLink to="/install/limited-server-tracing">limited-server-tracing</PlatformLink>.

<div id="initializing-sentry-with-dynamic-import">
  ## Inicializar Sentry con `import()` dinámico
</div>

Activa el `import()` dinámico configurando `autoInjectServerSentry`:

```typescript {filename:app.config.ts} {8}
import { defineConfig } from '@solidjs/start/config';
import { withSentry } from '@sentry/solidstart';

export default defineConfig(withSentry(
    {},
    {
      autoInjectServerSentry: 'experimental_dynamic-import'
    })
 );
```

Después de establecer esto, el SDK de Sentry para SolidStart añadirá una configuración en tiempo de compilación para que tu aplicación quede envuelta con `import()`,
garantizando que Sentry pueda inicializarse antes que cualquier otro módulo.

El archivo de entrada del servidor de SolidStart se verá algo así:

```javascript {filename:.output/server/index.mjs}
// Nota: el archivo puede incluir algunas importaciones y código relacionados con IDs de depuración
Sentry.init({
  dsn: "..."
});

import('./chunks/nitro/nitro.mjs').then(function (n) { return n.r; });
```


<div id="re-exporting-serverless-handler-functions">
  ## Reexportar funciones manejadoras sin servidor
</div>

Sentry detecta automáticamente las funciones manejadoras sin servidor en el resultado de la compilación y las reexporta desde el archivo de entrada del servidor.

De forma predeterminada, Sentry reexporta funciones llamadas `handler`, `server` y la exportación `default`. Esto funcionará en la mayoría de los casos y no se requiere ninguna otra acción.
Si tu función sin servidor tiene un nombre personalizado, puedes reemplazarlo con `experimental_entrypointWrappedFunctions`:

```javascript {filename: app.config.ts} {11}

import { defineConfig } from '@solidjs/start/config';
import { withSentry } from '@sentry/solidstart';

export default defineConfig(withSentry(
    {},
    {
      autoInjectServerSentry: 'experimental_dynamic-import',
      // Personalizar los nombres de función detectados
      // Valor predeterminado: ['default', 'handler', 'server']
      experimental_entrypointWrappedFunctions: ['nombreDeFunciónPersonalizado']
    })
 );
```
