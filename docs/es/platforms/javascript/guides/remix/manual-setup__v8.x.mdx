---
title: Configuración manual
sidebar_order: 1
description: "Aprende a configurar el SDK manualmente."
noindex: true
---

Si no puedes (o prefieres no) usar la [configuración automática](/es/platforms/javascript/guides/remix/#install), sigue las instrucciones a continuación para configurar tu aplicación.

<div id="features">
  ## Funciones
</div>

Además de capturar errores, puedes supervisar las interacciones entre múltiples servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/). También puedes analizar perfiles de rendimiento de usuarios reales con [profiling](/es/product/explore/profiling/). Por último, agregar [session replay](/es/product/explore/session-replay/web/getting-started/) te permite llegar más rápido a la causa raíz de un error o problema de rendimiento al ver una reproducción tipo video de una sesión de usuario.

Selecciona qué funciones de Sentry quieres instalar además de Error Monitoring para obtener a continuación las instrucciones correspondientes de instalación y configuración.

<div id="install">
  ## Instalación
</div>

<OnboardingOptionButtons options={["error-monitoring", "performance", "profiling", "session-replay"]} />

Empieza instalando el SDK de Sentry para Remix:

```bash {tabTitle:npm}
npm install @sentry/remix --save
```

```bash {tabTitle:yarn}
yarn add @sentry/remix
```

```bash {tabTitle:pnpm}
pnpm add @sentry/remix
```

<div id="configure">
  ## Configurar
</div>

Para usar este SDK, inicializa Sentry en tu proyecto de Remix tanto en el cliente como en el servidor.

<div id="client-side-configuration">
  ### Configuración del cliente
</div>

```typescript {tabTitle:Client} {filename: entry.client.tsx}
import { useLocation, useMatches } from "@remix-run/react";
import * as Sentry from "@sentry/remix";
import { useEffect } from "react";

Sentry.init({
  dsn: "___PUBLIC_DSN___",
  integrations: [
    // ___PRODUCT_OPTION_START___ performance
    Sentry.browserTracingIntegration({
      useEffect,
      useLocation,
      useMatches,
    }),
    // ___PRODUCT_OPTION_END___ performance
    // ___PRODUCT_OPTION_START___ session-replay
    // Replay solo está disponible en el cliente
    Sentry.replayIntegration(),
    // ___PRODUCT_OPTION_END___ session-replay
  ],

  // ___PRODUCT_OPTION_START___ performance
  // Establece tracesSampleRate en 1.0 para capturar el 100%
  // de las transacciones para el rastreo.
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,

  // Establece `tracePropagationTargets` para controlar para qué URLs debe habilitarse el rastreo distribuido
  tracePropagationTargets: ["localhost", /^https:\/\/yourserver\.io\/api/],
  // ___PRODUCT_OPTION_END___ performance

  // ___PRODUCT_OPTION_START___ session-replay
  // Captura Replay para el 10% de todas las sesiones,
  // más el 100% de las sesiones con error
  // Más información en
  // https://docs.sentry.io/platforms/javascript/session-replay/configuration/#general-integration-configuration
  replaysSessionSampleRate: 0.1,
  replaysOnErrorSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ session-replay
});
```

<div id="remix-errorboundary">
  #### Remix ErrorBoundary
</div>

Para capturar errores de [ErrorBoundary](https://remix.run/docs/en/main/route/error-boundary), debes definir tu propio `ErrorBoundary` en `root.tsx` y usar `Sentry.captureRemixErrorBoundaryError` dentro de él. También puedes crear un comportamiento de captura de errores específico para cada ruta definiendo `ErrorBoundary` en los componentes de tus rutas. El `ErrorBoundary` que definas en `root.tsx` se usará como alternativa para todas las rutas.

```typescript {filename: root.tsx}
import { captureRemixErrorBoundaryError } from "@sentry/remix";

export const ErrorBoundary: V2_ErrorBoundaryComponent = () => {
  const error = useRouteError();

  captureRemixErrorBoundaryError(error);

  return <div> ... </div>;
};
```

Para capturar errores de componentes de React (en Remix v1) y transacciones de enrutamiento (en todas las versiones de Remix), envuelve la raíz de tu app de Remix con `withSentry`.

<Alert>
  Si usas Remix v1 con la bandera futura `v2_errorBoundary`, también debes configurar tu `ErrorBoundary`.
</Alert>

```typescript {filename: root.tsx}
import {
  Links,
  LiveReload,
  Meta,
  Outlet,
  Scripts,
  ScrollRestoration,
} from "@remix-run/react";

import { withSentry } from "@sentry/remix";

function App() {
  return (
    <html>
      <head>
        <Meta />
        <Links />
      </head>
      <body>
        <Outlet />
        <ScrollRestoration />
        <Scripts />
        <LiveReload />
      </body>
    </html>
  );
}

export default withSentry(App);
```

<Alert>
  Si usas Remix v2, `wrapWithErrorBoundary` está deshabilitado de forma predeterminada. Aun así, debes envolver tu componente raíz con `withSentry` para capturar las transacciones de enrutamiento.
</Alert>

Puedes deshabilitar o configurar `ErrorBoundary` usando un segundo parámetro en `withSentry`.

```typescript
withSentry(App, {
  wrapWithErrorBoundary: false,
});

// or

withSentry(App, {
  errorBoundaryOptions: {
    fallback: <p>Ocurrió un error</p>,
  },
});
```

<div id="server-side-configuration">
  ### Configuración del lado del servidor
</div>

Crea un archivo de instrumentación (aquí llamado `instrument.server.mjs`) en tu proyecto. Añade en este archivo tu código de inicialización para el SDK del lado del servidor.

```typescript {tabTitle:Server} {filename: instrument.server.mjs}
import * as Sentry from "@sentry/remix";

Sentry.init({
  dsn: "___PUBLIC_DSN___",
  // ___PRODUCT_OPTION_START___ performance
  // Establece tracesSampleRate en 1.0 para capturar el 100 %
  // de las transacciones para el seguimiento.
  // Recomendamos ajustar este valor en producción.
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance

  // Para usar la instrumentación automática de Sentry OpenTelemetry
  // valor predeterminado: false
  autoInstrumentRemix: true,

  // Opcional: capturar atributos formData de acciones con errores.
  // Esto también requiere que `sendDefaultPii` esté establecido en true.
  captureActionFormDataKeys: {
    key_x: true,
    key_y: true,
  },
  // Para capturar atributos formData de acciones.
  sendDefaultPii: true,
});
```

Luego, ejecuta tu servidor de Remix con:

```bash
NODE_OPTIONS='--import=./instrument.server.mjs' remix-serve build
# o
NODE_OPTIONS='--require=./instrument.server.cjs' remix-serve build
```

Si usas el servidor de Express en lugar del servidor integrado de Remix, puedes importar tu archivo de instrumentación directamente al inicio de la implementación de tu servidor. Consulta el ejemplo [aquí](#custom-express-server).

El SDK de Remix de Sentry registrará automáticamente tus transacciones de [`action`](https://remix.run/docs/en/main/route/action) y [`loader`](https://remix.run/docs/en/main/route/loader), así como los errores del lado del servidor. También puedes inicializar las integraciones de base de datos de Sentry, como <Link to="/platforms/javascript/guides/node/configuration/integrations/prisma/">Prisma</Link>, para obtener spans de tus llamadas a la base de datos.

<div id="server-side-errors">
  #### Errores del lado del servidor
</div>

Para capturar automáticamente los errores del lado del servidor, instrumenta la función [`handleError`](https://remix.run/docs/en/main/file-conventions/entry.server#handleerror) en el punto de entrada de tu servidor.

Si usas Sentry Remix SDK versión `7.87.0` o posterior, puedes envolver tu manejador de errores con `wrapHandleErrorWithSentry` o usar `sentryHandleError` para exportarlo como tu función `handleError`.

```typescript {filename: entry.server.tsx (@sentry/remix >= 7.87.0)}
import * as Sentry from "@sentry/remix";

export const handleError = Sentry.wrapHandleErrorWithSentry(
  (error, { request }) => {
    // Implementación personalizada de handleError
  }
);

// Alternativa: Usa la función de utilidad de Sentry si no necesitas envolver una función personalizada
export const handleError = Sentry.sentryHandleError;
```

Para versiones del SDK anteriores a `7.87.0`, puedes usar `Sentry.captureRemixServerException` para capturar errores dentro de `handleError`.

```typescript {filename: entry.server.tsx (@sentry/remix < 7.87.0)}
export function handleError(
  error: unknown,
  { request }: DataFunctionArgs
): void {
  if (error instanceof Error) {
    Sentry.captureRemixServerException(error, "remix.server", request);
  } else {
    // Opcionalmente capturar objetos que no son Error
    Sentry.captureException(error);
  }
}
```

<div id="source-maps-upload">
  ### Carga de source maps
</div>

Para habilitar rastreos de pila legibles, <PlatformLink to="/sourcemaps">configura la carga de source maps</PlatformLink> para tus builds de producción.

Una vez completada esta configuración, el SDK capturará automáticamente errores no gestionados y rechazos de promesas, y supervisará el rendimiento. También puedes [capturar errores manualmente](/es/platforms/javascript/guides/remix/usage).

<div id="verify">
  ## Verificación
</div>

Este fragmento incluye un error intencional para que puedas comprobar que todo funciona en cuanto lo configures.

<Alert>
  Los errores lanzados desde las DevTools del navegador se ejecutan en un entorno aislado, por lo que no activarán un manejador de errores. Coloca el fragmento directamente en tu código.
</Alert>

Luego, provoca un error en un `loader` o `action`.

```typescript {filename:routes/error.tsx}
export const action: ActionFunction = async ({ request }) => {
  throw new Error("Sentry Error");
};
```

<Alert>
  Obtén más información sobre cómo capturar manualmente un error o un mensaje en nuestra <PlatformLink to="/usage/">documentación de uso</PlatformLink>.
</Alert>

Para ver y resolver el error registrado, inicia sesión en [sentry.io](https://sentry.io) y selecciona tu proyecto. Al hacer clic en el título del error, se abrirá una página donde podrás ver información detallada y marcarlo como resuelto.

<Alert>
  Puedes consultar la documentación de [Remix](https://remix.run/docs/en/main/guides/envvars#browser-environment-variables) para aprender a usar tu DSN de Sentry con variables de entorno.
</Alert>

<div id="custom-express-server">
  ## Servidor de Express personalizado
</div>

Puedes importar el archivo de instrumentación de tu servidor al inicio de la implementación de tu servidor en Express.

```typescript {filename: server.ts}
// importa el archivo de instrumentación de Sentry antes que cualquier otra cosa.
import "./instrument.server.mjs";
// alternativamente `require('./instrument.server.cjs')`

// ...

const app = express();

// ...
```
