---
title: "Configuración manual"
sidebar_order: 1
description: "Aprende a configurar Sentry manualmente en tu app de Next.js y a capturar tus primeros errores."
---

<Alert type="info">
  Para una configuración más rápida, recomendamos usar el [asistente
  de instalación](/es/platforms/javascript/guides/nextjs).
</Alert>

<PlatformContent includePath="getting-started-prerequisites" />

<div id="step-1-install">
  ## Paso 1: Instalar
</div>

Elige las funciones que quieres configurar y esta guía te mostrará cómo:

<OnboardingOptionButtons
  options={[
  "error-monitoring",
  "performance",
  "session-replay",
  "user-feedback",
  "logs",
]}
/>

<PlatformContent includePath="getting-started-features-expandable" />

<div id="install-the-sentry-sdk">
  ### Instala el SDK de Sentry
</div>

Ejecuta el comando de tu gestor de paquetes preferido para añadir el SDK de Sentry a tu aplicación:

```bash {tabTitle:npm}
npm install @sentry/nextjs --save
```

```bash {tabTitle:yarn}
yarn add @sentry/nextjs
```

```bash {tabTitle:pnpm}
pnpm add @sentry/nextjs
```

<div id="step-2-configure">
  ## Paso 2: Configuración
</div>

<div id="apply-instrumentation-to-your-app">
  ### Aplica la instrumentación a tu app
</div>

Amplía las opciones predeterminadas de Next.js de tu app añadiendo `withSentryConfig` en tu archivo `next.config.(js|mjs)`:

```JavaScript {tabTitle:CJS} {filename:next.config.js}
const { withSentryConfig } = require("@sentry/nextjs");

const nextConfig = {
  // Tu configuración actual de Next.js
};

// Asegúrate de que agregar las opciones de Sentry sea lo último que se ejecute antes de exportar
module.exports = withSentryConfig(nextConfig, {
  org: "___ORG_SLUG___",
  project: "___PROJECT_SLUG___",

  // Solo muestra logs al subir los source maps en CI
  // Ponlo en `true` para silenciar los logs
  silent: !process.env.CI,

  // Elimina automáticamente (tree-shake) las llamadas del logger de Sentry para reducir el tamaño del bundle
  disableLogger: true,
});
```

```JavaScript {tabTitle:ESM} {filename:next.config.mjs}
import { withSentryConfig } from "@sentry/nextjs";

const nextConfig = {
  // Tu configuración actual de Next.js
};

// Asegúrate de que agregar las opciones de Sentry sea lo último antes de exportar
export default withSentryConfig(nextConfig, {
  org: "___ORG_SLUG___",
  project: "___PROJECT_SLUG___",

  // Solo mostrar logs al subir source maps en CI
  // Establece en `true` para suprimir logs
  silent: !process.env.CI,

  // Elimina automáticamente las declaraciones de logger de Sentry mediante tree-shaking para reducir el tamaño del bundle
  disableLogger: true,
});
```

<Include name="nextjs-app-router-14-config" />

<div id="initialize-sentry-client-side-and-server-side-sdks">
  ### Inicializa los SDK de Sentry en el cliente y en el servidor
</div>

Crea tres archivos en el directorio raíz de tu aplicación:

* `sentry.server.config.(js|ts)`
* `sentry.edge.config.(js|ts)`
* `instrumentation-client.(js|ts)`
  * Si antes tenías un archivo llamado `sentry.client.config.(js|ts)`, puedes cambiarle el nombre sin problema a `instrumentation-client.(js|ts)` en todas las versiones de Next.js.

Agrega el siguiente código de inicialización en cada archivo correspondiente:

<Alert level="info" title="Nota">
  Estos archivos se ejecutan en entornos distintos (navegador, servidor y edge) y son
  ligeramente diferentes, así que cópialos con cuidado.
</Alert>

```javascript {tabTitle:Client} {filename:instrumentation-client.(js|ts)}
import * as Sentry from "@sentry/nextjs";

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega encabezados de la solicitud y la IP de los usuarios; para más información, visita:
  // https://docs.sentry.io/platforms/javascript/guides/nextjs/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ performance

  // Establece tracesSampleRate en 1.0 para capturar el 100 %
  // de las transacciones para el seguimiento.
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
  integrations: [
    // ___PRODUCT_OPTION_START___ session-replay
    // Replay solo puede habilitarse en el lado del cliente
    Sentry.replayIntegration(),
    // ___PRODUCT_OPTION_END___ session-replay
    // ___PRODUCT_OPTION_START___ user-feedback
    Sentry.feedbackIntegration({
      // La configuración adicional del SDK va aquí; por ejemplo:
      colorScheme: "system",
    }),
    // ___PRODUCT_OPTION_END___ user-feedback
  ],
  // ___PRODUCT_OPTION_START___ session-replay

  // Captura Replay para el 10 % de todas las sesiones,
  // además del 100 % de las sesiones con un error
  // Más información en
  // https://docs.sentry.io/platforms/javascript/session-replay/configuration/#general-integration-configuration
  replaysSessionSampleRate: 0.1,
  replaysOnErrorSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ session-replay
  // ___PRODUCT_OPTION_START___ logs

  // Habilita el envío de logs a Sentry
  enableLogs: true,
  // ___PRODUCT_OPTION_END___ logs
  // Nota: si quieres sobrescribir el valor automático de release, no establezcas un valor
  // para `release` aquí; usa la variable de entorno `SENTRY_RELEASE`, de modo
  // que también se adjunte a tus mapas de código fuente
});

// Esta exportación instrumenta las navegaciones del enrutador y solo es relevante si habilitas el seguimiento.
// `captureRouterTransitionStart` está disponible a partir de la versión 9.12.0 del SDK
export const onRouterTransitionStart = Sentry.captureRouterTransitionStart;
```

```javascript {tabTitle:Server} {filename:sentry.server.config.(js|ts)}
import * as Sentry from "@sentry/nextjs";

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega encabezados de solicitud e IP para usuarios, para más información visita:
  // https://docs.sentry.io/platforms/javascript/guides/nextjs/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ performance

  // Establece tracesSampleRate en 1.0 para capturar el 100%
  // de las transacciones para el rastreo.
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
  // ___PRODUCT_OPTION_START___ logs

  // Habilita el envío de logs a Sentry
  enableLogs: true,
  // ___PRODUCT_OPTION_END___ logs

  // ...

  // Nota: si deseas sobrescribir el valor de release automático, no establezcas un
  // valor `release` aquí - usa la variable de entorno `SENTRY_RELEASE`, para
  // que también se adjunte a tus source maps
});
```

```javascript {tabTitle:Edge} {filename:sentry.edge.config.(js|ts)}
import * as Sentry from "@sentry/nextjs";

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega encabezados de solicitud e IP para usuarios, para más información visita:
  // https://docs.sentry.io/platforms/javascript/guides/nextjs/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ performance

  // Establece tracesSampleRate en 1.0 para capturar el 100%
  // de las transacciones para el rastreo.
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
  // ___PRODUCT_OPTION_START___ logs

  // Habilita el envío de logs a Sentry
  enableLogs: true,
  // ___PRODUCT_OPTION_END___ logs

  // ...

  // Nota: si deseas sobrescribir el valor de release automático, no establezcas un
  // valor `release` aquí - usa la variable de entorno `SENTRY_RELEASE`, para
  // que también se adjunte a tus source maps
});
```

<Alert title="Consejo">
  Incluye tu DSN directamente en estos archivos o usa una variable de entorno
  pública como `NEXT_PUBLIC_SENTRY_DSN`.
</Alert>

<div id="register-sentry-server-side-sdk-initialization">
  ### Registrar la inicialización del SDK de Sentry en el servidor
</div>

Crea un [archivo de instrumentación de Next.js](https://nextjs.org/docs/app/building-your-application/optimizing/instrumentation) llamado `instrumentation.(js|ts)` en la raíz del proyecto o dentro de la carpeta `src` si la tienes. Importa tus configuraciones para server y edge, asegurándote de que las rutas de importación apunten a tus archivos específicos:

```javascript {filename:instrumentation.(js|ts)}
export async function register() {
  if (process.env.NEXT_RUNTIME === "nodejs") {
    await import("./sentry.server.config");
  }

  if (process.env.NEXT_RUNTIME === "edge") {
    await import("./sentry.edge.config");
  }
}
```

<Expandable title="Excluir la incorporación del SDK de Sentry en el cliente o en el servidor">
  Si quieres que el SDK de Sentry esté disponible en el servidor y no en el
  cliente, simplemente elimina `instrumentation-client.(js|ts)`. Esto evitará
  que webpack incluya los archivos relacionados con Sentry al generar el paquete para el navegador.
  De forma similar, si quieres excluir la incorporación del SDK en el servidor, elimina
  los archivos `sentry.server.config.js` y `sentry.edge.config.js`. Asegúrate de
  quitar cualquier importación de esos archivos en `instrumentation.ts`.
</Expandable>

<div id="step-3-capture-react-render-errors">
  ## Paso 3: Capturar errores de renderizado de React
</div>

Para capturar errores de renderizado en React, debes agregar componentes de error para el App Router y el Pages Router.

<div id="app-router">
  ### App Router
</div>

Crea o actualiza el archivo `global-error.(tsx|jsx)` para definir un [componente GlobalError personalizado de Next.js](https://nextjs.org/docs/app/building-your-application/routing/error-handling):

```tsx {filename:global-error.tsx}
"use client";

import * as Sentry from "@sentry/nextjs";
import NextError from "next/error";
import { useEffect } from "react";

export default function GlobalError({
  error,
}: {
  error: Error & { digest?: string };
}) {
  useEffect(() => {
    Sentry.captureException(error);
  }, [error]);

  return (
    <html>
      <body>
        {/* `NextError` es el componente de página de error predeterminado de Next.js. Su definición de tipo
        requiere una prop `statusCode`. Sin embargo, como el App Router
        no expone códigos de estado para los errores, simplemente pasamos 0 para renderizar un
        mensaje de error genérico. */}
        <NextError statusCode={0} />
      </body>
    </html>
  );
}
```

```jsx {filename:global-error.jsx}
"use client";

import * as Sentry from "@sentry/nextjs";
import NextError from "next/error";
import { useEffect } from "react";

export default function GlobalError({ error }) {
  useEffect(() => {
    Sentry.captureException(error);
  }, [error]);

  return (
    <html>
      <body>
        {/* Este es el componente de error por defecto de Next.js. */}
        <NextError />
      </body>
    </html>
  );
}
```

<div id="errors-from-nested-react-server-components">
  #### Errores de componentes de servidor de React anidados
</div>

<Alert type="info">
  Requiere `@sentry/nextjs` versión `8.28.0` o posterior y Next.js 15.
</Alert>

Para capturar errores de componentes de servidor de React anidados, utiliza el hook [`onRequestError`](https://nextjs.org/docs/app/api-reference/file-conventions/instrumentation#onrequesterror-optional) en `instrumentation.(js|ts)` y pasa todos los argumentos a la función `captureRequestError`:

```TypeScript {filename:instrumentation.ts}
import * as Sentry from "@sentry/nextjs";

export const onRequestError = Sentry.captureRequestError;
```

```JavaScript {filename:instrumentation.js}
import * as Sentry from "@sentry/nextjs";

export const onRequestError = Sentry.captureRequestError;
```

<Expandable level="info" title="¿Necesitas lógica adicional dentro de `onRequestError`?">
  Puedes llamar a `captureRequestError` con todos los argumentos que recibe `onRequestError`:

  ```TypeScript {filename:instrumentation.ts}
  import * as Sentry from "@sentry/nextjs";
  import type { Instrumentation } from "next";

  export const onRequestError: Instrumentation.onRequestError = (...args) => {
      Sentry.captureRequestError(...args);

      // ... lógica adicional aquí
  };
  ```

  ```JavaScript {filename:instrumentation.js}
  import * as Sentry from "@sentry/nextjs";

  export const onRequestError = (...args) => {
      Sentry.captureRequestError(...args);

      // ... lógica adicional aquí
  };
  ```
</Expandable>

<div id="pages-router">
  ### Pages Router
</div>

Crea o actualiza el archivo `_error.(tsx|jsx)` para definir una [página de error personalizada de Next.js](https://nextjs.org/docs/pages/building-your-application/routing/custom-error) para el Pages Router, de la siguiente manera:

```tsx {filename:_error.tsx}
import * as Sentry from "@sentry/nextjs";
import type { NextPage } from "next";
import type { ErrorProps } from "next/error";
import Error from "next/error";

const CustomErrorComponent: NextPage<ErrorProps> = (props) => {
  return <Error statusCode={props.statusCode} />;
};

CustomErrorComponent.getInitialProps = async (contextData) => {
  // Si esto se ejecuta en una función serverless, espera esto para darle tiempo a Sentry
  // de enviar el error antes de que la lambda finalice
  await Sentry.captureUnderscoreErrorException(contextData);

  // Esto contendrá el código de estado de la respuesta
  return Error.getInitialProps(contextData);
};

export default CustomErrorComponent;
```

```jsx {filename:_error.jsx}
import * as Sentry from "@sentry/nextjs";
import type { NextPage } from "next";
import type { ErrorProps } from "next/error";
import Error from "next/error";

const CustomErrorComponent: NextPage<ErrorProps> = (props) => {
  return <Error statusCode={props.statusCode} />;
};

CustomErrorComponent.getInitialProps = async (contextData) => {
  // Si esto se ejecuta en una función serverless, espera a esto para darle tiempo a Sentry
  // de enviar el error antes de que la lambda termine
  await Sentry.captureUnderscoreErrorException(contextData);

  // Aquí estará el código de estado de la respuesta
  return Error.getInitialProps(contextData);
};

export default CustomErrorComponent;
```

<div id="step-4-add-readable-stack-traces-with-source-maps-optional">
  ## Paso 4: Agrega trazas legibles con mapas de origen (opcional)
</div>

Sentry puede proporcionar automáticamente trazas legibles de errores mediante mapas de origen; para ello se requiere un token de autenticación de Sentry.

Actualiza tu archivo `next.config.(js|mjs)` con las siguientes opciones:

```javascript {tabTitle:ESM} {filename:next.config.mjs}
export default withSentryConfig(nextConfig, {
  org: "___ORG_SLUG___",
  project: "___PROJECT_SLUG___",

  // Pasa el token de autenticación
  authToken: process.env.SENTRY_AUTH_TOKEN,
  // Sube un conjunto más amplio de mapas de origen para trazas de pila más claras (aumenta el tiempo de compilación)
  widenClientFileUpload: true,
});
```

```javascript {tabTitle:CJS} {filename:next.config.js}
module.exports = withSentryConfig(nextConfig, {
  org: "___ORG_SLUG___",
  project: "___PROJECT_SLUG___",

  // Pasa el token de autenticación
  authToken: process.env.SENTRY_AUTH_TOKEN,
  // Sube un conjunto más amplio de mapas de código fuente para obtener trazas de pila más legibles (incrementa el tiempo de compilación)
  widenClientFileUpload: true,
});
```

Configura la variable de entorno `SENTRY_AUTH_TOKEN` en tu archivo `.env`:

```sh {filename:.env}
SENTRY_AUTH_TOKEN=___ORG_AUTH_TOKEN___
```

<Alert level="warning" title="Importante">
  Asegúrate de mantener tu token de autenticación en secreto y fuera del control de versiones.
</Alert>

<div id="step-5-avoid-ad-blockers-with-tunneling-optional">
  ## Paso 5: Evita los bloqueadores de anuncios con tunneling (opcional)
</div>

Puedes impedir que los bloqueadores de anuncios filtren los eventos de Sentry usando tunneling. Usa la opción `tunnelRoute` para agregar un endpoint de API en tu aplicación que reenvíe los eventos de Sentry a los servidores de Sentry.

Para mejorar la evasión de bloqueadores de anuncios, puedes:

* Establecer `tunnelRoute: true` para generar automáticamente una ruta de túnel aleatoria en cada compilación, lo que dificulta que los bloqueadores detecten y bloqueen las solicitudes de monitoreo
* Establecer `tunnelRoute: "/my-tunnel-route"` para usar una ruta estática de tu elección

```javascript {tabTitle:ESM} {filename:next.config.mjs}
export default withSentryConfig(nextConfig, {
  // Redirige las solicitudes del navegador a Sentry mediante una reescritura de Next.js para evitar los bloqueadores de anuncios.
  // Esto puede aumentar la carga de tu servidor y tu factura de hosting.
  // Nota: Verifica que la ruta configurada no coincida con tu middleware de Next.js, de lo contrario fallará el reporte de errores del lado del cliente.
  tunnelRoute: true, // Genera una ruta aleatoria para cada build (recomendado)
});
```

```javascript {tabTitle:CJS} {filename:next.config.js}
module.exports = withSentryConfig(nextConfig, {
  // Redirige las solicitudes del navegador a Sentry mediante un rewrite de Next.js para evitar los bloqueadores de anuncios.
  // Esto puede aumentar la carga de tu servidor, así como tu factura de alojamiento.
  // Nota: Comprueba que la ruta configurada no coincida con tu middleware de Next.js; de lo contrario, fallará la notificación de errores del lado del cliente.
  tunnelRoute: true, // Genera una ruta aleatoria en cada compilación (recomendado)
});
```

<Expandable level="warning" title="Uso de middleware de Next.js con Turbopack">
  Si usas Turbopack, el registro de eventos en el cliente fallará si tu
  middleware de Next.js intercepta la ruta de túnel configurada. Para solucionarlo, establece
  la ruta en una cadena fija (por ejemplo, `/error-monitoring`) y añade un
  patrón negativo como `(?!error-monitoring)` en tu middleware para excluir la
  ruta del túnel. Si no usas Turbopack, Sentry omitirá automáticamente la
  ruta de túnel en tu middleware.
</Expandable>

<div id="step-6-instrument-vercel-cron-jobs-optional">
  ## Paso 6: Instrumentar los cron jobs de Vercel (opcional)
</div>

Puedes crear automáticamente [monitores de cron](/es/product/crons/) en Sentry si has configurado [cron jobs de Vercel](https://vercel.com/docs/cron-jobs).

Actualiza `withSentryConfig` en tu archivo `next.config.(js|mjs)` con la siguiente opción:

```javascript {tabTitle:ESM} {filename:next.config.mjs}
export default withSentryConfig(nextConfig, {
  automaticVercelMonitors: true,
});
```

```javascript {tabTitle:CJS} {filename:next.config.js}
module.exports = withSentryConfig(nextConfig, {
  automaticVercelMonitors: true,
});
```

<Alert>
  La instrumentación automática de cron jobs de Vercel actualmente solo es compatible con el Pages Router. Los manejadores de rutas del App Router aún no son compatibles.
</Alert>

<div id="step-7-capture-react-component-names-optional">
  ## Paso 7: Capturar nombres de componentes de React (opcional)
</div>

Puedes capturar los nombres de componentes de React para ver en qué componente hizo clic un usuario en funciones de Sentry como Session Replay.
Actualiza `withSentryConfig` en tu archivo `next.config.(js|mjs)` con la opción siguiente:

```javascript {tabTitle:ESM} {filename:next.config.mjs}
export default withSentryConfig(nextConfig, {
  reactComponentAnnotation: {
    enabled: true,
  },
});
```

```javascript {tabTitle:CJS} {filename:next.config.js}
module.exports = withSentryConfig(nextConfig, {
  reactComponentAnnotation: {
    enabled: true,
  },
});
```

<div id="step-8-verify">
  ## Paso 8: Verificar
</div>

<Include name="nextjs-turbopack-warning-expandable.mdx" />

Probemos tu configuración y confirmemos que Sentry funciona correctamente y envía datos a tu proyecto en Sentry.

<div id="issues">
  ### Issues
</div>

Para verificar que Sentry capture errores y cree issues en tu proyecto de Sentry, agrega un botón de prueba a una página existente o crea una nueva:

```jsx
<button
  type="button"
  onClick={() => {
    throw new Error("Error de prueba de Sentry");
  }}
>
  Romper el mundo
</button>
```

<OnboardingOption optionId="performance" hideForThisOption>
  Abre la página en un navegador (en la mayoría de aplicaciones Next.js será
  localhost) y haz clic en el botón para provocar un error en el frontend.
</OnboardingOption>

<PlatformContent includePath="getting-started-browser-sandbox-warning" />

<OnboardingOption optionId="performance">
  ### Trazas

  Para probar las trazas, crea una ruta de API de prueba como `/api/sentry-example-api`:

  ```javascript
  import { NextResponse } from "next/server";
  export const dynamic = "force-dynamic";

  // Ruta de API defectuosa para probar la monitorización de errores de Sentry
  export function GET() {
    throw new Error("Sentry Example API Route Error");
    return NextResponse.json({ data: "Testing Sentry Error..." });
  }
  ```

  Luego, actualiza tu botón de prueba para llamar a esta ruta y lanzar un error si la respuesta no es `ok`:

  ```jsx
  <button
    type="button"
    onClick={async () => {
  	await Sentry.startSpan({
  	  name: 'Example Frontend Span',
  	  op: 'test'
  	}, async () => {
  	  const res = await fetch("/api/sentry-example-api");
  	  if (!res.ok) {
  		throw new Error("Sentry Example Frontend Error");
  	  }
  	});
    }
    >
    Break the world
  </button>;
  ```

  Abre la página en un navegador (en la mayoría de aplicaciones Next.js será en localhost) y haz clic en el botón para provocar dos errores:

  * un error en el frontend
  * un error en la ruta de la API

  Además, esto inicia una traza de rendimiento para medir el tiempo que tarda en completarse la solicitud a la API.
</OnboardingOption>

<div id="view-captured-data-in-sentry">
  ### Ver los datos capturados en Sentry
</div>

Ahora, ve a tu proyecto en [Sentry.io](https://sentry.io) para ver los datos recopilados (puede tardar unos momentos en aparecer).

<PlatformContent includePath="getting-started-verify-locate-data" />

<div id="next-steps">
  ## Próximos pasos
</div>

A estas alturas, deberías haber integrado Sentry en tu aplicación de Next.js y ya estar enviando datos a tu proyecto de Sentry.

Ahora es un buen momento para personalizar tu configuración y explorar temas más avanzados.
Te recomendamos seguir estos pasos:

* Aprende sobre [la instrumentación de las server actions de Next.js](/es/platforms/javascript/guides/nextjs/apis/#server-actions)
* Configura la [autoinstrumentación del lado del servidor](/es/platforms/javascript/guides/nextjs/configuration/build/#nextjs-specific-options)
* Aprende a [capturar errores manualmente](/es/platforms/javascript/guides/nextjs/usage/)
* Sigue [personalizando tu configuración](/es/platforms/javascript/guides/nextjs/configuration/)
* Conoce más sobre nuestra [integración con Vercel](/es/organization/integrations/deployment/vercel/)

<Expandable permalink={false} title="¿Tienes problemas para configurar el SDK?">
  - Si tuviste problemas al configurar Sentry manualmente, [prueba nuestro asistente de instalación](/es/platforms/javascript/guides/nextjs/)
  - [Obtén ayuda](https://sentry.zendesk.com/hc/en-us/)
</Expandable>