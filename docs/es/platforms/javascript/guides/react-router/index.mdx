---
title: Framework de React Router
description: Aprende a configurar y ajustar Sentry en tu aplicación de React Router v7, capturar tus primeros errores y verlos en Sentry.
sdk: sentry.javascript.react-router
categories:
  - javascript
  - browser
  - server
  - server-node
---

<Alert level="warning" title="Importante">
  Este SDK está actualmente en **beta**. Las funciones beta aún están en desarrollo y pueden
  tener errores. Ponte en contacto en
  [GitHub](https://github.com/getsentry/sentry-javascript/issues/new/choose) si
  tienes comentarios o inquietudes.
</Alert>

<Alert title="¿Usas el modo biblioteca?" level="info">
  Si usas React Router en modo biblioteca, sigue las instrucciones de nuestra [guía de React](/es/platforms/javascript/guides/react/features/react-router/v7).
</Alert>

<PlatformContent includePath="getting-started-prerequisites" />

<div id="step-1-install">
  ## Paso 1: Instalar
</div>

Elige las funciones que quieres configurar y esta guía te mostrará cómo hacerlo:

<OnboardingOptionButtons
  options={[
  "error-monitoring",
  "performance",
  "session-replay",
  "user-feedback",
  "logs",
  {
    id: "profiling",
    checked: false,
  },
]}
/>

<PlatformContent includePath="getting-started-features-expandable" />

<div id="install-the-sentry-sdk">
  ### Instala el SDK de Sentry
</div>

Ejecuta el comando del gestor de paquetes que prefieras para añadir el paquete del SDK a tu aplicación:

<OnboardingOption optionId="profiling">
  ```bash {tabTitle:npm}
  npm install @sentry/react-router @sentry/profiling-node
  ```

  ```bash {tabTitle:yarn}
  yarn add @sentry/react-router @sentry/profiling-node
  ```

  ```bash {tabTitle:pnpm}
  pnpm add @sentry/react-router @sentry/profiling-node
  ```
</OnboardingOption>

<OnboardingOption optionId="profiling" hideForThisOption>
  ```bash {tabTitle:npm}
  npm install @sentry/react-router
  ```

  ```bash {tabTitle:yarn}
  yarn add @sentry/react-router
  ```

  ```bash {tabTitle:pnpm}
  pnpm add @sentry/react-router
  ```
</OnboardingOption>

<div id="step-2-configure">
  ## Paso 2: Configuración
</div>

<div id="expose-entry-point-files">
  ### Exponer archivos de punto de entrada
</div>

Antes de configurar Sentry, debes hacer visibles en tu proyecto los archivos de punto de entrada de React Router (`entry.client.tsx` y `entry.server.tsx`). Ejecuta este comando para exponerlos:

```bash
npx react-router reveal
```

<div id="configure-client-side-sentry">
  ### Configurar Sentry en el lado del cliente
</div>

Inicializa Sentry en tu archivo `entry.client.tsx`:

```tsx {diff} {filename: entry.client.tsx}
+import * as Sentry from "@sentry/react-router";
 import { startTransition, StrictMode } from "react";
 import { hydrateRoot } from "react-dom/client";
 import { HydratedRouter } from "react-router/dom";

+Sentry.init({
+  dsn: "___PUBLIC_DSN___",
+
+  // Agrega encabezados de la solicitud e IP de los usuarios; para más información, visita:
+  // https://docs.sentry.io/platforms/javascript/guides/react-router/configuration/options/#sendDefaultPii
+  sendDefaultPii: true,
+
+  integrations: [
+    // ___PRODUCT_OPTION_START___ performance
+    // Registra y configura la integración de Tracing,
+    // que instrumenta automáticamente tu aplicación para supervisar su
+    // rendimiento, incluida la instrumentación personalizada del enrutamiento de Angular
+    Sentry.reactRouterTracingIntegration(),
+    // ___PRODUCT_OPTION_END___ performance
+    // ___PRODUCT_OPTION_START___ session-replay
+    // Registra la integración de Replay,
+    // que captura automáticamente reproducciones de sesión
+    Sentry.replayIntegration(),
+    // ___PRODUCT_OPTION_END___ session-replay
+    // ___PRODUCT_OPTION_START___ user-feedback
+    Sentry.feedbackIntegration({
+      // La configuración adicional del SDK va aquí; por ejemplo:
+      colorScheme: "system",
+    }),
+    // ___PRODUCT_OPTION_END___ user-feedback
+  ],
+  // ___PRODUCT_OPTION_START___ logs
+
+  // Habilita el envío de logs a Sentry
+  enableLogs: true,
+  // ___PRODUCT_OPTION_END___ logs
+  // ___PRODUCT_OPTION_START___ performance
+
+  // Establece tracesSampleRate en 1.0 para capturar el 100%
+  // de las transacciones para tracing.
+  // Recomendamos ajustar este valor en producción
+  // Más información en
+  // https://docs.sentry.io/platforms/javascript/guides/react-router/configuration/options/#traces-sample-rate
+  tracesSampleRate: 1.0, // Captura el 100% de las transacciones
+
+  // Establece `tracePropagationTargets` para indicar qué URL(s) deben tener habilitada la propagación de trazas
+  tracePropagationTargets: [/^\//, /^https:\/\/yourserver\.io\/api/],
+  // ___PRODUCT_OPTION_END___ performance
+  // ___PRODUCT_OPTION_START___ session-replay
+
+  // Captura Replay para el 10% de todas las sesiones,
+  // además del 100% de las sesiones con un error
+  // Más información en
+  // https://docs.sentry.io/platforms/javascript/guides/react-router/session-replay/configuration/#general-integration-configuration
+  replaysSessionSampleRate: 0.1,
+  replaysOnErrorSampleRate: 1.0,
+  // ___PRODUCT_OPTION_END___ session-replay
+});

startTransition(() => {
  hydrateRoot(
    document,
    <StrictMode>
      <HydratedRouter />
    </StrictMode>
  );
});
```

<div id="report-errors-from-error-boundaries">
  #### Informar errores desde límites de error
</div>

Actualiza tu `app/root.tsx` para capturar los errores no controlados en tu límite de error:

```tsx {diff} {filename: app/root.tsx}
+import * as Sentry from "@sentry/react-router";

export function ErrorBoundary({ error }: Route.ErrorBoundaryProps) {
  let message = "¡Ups!";
  let details = "Ocurrió un error inesperado.";
  let stack: string | undefined;

  if (isRouteErrorResponse(error)) {
    message = error.status === 404 ? "404" : "Error";
    details =
      error.status === 404
        ? "No se encontró la página solicitada."
        : error.statusText || details;
  } else if (error && error instanceof Error) {
    // solo quieres capturar errores que no sean 404 y que lleguen al límite de error
+   Sentry.captureException(error);
    if (import.meta.env.DEV) {
      details = error.message;
      stack = error.stack;
    }
  }

  return (
    <main>
      <h1>{message}</h1>
      <p>{details}</p>
      {stack && (
        <pre>
          <code>{stack}</code>
        </pre>
      )}
    </main>
  );
}
// ...
```

<div id="configure-server-side-sentry">
  ### Configurar Sentry en el servidor
</div>

<Expandable level="warning" title="Compatibilidad limitada de Node con la autoinstrumentación" permalink>
  La autoinstrumentación del lado del servidor actualmente solo es compatible con:

  * **Node 20:** Versión &lt;20.19
  * **Node 22:** Versión &lt;22.12

  Si usas una versión diferente, utiliza nuestros envoltorios manuales para el servidor.

  Para los loaders del servidor, usa `wrapServerLoader`:

  ```ts
  import * as Sentry from "@sentry/react-router";

  export const loader = Sentry.wrapServerLoader(
    {
      name: "Load Some Data",
      description: "Loads some data from the db",
    },
    async ({ params }) => {
      // ... your loader logic
    }
  );
  ```

  Para las acciones del servidor, usa `wrapServerAction`:

  ```ts
  import * as Sentry from "@sentry/react-router";

  export const action = Sentry.wrapServerAction(
    {
      name: "Submit Form Data",
      description: "Processes form submission data",
    },
    async ({ request }) => {
      // ... your action logic
    }
  );
  ```
</Expandable>

Primero, crea un archivo llamado `instrument.server.mjs` en la raíz de tu proyecto para inicializar Sentry:

```js {filename: instrument.server.mjs}
import * as Sentry from "@sentry/react-router";
// ___PRODUCT_OPTION_START___ profiling
import { nodeProfilingIntegration } from "@sentry/profiling-node";
// ___PRODUCT_OPTION_END___ profiling

Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Agrega encabezados de la solicitud y la IP de los usuarios. Para obtener más información, visita:
  // https://docs.sentry.io/platforms/javascript/guides/react-router/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ logs

  // Habilita el envío de logs a Sentry
  enableLogs: true,
  // ___PRODUCT_OPTION_END___ logs
  // ___PRODUCT_OPTION_START___ profiling

  // Agrega nuestra integración de perfiles (Profiling)
  integrations: [nodeProfilingIntegration()],
  // ___PRODUCT_OPTION_END___ profiling
  // ___PRODUCT_OPTION_START___ performance
  // Establece tracesSampleRate en 1.0 para capturar el 100%
  // de las transacciones para el tracing.
  // Recomendamos ajustar este valor en producción
  // Más información en
  // https://docs.sentry.io/platforms/javascript/guides/react-router/configuration/options/#tracesSampleRate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
  // ___PRODUCT_OPTION_START___ profiling
  // Establece profilesSampleRate en 1.0 para perfilar el 100%
  // de las transacciones muestreadas.
  // Esto es relativo a tracesSampleRate
  // Más información en
  // https://docs.sentry.io/platforms/javascript/guides/react-router/configuration/options/#profilesSampleRate
  profilesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ profiling
});
```

A continuación, reemplaza las funciones predeterminadas `handleRequest` y `handleError` en tu archivo `entry.server.tsx` por las versiones encapsuladas de Sentry:

```tsx {diff} {filename: entry.server.tsx}
+import * as Sentry from '@sentry/react-router';
 import { createReadableStreamFromReadable } from '@react-router/node';
 import { renderToPipeableStream } from 'react-dom/server';
 import { ServerRouter } from 'react-router';
 import { type HandleErrorFunction } from 'react-router';

+const handleRequest = Sentry.createSentryHandleRequest({
+  ServerRouter,
+  renderToPipeableStream,
+  createReadableStreamFromReadable,
+});

 export default handleRequest;

+export const handleError = Sentry.createSentryHandleError({
+  logErrors: false
+});

// ... resto de tu archivo de entrada del servidor
```

<Expandable title="¿Necesitas personalizar tu función handleRequest?">
  Si necesitas personalizar la lógica de tu función `handleRequest`, tendrás que usar manualmente las funciones auxiliares de Sentry (`getMetaTagTransformer` y `wrapSentryHandleRequest`):

  ```tsx {1-4, 44-45, 69-70}
  import {
    getMetaTagTransformer,
    wrapSentryHandleRequest,
  } from "@sentry/react-router";
  // ... other imports

  const handleRequest = function handleRequest(
    request: Request,
    responseStatusCode: number,
    responseHeaders: Headers,
    routerContext: EntryContext,
    _loadContext: AppLoadContext
  ): Promise<Response> {
    return new Promise((resolve, reject) => {
      let shellRendered = false;
      const userAgent = request.headers.get("user-agent");

      // Determine if we should use onAllReady or onShellReady
      const isBot = typeof userAgent === "string" && botRegex.test(userAgent);
      const isSpaMode = !!(routerContext as { isSpaMode?: boolean }).isSpaMode;

      const readyOption = isBot || isSpaMode ? "onAllReady" : "onShellReady";

      const { pipe, abort } = renderToPipeableStream(
        <ServerRouter context={routerContext} url={request.url} />,
        {
          [readyOption]() {
            shellRendered = true;
            const body = new PassThrough();

            const stream = createReadableStreamFromReadable(body);

            responseHeaders.set("Content-Type", "text/html");

            resolve(
              new Response(stream, {
                headers: responseHeaders,
                status: responseStatusCode,
              })
            );

            // esto habilita el trazado distribuido entre el cliente y el servidor
            pipe(getMetaTagTransformer(body));
          },
          onShellError(error: unknown) {
            reject(error);
          },
          onError(error: unknown) {
            // eslint-disable-next-line no-param-reassign
            responseStatusCode = 500;
            // Registra errores de renderizado por streaming desde dentro del shell. No registres
            // los errores encontrados durante el renderizado inicial del shell, ya que se
            // rechazarán y se registrarán en handleDocumentRequest.
            if (shellRendered) {
              // eslint-disable-next-line no-console
              console.error(error);
            }
          },
        }
      );

      // Anula el stream de renderizado después de `streamTimeout`
      setTimeout(abort, streamTimeout);
    });
  };

  // envuelve la exportación predeterminada
  export default wrapSentryHandleRequest(handleRequest);

  // ... resto de tu archivo entry.server.ts
  ```
</Expandable>

<Expandable title="¿Necesitas personalizar tu función handleError?">
  Si tienes lógica personalizada en tu función `handleError`, tendrás que capturar los errores manualmente:

  ```tsx {12}
  import {
    getMetaTagTransformer,
    wrapSentryHandleRequest,
  } from "@sentry/react-router";
  // ... other imports

  export function handleError(
    error: unknown,
    { request, params, context }: LoaderFunctionArgs | ActionFunctionArgs
  ) {
    if (!request.signal.aborted) {
      Sentry.captureException(error);
      console.error(formatErrorForJsonLogging(error));
    }
  }

  // ... resto de tu archivo entry.server.ts
  ```
</Expandable>

<div id="load-instrumentation-on-startup">
  #### Cargar la instrumentación al inicio
</div>

React Router se ejecuta en modo ESM, por lo que debes cargar el archivo de instrumentación de Sentry antes de que la aplicación se inicie. Actualiza los scripts de tu `package.json`:

```json {filename: package.json}
"scripts": {
  "dev": "NODE_OPTIONS='--import ./instrument.server.mjs' react-router dev",
  "start": "NODE_OPTIONS='--import ./instrument.server.mjs' react-router-serve ./build/server/index.js",
}
```

<PlatformContent includePath="node-options-windows" />

**Despliegue en Vercel, Netlify y plataformas similares**

Si estás desplegando en plataformas donde no puedes configurar la variable `NODE_OPTIONS`, importa directamente el archivo de instrumentación al inicio de tu `entry.server.tsx`:

```tsx {diff} {filename: entry.server.tsx}
+import './instrument.server';
 import * as Sentry from '@sentry/react-router';
 import { createReadableStreamFromReadable } from '@react-router/node';
 import { renderToPipeableStream } from 'react-dom/server';
 // ... rest of your imports
```

<Alert title="Auto-instrumentación incompleta" level="warning">
  Si importas el archivo de instrumentación directamente en lugar de usar la opción `--import`, la instrumentación automática quedará incompleta. Perderás spans y trazas capturados automáticamente para algunas operaciones del lado del servidor. Usa este enfoque solo cuando el método `NODE_OPTIONS` no esté disponible.
</Alert>

<div id="step-3-add-readable-stack-traces-with-source-maps-optional">
  ## Paso 3: Agrega trazas legibles con mapas de origen (opcional)
</div>

Las trazas en tus errores de Sentry probablemente no se verán como tu código real a menos que las desminifiques. Para solucionarlo, sube tus mapas de origen a Sentry.

Primero, actualiza `vite.config.ts` para incluir el plugin `sentryReactRouter`, asegurándote de pasarle tanto la configuración de Vite como la de Sentry:

```typescript {filename: vite.config.ts} {diff}
import { reactRouter } from '@react-router/dev/vite';
import { sentryReactRouter, type SentryReactRouterBuildOptions } from '@sentry/react-router';
import { defineConfig } from 'vite';

const sentryConfig: SentryReactRouterBuildOptions = {
  org: "___ORG_SLUG___",
  project: "___PROJECT_SLUG___",

  // Se necesita un token de autenticación para cargar mapas de origen;
  // guárdalo en una variable de entorno para mantenerlo seguro.
  authToken: process.env.SENTRY_AUTH_TOKEN,
  // ...
};

export default defineConfig(config => {
  return {
+   plugins: [reactRouter(),sentryReactRouter(sentryConfig, config)],
  };
});
```

Para mantener tu token de autenticación seguro, guárdalo siempre en una variable de entorno en lugar de directamente en tus archivos:

<OrgAuthTokenNote />

```bash {filename:.env}
SENTRY_AUTH_TOKEN=___ORG_AUTH_TOKEN___
```

A continuación, incluye el hook `sentryOnBuildEnd` en `react-router.config.ts`:

```typescript {filename: react-router.config.ts} {diff}
import type { Config } from "@react-router/dev/config";
import { sentryOnBuildEnd } from "@sentry/react-router";

export default {
  ssr: true,
  buildEnd: async ({ viteConfig, reactRouterConfig, buildManifest }) => {
    // ...
    // Llama a esto al final del hook
    +(await sentryOnBuildEnd({ viteConfig, reactRouterConfig, buildManifest }));
  },
} satisfies Config;
```

<div id="step-4-avoid-ad-blockers-with-tunneling-optional">
  ## Paso 4: Evita los bloqueadores de anuncios con tunneling (opcional)
</div>

<PlatformContent includePath="getting-started-tunneling" />

<div id="step-5-verify-your-setup">
  ## Paso 5: Verifica tu configuración
</div>

Probemos tu configuración y confirmemos que Sentry funciona correctamente y está enviando datos a tu proyecto en Sentry.

<div id="issues">
  ### Incidencias
</div>

Para comprobar que Sentry captura errores y crea incidencias en tu proyecto de Sentry, provoca un error en un loader:

```tsx {filename: error.tsx}
import type { Route } from "./+types/example-page";

export async function loader() {
  throw new Error("¡Mi primer error en Sentry!");
}

export default function ExamplePage() {
  return <div>Al cargar esta página se producirá un error</div>;
}
```

<OnboardingOption optionId="performance" hideForThisOption>
  Abre la ruta en tu navegador y deberías provocar un error.
</OnboardingOption>

<PlatformContent includePath="getting-started-browser-sandbox-warning" />

<OnboardingOption optionId="performance">
  ### Trazas

  Para probar tu configuración de trazas, actualiza el fragmento de código anterior iniciando una traza para medir el tiempo que tarda en ejecutarse tu código:

  ```tsx {filename: error.tsx}
  import * as Sentry from "@sentry/react-router";
  import type { Route } from "./+types/example-page";

  export async function loader() {
    return Sentry.startSpan(
      {
        op: "test",
        name: "My First Test Transaction",
      },
      () => {
        throw new Error("My first Sentry error!");
      }
    );
  }

  export default function ExamplePage() {
    return <div>Loading this page will throw an error</div>;
  }
  ```

  Abre la ruta en tu navegador. Deberías iniciar una traza y provocar un error.
</OnboardingOption>

<div id="view-captured-data-in-sentry">
  ### Ver los datos capturados en Sentry
</div>

Ahora, dirígete a tu proyecto en [Sentry.io](https://sentry.io) para ver los datos recopilados (puede tardar unos momentos en aparecer).

<PlatformContent includePath="getting-started-verify-locate-data" />

<div id="next-steps">
  ## Próximos pasos
</div>

A estas alturas, deberías haber integrado Sentry en tu aplicación con React Router Framework y ya estar enviando datos a tu proyecto de Sentry.

Este es un buen momento para personalizar tu configuración y explorar temas más avanzados.
Te recomendamos seguir con:

* Aprende a <PlatformLink to="/usage">capturar errores manualmente</PlatformLink>
* Sigue <PlatformLink to="/configuration">personalizando tu configuración</PlatformLink>
* Familiarízate con [las funcionalidades del producto de Sentry](/es/product/) como tracing, insights y alertas

<Expandable permalink={false} title="¿Tienes problemas para configurar el SDK?">
  - Encuentra distintos temas en <PlatformLink to="/troubleshooting">Solución de problemas</PlatformLink>
  - [Obtén soporte](https://sentry.zendesk.com/hc/en-us/)
</Expandable>