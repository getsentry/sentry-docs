---
title: Uso de las API de OpenTelemetry
description: "Aprende a usar las API de OpenTelemetry con Sentry."
supported:
  - javascript.nextjs
  - javascript.node
  - javascript.aws-lambda
  - javascript.azure-functions
  - javascript.bun
  - javascript.connect
  - javascript.express
  - javascript.fastify
  - javascript.gcp-functions
  - javascript.hapi
  - javascript.hono
  - javascript.koa
  - javascript.nestjs
  - javascript.nuxt
  - javascript.solidstart
  - javascript.sveltekit
  - javascript.astro
  - javascript.remix
  - javascript.react-router
  - javascript.tanstackstart-react
notSupported:
  - javascript
sidebar_order: 1
---

Sentry es compatible con las API de OpenTelemetry de forma nativa. Cualquier span iniciado con las API de OpenTelemetry se capturará automáticamente en Sentry, y cualquier span iniciado con el SDK de Sentry se propagará automáticamente a OpenTelemetry.

<div id="adding-additional-opentelemetry-instrumentation">
  ## Agregar instrumentación adicional de OpenTelemetry
</div>

Aunque el SDK de Sentry incluye algo de instrumentación de OpenTelemetry lista para usar, quizá quieras añadir más instrumentación a tu aplicación. Puedes hacerlo registrando la instrumentación mediante OpenTelemetry, como en el siguiente ejemplo:

```javascript {tabTitle: ESM} {12-13}
import * as Sentry from "@sentry/node";
import {
  GenericPoolInstrumentation,
} from "@opentelemetry/instrumentation-generic-pool";

Sentry.init({
  dsn: "___DSN___",

  // SentrySampler usará esto para decidir qué trazas muestrear
  tracesSampleRate: 1.0,

  // Agrega instrumentaciones adicionales de OpenTelemetry:
  openTelemetryInstrumentations: [new GenericPoolInstrumentation()],
});
```

```javascript {tabTitle: CJS} {12-13}
const Sentry = require("@sentry/node");
const {
  GenericPoolInstrumentation,
} = require("@opentelemetry/instrumentation-generic-pool");

Sentry.init({
  dsn: "___DSN___",

  // SentrySampler utilizará esto para determinar qué trazas muestrear
  tracesSampleRate: 1.0,

  // Agrega instrumentación adicional de OpenTelemetry:
  openTelemetryInstrumentations: [new GenericPoolInstrumentation()],
});
```

<Alert>
  Es posible añadir instrumentaciones mediante `registerInstrumentations()` de
  `@opentelemetry/instrumentation`. Sin embargo, con ESM (sintaxis `import`/`export`)
  debes asegurarte de hacerlo antes de importar cualquier módulo que deba
  instrumentarse.

  Como regla general, `registerInstrumentations()` debe llamarse justo después y en el mismo contexto que el registro de los <PlatformLink to="/opentelemetry/custom-setup/#esm-loaders">cargadores ESM</PlatformLink>.
</Alert>


<div id="using-an-opentelemetry-tracer">
  ## Uso de un tracer de OpenTelemetry
</div>

Recomendamos usar `Sentry.startSpan()` y las APIs relacionadas para crear spans, pero también puedes crearlos con las APIs nativas de OpenTelemetry.

Puedes acceder al tracer que usa Sentry mediante `client.tracer` y luego crear spans con las APIs de OpenTelemetry, como se muestra a continuación:

```javascript {tabTitle: ESM}
import * as Sentry from "@sentry/node";

const tracer = Sentry.getClient()?.tracer;
// Ahora puedes usar las API nativas en el tracer:
tracer.startActiveSpan("span name", () => {
  // medir algo
});
```

```javascript {tabTitle: CJS}
const Sentry = require("@sentry/node");

const tracer = Sentry.getClient()?.tracer;
// Ahora puedes usar las API nativas del tracer:
tracer.startActiveSpan("nombre del span", () => {
  // medir algo
});
```

También puedes usar cualquier otro tracer. Sentry capturará automáticamente todos los spans de OpenTelemetry.


<div id="modifying-the-default-opentelemetry-tracerprovider">
  ## Modificar el TracerProvider predeterminado de OpenTelemetry
</div>

Puedes acceder al proveedor de trazas que Sentry configura cuando usas la instrumentación predeterminada de OpenTelemetry de Sentry.

```javascript {tabTitle: ESM}
import * as Sentry from "@sentry/node";

const provider = Sentry.getClient()?.traceProvider;
```

```javascript {tabTitle: CJS}
const Sentry = require("@sentry/node");

const provider = Sentry.getClient()?.traceProvider;
```


<div id="adding-additional-span-processors">
  ## Agregar procesadores de spans adicionales
</div>

Puedes agregar procesadores de spans adicionales al proveedor de trazas configurado por Sentry cuando uses la instrumentación predeterminada de OpenTelemetry de Sentry.

```javascript {tabTitle: ESM}
import * as Sentry from "@sentry/node";

Sentry.init({
  dsn: "___DSN___",

  // SentrySampler usará esto para determinar qué trazas muestrear
  tracesSampleRate: 1.0,

  // Agrega procesadores de spans de OpenTelemetry adicionales:
  openTelemetrySpanProcessors: [new MySpanProcessor()],
});
```

```javascript {tabTitle: CJS}
const Sentry = require("@sentry/node");

Sentry.init({
  dsn: "___DSN___",

  // SentrySampler utilizará esto para determinar qué trazas muestrear
  tracesSampleRate: 1.0,

  // Agrega procesadores de spans adicionales de OpenTelemetry:
  openTelemetrySpanProcessors: [new MySpanProcessor()],
});
```
