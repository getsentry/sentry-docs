---
title: Configuración
sidebar_order: 4100
notSupported:
  - javascript.cordova
  - javascript.wasm
  - javascript.bun
  - javascript.deno
  - javascript.node
  - javascript.aws-lambda
  - javascript.azure-functions
  - javascript.connect
  - javascript.express
  - javascript.fastify
  - javascript.gcp-functions
  - javascript.hapi
  - javascript.hono
  - javascript.koa
  - javascript.nestjs
  - javascript.cloudflare
description: Conoce los campos generales de configuración de Session Replay.
og_image: /og-images/platforms-javascript-common-session-replay-configuration.png
---

<Include name="session-replay-web-report-bug.mdx" />

<div id="general-integration-configuration">
  ## Configuración general de la integración
</div>

Las siguientes opciones se pueden configurar en el nivel raíz de tu SDK de Sentry para navegador, en `init({})`:

| Key                      | Type     | Default | Description                                                                                                                                                                                                                                                       |
| ------------------------ | -------- | ------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| replaysSessionSampleRate | `number` | `0`     | La tasa de muestreo para las reproducciones que comienzan a grabar de inmediato y duran toda la sesión del usuario. `1.0` recopila todas las reproducciones y `0` no recopila ninguna.                                                                         |
| replaysOnErrorSampleRate | `number` | `0`     | La tasa de muestreo para las reproducciones que se graban cuando ocurre un error. Este tipo de reproducción registrará hasta un minuto de eventos previos al error y continuará grabando hasta que la sesión termine. `1.0` captura todas las sesiones con un error y `0` no captura ninguna. |

Lo siguiente se puede configurar como opciones de integración en `replayIntegration({})`:

| Key                      | Type                                | Default     | Description                                                                                                                                                                  |
| ------------------------ | ----------------------------------- | ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| stickySession            | `boolean`                           | `true`      | Realiza el seguimiento de un usuario independientemente de que se actualice la página. Ten en cuenta que cerrar una pestaña finaliza una sesión, por lo que un mismo usuario usando varias pestañas se registrará como múltiples sesiones. |
| mutationLimit            | `number `                           | 10000       | El límite superior de mutaciones a procesar antes de que Session Replay deje de grabar debido a impactos en el rendimiento. Consulta [Límites de mutación](#mutation-limits) |
| mutationBreadcrumbLimit  | `number `                           | 750         | El límite superior de mutaciones a procesar antes de que Session Replay envíe un breadcrumb para advertir sobre mutaciones grandes. Consulta [Límites de mutación](#mutation-limits) |
| minReplayDuration        | `number`                            | 5000        | La duración de la reproducción, **en milisegundos**, antes de que el SDK deba comenzar a enviar a Sentry. El valor máximo es 15000. **Nota:** Esto solo aplica al muestreo basado en sesión (`replaysSessionSampleRate`). Para el muestreo basado en errores/en buffer (`replaysOnErrorSampleRate`), las reproducciones se capturan inmediatamente cuando se toma una muestra del error. |
| maxReplayDuration        | `number`                            | 3600000        | La duración máxima de la reproducción, **en milisegundos**, que el SDK debe enviar a Sentry. El valor máximo es 3600000 (1 hora).                                                   |
| workerUrl                | `string`                            | `undefined` | Una URL para un worker autoalojado que comprime los datos de Replay. Consulta [Uso de un worker de compresión personalizado](#using-a-custom-compression-worker) para obtener más información. |
| networkDetailAllowUrls   | <code>(string|RegExp)[]</code>     | `[]`        | Captura detalles de solicitud y respuesta para XHR y fetch que coincidan con las URL indicadas.                                                                              |
| networkDetailDenyUrls    | <code>(string|RegExp)[]</code>     | `[]`        | No captura detalles de solicitud y respuesta para estas URL. Tiene prioridad sobre `networkDetailAllowUrls`.                                                                 |
| networkCaptureBodies     | `boolean`                           | `true`      | Define si se capturan los cuerpos de solicitud y respuesta para las URL definidas en `networkDetailAllowUrls`.                                                               |
| networkRequestHeaders    | `string[]`                          | `[]`        | Encabezados de solicitud adicionales que capturar para las URL definidas en `networkDetailAllowUrls`. Consulta [Detalles de red](#network-details) para obtener más información. |
| networkResponseHeaders   | `string[]`                          | `[]`        | Encabezados de respuesta adicionales que capturar para las URL definidas en `networkDetailAllowUrls`. Consulta [Detalles de red](#network-details) para obtener más información. |
| beforeAddRecordingEvent  | <code>(event) =&gt; event|null</code> | `i => i`    | Filtra eventos de grabación adicionales que incluyen logs de consola y solicitudes/respuestas de red.                                                                         |
| beforeErrorSampling      | `(event) => boolean`                | `i => true` | Filtra eventos de error que deben omitirse para el muestreo de errores. Devuelve `false` si se debe omitir el muestreo para este evento de error, o `true` para muestrear este error. Solo se llamará en modo `buffer`. |
| slowClickIgnoreSelectors | `string[]`                          | `[]`        | Ignora la detección de clics lentos/de ira en elementos que coincidan con los selectores CSS indicados.                                                                       |

<div id="privacy-configuration">
  ## Configuración de privacidad
</div>

Nos tomamos la privacidad en serio, así que ofrecemos varias opciones centradas en la privacidad. Obtén más información en nuestra <PlatformLink to="/session-replay/privacy/">documentación sobre privacidad de Session Replay</PlatformLink>.

<PlatformContent includePath="replay/privacy-configuration" />

<div id="sampling">
  ### Muestreo
</div>

Para obtener más información sobre cómo funciona el muestreo de sesiones, consulta la documentación de <PlatformLink to="/session-replay/understanding-sessions/#default-session-initialization">Inicialización predeterminada de sesiones</PlatformLink>.

<div id="network-details">
  ### Detalles de red
</div>

De forma predeterminada, Replay capturará información básica sobre todas las solicitudes salientes de fetch y XHR en tu aplicación. Esto incluye la URL, el tamaño del cuerpo de la solicitud y de la respuesta, el método y el código de estado. El objetivo es reducir la posibilidad de recopilar datos privados.

Para capturar información adicional, como encabezados o cuerpos de solicitud y respuesta, deberás habilitarlo explícitamente mediante `networkDetailAllowUrls` (requiere la versión del SDK &gt;= [7.50.0](https://github.com/getsentry/sentry-javascript/releases/tag/7.50.0)). Esto te permitirá incluir únicamente las URL que sean seguras para capturar cuerpos y evitar cualquier endpoint que pueda contener información de identificación personal (PII).

<Alert>
  El contenido de los cuerpos se depurará para eliminar PII del lado del servidor, en función de las claves y los valores de los objetos.
  Consulta nuestra <PlatformLink to="/session-replay/privacy/#network-request-and-response-bodies-and-headers">sección de privacidad de Replay</PlatformLink> para más detalles.
</Alert>

Cualquier URL que coincida con los patrones indicados se capturará con información adicional:

```javascript
replayIntegration({
  networkDetailAllowUrls: [window.location.origin],
});
```

Si nos das una cadena, haremos coincidir cualquier URL que la contenga. Puedes usar una expresión regular para realizar coincidencias exactas o más complejas.

Las solicitudes a una URL que coincida con los patrones configurados se complementarán con el cuerpo de la solicitud y de la respuesta, así como con los siguientes encabezados predeterminados:

* `Content-Type`
* `Content-Length`
* `Accept`

Si quieres capturar encabezados adicionales, tendrás que configurarlos con las opciones `networkRequestHeaders` y `networkResponseHeaders`, por ejemplo:

```javascript {7-8}
replayIntegration({
  networkDetailAllowUrls: [
    window.location.origin,
    "api.example.com",
    /^https:\/\/api\.example\.com/,
  ],
  networkRequestHeaders: ["Cache-Control"],
  networkResponseHeaders: ["Referrer-Policy"],
});
```

<Alert>Los cuerpos capturados se truncarán a un máximo de 150 000 caracteres.</Alert>

<div id="identifying-users">
  ## Identificación de usuarios
</div>

Puedes usar el SDK de Sentry para vincular un usuario a una sesión y añadir información de usuario a los eventos para ayudarte a identificar a los usuarios que están experimentando un problema. Consulta [setUser](/es/platforms/javascript/guides/nextjs/apis/#setUser) para saber cómo establecer el usuario en los eventos de Sentry.

```javascript
Sentry.setUser({ email: "jane.doe@example.com" });
```

<div id="using-a-custom-compression-worker">
  ## Uso de un worker de compresión personalizado
</div>

De forma predeterminada, Session Replay utilizará un script de web worker integrado para comprimir los datos de Replay antes de enviarlos por la red. Esto reduce drásticamente la cantidad de datos transferidos, mejora el rendimiento y reduce la sobrecarga de red. Como la compresión de datos es intensiva en CPU, usamos un web worker para descargar este trabajo a un hilo separado.

Aunque un worker integrado funcionará bien para la mayoría de las aplicaciones, existen dos problemas principales con esto:

1. Dado que el código del worker está integrado, aumenta el tamaño del bundle principal de tu aplicación.
2. Usar workers integrados puede causar infracciones de la CSP si tu aplicación tiene una política de CSP muy estricta. Consulta nuestra documentación de <PlatformLink to="/session-replay/#content-security-policy-csp">CSP</PlatformLink> para obtener más información.

Para resolver estos problemas, ofrecemos la posibilidad de usar un script de worker personalizado. Esto te permite alojar el script del worker en tu propio dominio y evitar los problemas de CSP que conllevan los workers integrados. Además, el script del worker puede eliminarse del bundle principal de la aplicación y servirse y almacenarse en caché por separado.

Sigue estos pasos para usar un worker de compresión personalizado:

1. Descarga el [script de worker de ejemplo](https://github.com/getsentry/sentry-javascript/blob/develop/packages/replay-worker/examples/worker.min.js) desde nuestro repositorio de GitHub.
2. Aloja este script de worker en el mismo dominio que tu aplicación. Por ejemplo, si tu aplicación está alojada en `https://example.com`, podrías alojar el script del worker en `https://example.com/assets/worker.min.js`.
3. Configura tu script de worker personalizado en Replay:

```javascript
replayIntegration({
  workerUrl: "/assets/worker.min.js",
});
```

4. (opcional) Para reducir el tamaño del bundle, ahora puedes aplicar <PlatformLink to="/configuration/tree-shaking/">tree shaking</PlatformLink> al script de worker incluido por defecto. Si estás usando uno de los [Sentry Bundler Plugins](https://github.com/getsentry/sentry-javascript-bundler-plugins) (versión 2.10.0 o posterior):

```javascript
sentryPlugin({
  // otras configuraciones
  bundleSizeOptimizations: {
    excludeReplayWorker: true,
  },
});
```

Como alojas este script por tu cuenta, eres responsable de mantenerlo actualizado. Te recomendamos comprobar periódicamente si hay actualizaciones del script del worker y aplicarlas según sea necesario. La API del script del worker se mantiene estable dentro de una versión principal, por lo que cualquier script del worker v7 debería ser compatible tanto hacia atrás como hacia adelante con cualquier versión del SDK v7. Sin embargo, podríamos introducir mejoras o correcciones de errores en el script del worker que no recibirás si no lo actualizas.

<div id="mutation-limits">
  ## Límites de mutaciones
</div>

Session Replay funciona registrando los cambios incrementales del DOM que ocurren en tu aplicación web. Por lo general, estos cambios se dan en pequeños lotes y generan una sobrecarga mínima. Sin embargo, es fácil pasar por alto casos que provocan una gran cantidad de mutaciones del DOM en una sola actualización. Un ejemplo es un componente de menú desplegable personalizado con una lista ilimitada de opciones para renderizar. Esto puede afectar negativamente el rendimiento incluso sin Session Replay, y su impacto se amplifica cuando Session Replay está habilitado. Para evitar este escenario, Session Replay dejará de grabar si detecta un gran número de mutaciones (valor predeterminado: 10.000), configurable mediante `mutationLimit`. Además, en la reproducción incluimos breadcrumbs para avisarte cuando se detecta un gran número de mutaciones (valor predeterminado: 750).

```javascript
replayIntegration({
  mutationBreadcrumbLimit: 1000,
  mutationLimit: 1500,
});
```

<div id="custom-breadcrumbs">
  ## Migas de pan personalizadas
</div>

Nuestros SDK te permiten enviar migas de pan personalizadas, que aparecerán en la IU de Replay Details junto con las migas existentes. Para saber cómo enviar migas de pan personalizadas, [lee la documentación aquí](/es/platforms/javascript/enriching-events/breadcrumbs/#customize-breadcrumbs). Ten en cuenta que cualquier miga personalizada que envíes se reflejará tanto en la IU de migas de Issue Details como en la pestaña de migas de Replay Details.

Todas las migas de pan personalizadas en Replay Details aparecerán en gris y se identificarán por el ícono de terminal.

En Replay Details, la miga `message` tendrá prioridad sobre la propiedad `data`. Si la propiedad `message` está definida, la cadena se mostrará así:

![Ejemplo de miga de pan personalizada con message](./img/message-custom-breadcrumb.png)

Si `message` no está definida, la miga mostrará la propiedad `data` de forma predeterminada. Por ejemplo:

![Ejemplo de miga de pan personalizada con data](./img/data-custom-breadcrumb.png)

El título de la miga será la `category` que establezcas. Si no se establece ninguna `category`, usaremos la `message`. Si no existe, usaremos la `description`. El último recurso será un título predeterminado de &quot;Custom&quot;.