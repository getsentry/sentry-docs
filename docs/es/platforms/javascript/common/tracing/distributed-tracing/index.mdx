---
title: Configura el rastreo distribuido
description: "Aprende a conectar eventos entre aplicaciones y servicios."
sidebar_order: 20
notSupported:
  - javascript.cordova
---

<PlatformContent includePath="distributed-tracing/explanation" />

<div id="basic-example">
  ## Ejemplo básico
</div>

Aquí tienes un ejemplo que muestra un rastro distribuido en Sentry:

<Include name="common-imgs/distributed-trace-in-sentry" />

Este rastro distribuido muestra que el `pageload` de una app de Vue realiza una solicitud a un backend de Python, que luego llama al endpoint `/api` de un microservicio en Ruby.

En segundo plano, Sentry lee y sigue propagando dos encabezados HTTP entre tus aplicaciones:

- `sentry-trace`
- `baggage`

<Alert>

Si ejecutas aplicaciones JavaScript en tu sistema distribuido, asegúrate de añadir esos dos encabezados a la allowlist de CORS y de que no sean bloqueados ni eliminados por tus servidores proxy, gateways o firewalls.

</Alert>

<div id="how-to-use-distributed-tracing">
  ## ¿Cómo utilizar el rastreo distribuido?
</div>

<PlatformContent includePath="distributed-tracing/how-to-use/" />

<Alert >

Recuerda que, para propagar la información de las trazas en todo tu sistema distribuido, debes usar Sentry en todos los servicios y aplicaciones implicados. Consulta la documentación del SDK correspondiente para saber cómo habilitar el rastreo distribuido en cada plataforma.

</Alert>

<div id="trace-duration">
  ## Duración del trace
</div>

<PlatformCategorySection supported={["browser"]}>

En el navegador, el SDK inicia automáticamente un nuevo trace en las siguientes situaciones:

- Al cargar la página: Siempre que la página se recarga, se inicia un nuevo trace. Al mismo tiempo, se crea un span `pageload` (consulta <PlatformLink to="/tracing/instrumentation/automatic-instrumentation">Performance Monitoring</PlatformLink>). Una vez que este span termina, el trace permanece hasta la siguiente navegación o carga de página. Si el servidor que entrega la página inicial ya inició un trace y envió al navegador las [etiquetas HTML](./custom-instrumentation/#extract-tracing-information-from-html-meta-tags) necesarias, el SDK continuará ese trace en lugar de iniciar uno nuevo.
- Al navegar: Siempre que un usuario navega (por ejemplo, en una aplicación de una sola página), se inicia un nuevo trace. Al mismo tiempo, se crea un span `navigation` (consulta <PlatformLink to="/tracing/instrumentation/automatic-instrumentation">Performance Monitoring</PlatformLink>). Una vez que este span termina, el trace permanece hasta la siguiente navegación o carga de página.

En ambos casos, esto significa que si inicias spans después de que hayan terminado los spans automáticos `pageload` y `navigation`, seguirán formando parte del mismo trace. Esto facilita conectar lo que ocurrió antes y después de tu span.

</PlatformCategorySection>

<PlatformCategorySection supported={["server", "serverless"]}>

Los SDK del lado del servidor gestionan los traces automáticamente por cada solicitud. Esto significa que los SDK:

- Continúan un trace existente si la solicitud entrante contiene un header de trace.
- Inician un nuevo trace si la solicitud entrante no contiene un header de trace. Este trace permanece activo hasta que se envía la respuesta.

</PlatformCategorySection>

Si es necesario, puedes sobrescribir la duración predeterminada del trace [iniciando manualmente un nuevo trace](./custom-instrumentation#starting-a-new-trace).

<div id="how-sampling-propagates-in-distributed-traces">
  ## Cómo se propaga el muestreo en trazas distribuidas
</div>

Sentry usa un enfoque de muestreo “basado en el encabezado”:

* La decisión de muestreo se toma en el servicio de origen (la “cabeza”)
* Esta decisión se propaga a todos los servicios posteriores

Los dos encabezados clave son:

* `sentry-trace`: Contiene el ID de la traza, el ID del span y la decisión de muestreo
* `baggage`: Contiene metadatos adicionales de la traza, incluido el índice de muestreo

Sentry adjunta automáticamente estos encabezados a las solicitudes HTTP salientes cuando se usa `browserTracingIntegration`. Para otros canales de comunicación como WebSockets, puedes propagar manualmente la información de la traza:

```javascript
// Extraer datos de rastreo del ámbito actual
const traceData = Sentry.getTraceData();
const sentryTraceHeader = traceData["sentry-trace"];
const sentryBaggageHeader = traceData["baggage"];

// Agregar a tu solicitud personalizada (ejemplo usando WebSocket)
webSocket.send(JSON.stringify({
  message: "Tus datos aquí",
  metadata: {
    sentryTrace: sentryTraceHeader,
    baggage: sentryBaggageHeader
  }
}));
```
