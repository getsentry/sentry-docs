---
title: Muestreo
description: "Aprende a configurar el volumen de eventos de error y transacción enviados a Sentry."
sidebar_order: 50
---

Agregar Sentry a tu app te ofrece una gran cantidad de información muy valiosa sobre errores y rendimiento que de otro modo no obtendrías. Y mucha información está bien, siempre que sea la correcta y en un volumen razonable.

<div id="sampling-error-events">
  ## Muestreo de eventos de error
</div>

Para enviar una muestra representativa de tus errores a Sentry, establece la opción <PlatformIdentifier name="sample-rate" /> en la configuración de tu SDK a un número entre `0` (0% de errores enviados) y `1` (100% de errores enviados). Es una tasa estática que se aplicará por igual a todos los errores. Por ejemplo, para muestrear el 25% de tus errores:

<PlatformContent includePath="configuration/sample-rate" />

La tasa de muestreo de errores es `1` de forma predeterminada, lo que significa que todos los errores se envían a Sentry.

<Alert>

Cambiar la tasa de muestreo de errores requiere volver a desplegar. Además, establecer una tasa de muestreo en el SDK limita la visibilidad del origen de los eventos. Establecer un límite de tasa para tu proyecto (que solo descarta eventos cuando el volumen es alto) puede adaptarse mejor a tus necesidades.

</Alert>

<PlatformSection notSupported={["javascript.electron"]}>

<div id="sampling-transaction-events">
  ## Muestreo de eventos de transacción
</div>

Recomendamos muestrear tus transacciones por dos razones:

1. Capturar un único trace implica una sobrecarga mínima, pero capturar traces para _cada_ carga de página o _cada_ solicitud de API puede añadir una carga indeseable a tu sistema.
2. Habilitar el muestreo te permite gestionar mejor la cantidad de eventos enviados a Sentry, para que puedas ajustar el volumen a las necesidades de tu organización.

Elige una tasa de muestreo con el objetivo de encontrar un equilibrio entre el rendimiento y el volumen, sin perder precisión de los datos. No quieres recopilar _demasiados_ datos, pero sí los suficientes como para extraer conclusiones significativas. Si no estás seguro de qué tasa elegir, comienza con un valor bajo y auméntalo gradualmente a medida que conozcas mejor tus patrones de tráfico y volumen.

<div id="configuring-the-transaction-sample-rate">
  ## Configuración de la tasa de muestreo de transacciones
</div>

Los SDK de Sentry tienen dos opciones de configuración para controlar el volumen de transacciones enviadas a Sentry, lo que te permite obtener una muestra representativa:

1. Tasa de muestreo uniforme (<PlatformIdentifier name="traces-sample-rate" />):

   - Proporciona una muestra uniforme de transacciones, sin importar dónde en tu app o bajo qué circunstancias ocurran.
   - Utiliza el comportamiento predeterminado de [herencia](#inheritance) y [precedencia](#precedence)

2. Función de muestreo (<PlatformIdentifier name="traces-sampler" />) que:
   - Muestrea distintas transacciones a diferentes tasas
   - <PlatformLink to="/configuration/filtering/">Filtra</PlatformLink> por completo
     algunas transacciones
   - Modifica el comportamiento predeterminado de [precedencia](#precedence) y [herencia](#inheritance)

De forma predeterminada, ninguna de estas opciones está configurada, por lo que no se enviarán transacciones a Sentry. Debes configurar una de las dos opciones para empezar a enviar transacciones.

<div id="setting-a-uniform-sample-rate">
  ### Configurar una tasa de muestreo uniforme
</div>

<PlatformContent includePath="performance/uniform-sample-rate" />

<div id="setting-a-sampling-function">
  ### Configurar una función de muestreo
</div>

<PlatformContent includePath="performance/sampling-function-intro" />

<div id="sampling-context-data">
  ## Muestreo de datos de contexto
</div>

Cuando se inicia un span, la función `tracesSampler` recibirá automáticamente el `name` del span y los `attributes` iniciales del span para usarlos en su decisión de muestreo. Además, también recibirá un booleano `parentSampled` que indica si el span padre fue muestreado. Estos datos pueden usarse para tomar una decisión más informada sobre si muestrear el span.

<PlatformContent includePath="performance/custom-sampling-context" />

Ten en cuenta que el `name` pasado a `tracesSampler` puede no ser exactamente el mismo que finalmente se envía a Sentry. El nombre puede actualizarse durante la vida del span, pero el `name` pasado a `tracesSampler` siempre será el inicial. Por ejemplo, el `name` para spans de `http.server` generalmente aún no estará parametrizado cuando se pase a `tracesSampler`, por lo que en lugar de `GET /users/:id` podrías ver un nombre como `GET /users/123`.

</PlatformSection>

<div id="inheritance">
  ## Herencia
</div>

Sea cual sea la decisión de muestreo de una transacción, esa decisión se pasará a sus spans secundarios y, desde allí, a cualquier transacción que posteriormente se inicie en otros servicios.

<PlatformSection notSupported={["javascript.cordova"]}>

(Consulta <PlatformLink to="/tracing/trace-propagation/">Distributed Tracing</PlatformLink> para obtener más información sobre cómo se realiza esa propagación).

</PlatformSection>

Si la transacción que se está creando en este momento es una de esas transacciones posteriores (es decir, si tiene una transacción padre), la decisión de muestreo upstream (del padre) se incluirá en los datos del contexto de muestreo. Tu <PlatformIdentifier name="traces-sampler" /> puede usar esta información para decidir si heredar esa decisión. En la mayoría de los casos, heredar es la opción adecuada para evitar romper trazas distribuidas. Una traza rota no incluirá todos tus servicios.

<PlatformContent includePath="performance/always-inherit-sampling-decision">

En algunos SDK, por conveniencia, la función <PlatformIdentifier name="traces-sampler" /> puede devolver un booleano, de modo que la decisión del padre pueda devolverse directamente si ese es el comportamiento deseado.

</PlatformContent>

Si estás usando un <PlatformIdentifier name="traces-sample-rate" /> en lugar de un <PlatformIdentifier name="traces-sampler" />, la decisión siempre se heredará.

<div id="precedence">
  ## Precedencia
</div>

Hay varias maneras en que una transacción puede terminar con una decisión de muestreo.

- Muestreo aleatorio según una tasa de muestreo estática definida en <PlatformIdentifier name="traces-sample-rate" />
- Muestreo aleatorio según una tasa devuelta por la función <PlatformIdentifier name="traces-sampler" />
- Decisión absoluta (100% de probabilidad o 0% de probabilidad) devuelta por <PlatformIdentifier name="traces-sampler" />
- Si la transacción tiene un elemento padre, heredar la decisión de muestreo del padre
- Decisión absoluta pasada a <PlatformIdentifier name="start-transaction" />

Cuando pueda intervenir más de una de estas, se aplican las siguientes reglas de precedencia:

1. Si <PlatformIdentifier name="traces-sampler" /> está definido, se usará su decisión. Puede optar por mantener o ignorar cualquier decisión de muestreo del padre, usar los datos del contexto de muestreo para tomar su propia decisión o elegir una tasa de muestreo para la transacción. Desaconsejamos anular la decisión de muestreo del padre porque romperá los trazados distribuidos.
1. Si <PlatformIdentifier name="traces-sampler" /> no está definido, pero existe una decisión de muestreo del padre, se usará la decisión de muestreo del padre.
1. Si <PlatformIdentifier name="traces-sampler" /> no está definido y no hay decisión de muestreo del padre, se usará <PlatformIdentifier name="traces-sample-rate" />.