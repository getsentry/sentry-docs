---
title: Integración con OpenFeign
sidebar_order: 50
sdk: sentry.java.openfeign
description: "Aprende a capturar información de trazabilidad de clientes HTTP basados en OpenFeign."
notSupported:
  - java.logback
  - java.log4j2
  - java.jul
---

<Alert>

Para capturar transacciones, primero debes <PlatformLink to="/tracing/">configurar la trazabilidad</PlatformLink>, si aún no lo has hecho.

</Alert>

La integración de Sentry con OpenFeign proporciona `SentryFeignClient`, que crea un span por cada solicitud HTTP saliente ejecutada con un cliente HTTP basado en [Feign](https://github.com/OpenFeign/feign).

<div id="install">
  ### Instalación
</div>

```xml {tabTitle:Maven}
<dependency>
    <groupId>io.sentry</groupId>
    <artifactId>sentry-openfeign</artifactId>
    <version>{{@inject packages.version('sentry.java.openfeign', '5.1.0') }}</version>
</dependency>
```

```groovy {tabTitle:Gradle}
implementation 'io.sentry:sentry-openfeign:{{@inject packages.version('sentry.java.openfeign', '5.1.0') }}'
```

```scala {tabTitle: SBT}
libraryDependencies += "io.sentry" % "sentry-openfeign" % "{{@inject packages.version('sentry.java.openfeign', '5.1.0') }}"
```

Para otros gestores de dependencias, consulta el [repositorio central de Maven](https://search.maven.org/artifact/io.sentry/sentry-openfeign).


<div id="configure">
  ## Configurar
</div>

Añade `SentryCapability` al constructor de Feign:

```java
import feign.Feign;
import io.sentry.openfeign.SentryCapability;

YourApi api = Feign.builder()
    .addCapability(new SentryCapability())
    ...
    .target(YourApi.class, "https://your-api-host/");
```

```kotlin
import feign.Feign
import io.sentry.openfeign.SentryCapability

val api = Feign.builder()
    .addCapability(SentryCapability())
    ...
    .target(YourApi::class.java, "https://tu-host-de-api/")
```


<div id="modify-or-drop-spans">
  ## Modificar o descartar spans
</div>

Los spans creados en torno a solicitudes HTTP pueden modificarse o descartarse usando `SentryFeignClient.BeforeSpanCallback`, que se pasa a `SentryCapability`:

```java
import feign.Feign;
import io.sentry.openfeign.SentryCapability;

YourApi api = Feign.builder()
    .addCapability(
        new SentryCapability(
            (span, request, response) -> {
              // modifica el span o devuelve `null` para descartarlo
              if (request.url().endsWith("/todos")) {
                span.setTag("tag-name", "tag-value");
              }
              return span;
            }))
    ...
    .target(YourApi.class, "https://your-api-host/");
```

```kotlin
import feign.Feign
import feign.Request
import feign.Response
import io.sentry.ISpan
import io.sentry.openfeign.SentryCapability
import io.sentry.openfeign.SentryFeignClient.BeforeSpanCallback

val api = Feign.builder()
    .addCapability(
        SentryCapability(
            BeforeSpanCallback { span: ISpan, request: Request, response: Response? ->
                // modifica el span o devuelve `null` para omitirlo
                if (request.url().endsWith("/todos")) {
                    span.setTag("tag-name", "tag-value")
                }
                span
            }))
    .target(YourApi::class.java, "https://your-api-host/")
```
