---
title: Uso
sidebar_order: 15
---

<div id="installation">
  ## Instalación
</div>

```xml {tabTitle:Maven}
<dependency>
    <groupId>io.sentry</groupId>
    <artifactId>sentry</artifactId>
    <version>1.7.30</version>
</dependency>
```

```groovy {tabTitle:Gradle}
implementation 'io.sentry:sentry:1.7.30'
```

```scala {tabTitle:SBT}
libraryDependencies += "io.sentry" % "sentry" % "1.7.30"
```

Para otros gestores de dependencias, consulta el [repositorio central de Maven](https://search.maven.org/artifact/io.sentry/sentry-spring).


<div id="capture-an-error">
  ## Capturar un error
</div>

Para informar un evento manualmente, debes inicializar un `SentryClient`. Se recomienda usar la API estática mediante la clase `Sentry`, pero también puedes crear y administrar tu propia instancia de `SentryClient`. A continuación se muestra un ejemplo de cada estilo:

```java
import io.sentry.context.Context;
import io.sentry.event.BreadcrumbBuilder;
import io.sentry.event.UserBuilder;

public class MyClass {
  private static SentryClient sentry;

  public static void main(String... args) {
    /*
     Se recomienda usar el sistema de detección de DSN, que
     comprobará la variable de entorno "SENTRY_DSN", la
     propiedad del sistema de Java "sentry.dsn" o el archivo "sentry.properties"
     en tu classpath. Esto facilita proporcionar y ajustar
     tu DSN sin tener que cambiar el código. Consulta la página de configuración
     para obtener más información.

     Por ejemplo, usando una variable de entorno

     export SENTRY_DSN="___PUBLIC_DSN___"
     */
    Sentry.init();

    // También puedes proporcionar el DSN manualmente al método ``init``.
    // Sentry.init("___PUBLIC_DSN___");

    /*
     Es posible prescindir de la API estática de ``Sentry``, lo que significa
     que serás responsable de poner la instancia de SentryClient a disposición
     de tu código.
     */
    sentry = SentryClientFactory.sentryClient();

    MyClass myClass = new MyClass();
    myClass.logWithStaticAPI();
    myClass.logWithInstanceAPI();
  }

  /**
   * Un método de ejemplo que lanza una excepción.
   */
  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!");
  }

  /**
   * Ejemplos con la API estática (recomendada).
   */
  void logWithStaticAPI() {
    // Ten en cuenta que todos los campos establecidos en el contexto son opcionales. Los datos del contexto se copian en
    // todos los eventos futuros del contexto actual (hasta que se borre el contexto).

    // Registra una breadcrumb en el contexto actual. De forma predeterminada se conservan las últimas 100.
    Sentry.getContext().recordBreadcrumb(
        new BreadcrumbBuilder().setMessage("El usuario realizó una acción").build()
    );

    // Establece el usuario en el contexto actual.
    Sentry.getContext().setUser(
        new UserBuilder().setEmail("hello@sentry.io").build()
    );

    // Agrega datos adicionales a los eventos futuros en este contexto.
    Sentry.getContext().addExtra("extra", "cosa");

    // Agrega una etiqueta adicional a los eventos futuros en este contexto.
    Sentry.getContext().addTag("tagName", "tagValue");

    /*
     Esto envía un evento simple a Sentry usando la instancia almacenada estáticamente
     que se creó en el método ``main``.
     */
    Sentry.capture("Esto es una prueba");

    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry usando la instancia almacenada estáticamente
      // que se creó en el método ``main``.
      Sentry.capture(e);
    }
  }

  /**
   * Ejemplos que usan directamente la instancia de SentryClient.
   */
  void logWithInstanceAPI() {
    // Obtiene el contexto actual.
    Context context = sentry.getContext();

    // Registra una breadcrumb en el contexto actual. De forma predeterminada se conservan las últimas 100.
    context.recordBreadcrumb(new BreadcrumbBuilder().setMessage("El usuario realizó una acción").build());

    // Establece el usuario en el contexto actual.
    context.setUser(new UserBuilder().setEmail("hello@sentry.io").build());

    // Esto envía un evento simple a Sentry.
    sentry.sendMessage("Esto es una prueba");

    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry.
      sentry.sendException(e);
    }
  }
}
```


```kotlin
import io.sentry.context.Context
import io.sentry.event.BreadcrumbBuilder
import io.sentry.event.UserBuilder

class MyClass {
  /**
   * Un método de ejemplo que lanza una excepción.
   */
  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }

  /**
   * Ejemplos que usan la API estática (recomendada).
   */
  fun logWithStaticAPI() {
    // Ten en cuenta que todos los campos definidos en el contexto son opcionales. Los datos del contexto se copian en
    // todos los eventos futuros del contexto actual (hasta que se borre el contexto).

    // Registra un breadcrumb en el contexto actual. De forma predeterminada, se conservan los últimos 100 breadcrumbs.
    Sentry.getContext().recordBreadcrumb(
      BreadcrumbBuilder().setMessage("El usuario realizó una acción").build()
    )

    // Establece el usuario en el contexto actual.
    Sentry.getContext().setUser(
      UserBuilder().setEmail("hello@sentry.io").build()
    )

    // Add extra data to future events in this context.
    // Agrega datos adicionales a los eventos futuros en este contexto.

    // Agrega una etiqueta adicional a los eventos futuros en este contexto.
    Sentry.getContext().addTag("tagName", "tagValue")

    /*
     Esto envía un evento simple a Sentry usando la instancia almacenada estáticamente
     que se creó en el método «main».
     */
    Sentry.capture("Esto es una prueba")
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry usando la instancia almacenada estáticamente
      // que se creó en el método «main».
      Sentry.capture(e)
    }
  }

  /**
   * Ejemplos que usan directamente la instancia de SentryClient.
   */
  fun logWithInstanceAPI() {
    // Obtén el contexto actual.
    val context: Context = sentry.getContext()

    // Registra un breadcrumb en el contexto actual. De forma predeterminada, se conservan los últimos 100 breadcrumbs.
    context.recordBreadcrumb(BreadcrumbBuilder().setMessage("El usuario realizó una acción").build())

    // Establece el usuario en el contexto actual.
    context.setUser(UserBuilder().setEmail("hello@sentry.io").build())

    // Esto envía un evento simple a Sentry.
    sentry.sendMessage("Esto es una prueba")
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry.
      sentry.sendException(e)
    }
  }

  companion object {
    private var sentry: SentryClient? = null

    @JvmStatic
    fun main(args: Array<String>) {
      /*
       Se recomienda usar el sistema de detección de DSN, que
       comprobará la variable de entorno "SENTRY_DSN", la
       propiedad del sistema de Java "sentry.dsn" o el archivo "sentry.properties"
       en tu classpath. Esto facilita proporcionar y ajustar
       tu DSN sin tener que cambiar tu código. Consulta la página de configuración
       para obtener más información.

       Por ejemplo, usando una variable de entorno

      export SENTRY_DSN="___PUBLIC_DSN___"
      */
      Sentry.init()

      // También puedes proporcionar manualmente el DSN al método «init».
      // Sentry.init("___PUBLIC_DSN___");

      /*
       Es posible evitar la API estática de «Sentry», lo que significa que
       tú eres responsable de poner la instancia de SentryClient a disposición
       de tu código.
      */
      sentry = SentryClientFactory.sentryClient()
      val myClass = MyClass()
      myClass.logWithStaticAPI()
      myClass.logWithInstanceAPI()
    }
  }
}
```


<div id="building-more-complex-events">
  ### Creación de eventos más complejos
</div>

Para mensajes más complejos, necesitarás construir un `Event` con la clase `EventBuilder`:

```java
import io.sentry.Sentry;
import io.sentry.event.Event;
import io.sentry.event.EventBuilder;
import io.sentry.event.interfaces.ExceptionInterface;

public class MyClass {
  public static void main(String... args) {
    Sentry.init();
  }

  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!")
  }

  void logSimpleMessage() {
    // Esto envía un evento a Sentry.
    EventBuilder eventBuilder = new EventBuilder()
        .withMessage("Esto es una prueba")
        .withLevel(Event.Level.INFO)
        .withLogger(MyClass.class.getName());

    // Ten en cuenta que se pasa la instancia de EventBuilder aún sin construir para que
    // los EventBuilderHelpers se ejecuten y agreguen información adicional a tu evento.
    Sentry.capture(eventBuilder);
  }

  void logException() {
    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry.
      EventBuilder eventBuilder = new EventBuilder()
          .withMessage("Excepción detectada")
          .withLevel(Event.Level.ERROR)
          .withLogger(MyClass.class.getName())
          .withSentryInterface(new ExceptionInterface(e));

      // Ten en cuenta que se pasa la instancia de EventBuilder aún sin construir para que
      // los EventBuilderHelpers se ejecuten y agreguen información adicional a tu evento.
      Sentry.capture(eventBuilder);
    }
  }
}
```

```kotlin
import io.sentry.Sentry
import io.sentry.event.Event
import io.sentry.event.EventBuilder
import io.sentry.event.interfaces.ExceptionInterface

class MyClass {
  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }

  fun logSimpleMessage() {
    // Esto envía un evento a Sentry.
    val eventBuilder: EventBuilder = EventBuilder()
      .withMessage("Esta es una prueba")
      .withLevel(Event.Level.INFO)
      .withLogger(MyClass::class.java.name)

    // Ten en cuenta que se pasa la instancia de EventBuilder sin compilar para que
    // los EventBuilderHelpers se ejecuten y añadan información adicional a tu evento.
    Sentry.capture(eventBuilder)
  }

  fun logException() {
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry.
      val eventBuilder: EventBuilder = EventBuilder()
        .withMessage("Excepción capturada")
        .withLevel(Event.Level.ERROR)
        .withLogger(MyClass::class.java.name)
        .withSentryInterface(ExceptionInterface(e))

      // Ten en cuenta que se pasa la instancia de EventBuilder sin compilar para que
      // los EventBuilderHelpers se ejecuten y añadan información adicional a tu evento.
      Sentry.capture(eventBuilder)
    }
  }

  companion object {
    @JvmStatic
    fun main(args: Array<String>) {
      Sentry.init()
    }
  }
}
```


<div id="automatically-enhancing-events">
  ### Mejora automática de eventos
</div>

También puedes implementar un `EventBuilderHelper` que mejore automáticamente los eventos salientes.

```java
import io.sentry.Sentry;
import io.sentry.SentryClient;
import io.sentry.event.EventBuilder;
import io.sentry.event.helper.EventBuilderHelper;

public class MyClass {
  public void myMethod() {
    SentryClient client = Sentry.getStoredClient();

    EventBuilderHelper myEventBuilderHelper = new EventBuilderHelper() {
      @Override
      public void helpBuildingEvent(EventBuilder eventBuilder) {
        eventBuilder.withMessage("¡Reemplazado por myEventBuilderHelper!");
      }
    };

    // Añade un ``EventBuilderHelper`` a la instancia de cliente actual. Ten en cuenta que
    // este helper procesará *todos* los eventos futuros.
    client.addBuilderHelper(myEventBuilderHelper);

    // Envía un evento a Sentry. Durante la construcción del evento, el mensaje
    // será reemplazado por ``myEventBuilderHelper``.
    Sentry.capture("¡Hola, mundo!");
  }
}
```

```kotlin
import io.sentry.Sentry
import io.sentry.SentryClient
import io.sentry.event.EventBuilder
import io.sentry.event.helper.EventBuilderHelper

class MyClass {
  fun myMethod() {
    val client: SentryClient = Sentry.getStoredClient()
    val myEventBuilderHelper: EventBuilderHelper = object : EventBuilderHelper() {
      fun helpBuildingEvent(eventBuilder: EventBuilder) {
        eventBuilder.withMessage("¡Sobrescrito por myEventBuilderHelper!")
      }
    }

    // Añade un ``EventBuilderHelper`` a la instancia de cliente actual. Ten en cuenta que
    // este helper procesará *todos* los eventos futuros.
    client.addBuilderHelper(myEventBuilderHelper)

    // Envía un evento a Sentry. Durante la construcción del evento, el cuerpo del mensaje
    // será sobrescrito por ``myEventBuilderHelper``.
    Sentry.capture("¡Hola, mundo!")
  }
}
```
