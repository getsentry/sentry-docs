---
title: log4j 1.x
sidebar_order: 30
---

<Alert level="warning" title="Nota">
  Un [SDK de Java actualizado](/es/platforms/java/) sustituye esta versión en desuso. Sentry conserva esta documentación para clientes que todavía utilizan el cliente antiguo. Recomendamos usar el SDK de Java actualizado para proyectos nuevos.
</Alert>

La biblioteca `sentry-log4j` ofrece compatibilidad con [Log4j 1.x](https://logging.apache.org/log4j/1.2/) para Sentry mediante un [Appender](https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Appender.html) que envía a Sentry las excepciones registradas. Una vez configurada esta integración, *también* puedes usar la API estática de Sentry, [como se muestra en la página de uso](/es/platforms/java/legacy/usage/), para cosas como registrar breadcrumbs, establecer el usuario actual o enviar eventos manualmente.

El código fuente está disponible [en GitHub](https://github.com/getsentry/sentry-java/tree/master/sentry-log4j).

<div id="installation">
  ### Instalación
</div>

```xml {tabTitle:Maven}
<dependency>
    <groupId>io.sentry</groupId>
    <artifactId>sentry-log4j</artifactId>
    <version>1.7.30</version>
</dependency>
```

```groovy {tabTitle:Gradle}
implementation 'io.sentry:sentry-log4j:1.7.30'
```

```scala {tabTitle: SBT}
libraryDependencies += "io.sentry" % "sentry-log4j" % "1.7.30"
```

Para otros administradores de dependencias, consulta el [repositorio central de Maven](https://search.maven.org/artifact/io.sentry/sentry-log4j).

<div id="usage">
  ### Uso
</div>

Los siguientes ejemplos configuran un `ConsoleAppender` que registra en la salida estándar con el nivel `INFO` y un `SentryAppender` que envía registros al servidor de Sentry con el nivel `WARN`. El `ConsoleAppender` se incluye únicamente como ejemplo de un appender ajeno a Sentry configurado con un umbral de registro diferente, similar a uno que quizá ya tengas en tu proyecto.

Ejemplo de configuración con el formato `log4j.properties`:

```ini
# Habilitar los appenders de Console y Sentry
log4j.rootLogger=INFO, Console, Sentry

# Configurar el appender de Console
log4j.appender.Console=org.apache.log4j.ConsoleAppender
log4j.appender.Console.layout=org.apache.log4j.PatternLayout
log4j.appender.Console.layout.ConversionPattern=%d{HH:mm:ss.SSS} [%t] %-5p: %m%n

# Configurar el appender de Sentry, reemplazando el umbral de registro al nivel WARN
log4j.appender.Sentry=io.sentry.log4j.SentryAppender
log4j.appender.Sentry.threshold=WARN
```

Como alternativa, usando el formato `log4j.xml`:

```xml
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE log4j:configuration SYSTEM "log4j.dtd">
<log4j:configuration debug="true"
    xmlns:log4j='http://jakarta.apache.org/log4j/'>

    <!-- Configurar el appender de consola -->
    <appender name="Console" class="org.apache.log4j.ConsoleAppender">
        <layout class="org.apache.log4j.PatternLayout">
            <param name="ConversionPattern"
                   value="%d{yyyy-MM-dd HH:mm:ss} %-5p %c{1}:%L - %m%n" />
        </layout>
    </appender>

    <!-- Configurar el appender de Sentry, reemplazando el umbral de registro al nivel WARN -->
    <appender name="Sentry" class="io.sentry.log4j.SentryAppender">
        <!-- Reemplazar el nivel de registro del manejador de Sentry a WARN -->
        <filter class="org.apache.log4j.varia.LevelRangeFilter">
            <param name="levelMin" value="WARN" />
        </filter>
    </appender>

    <!-- Habilitar los appenders de consola y Sentry. Console se proporciona como ejemplo
 de un logger que no es de Sentry y que está configurado con un umbral de registro diferente -->
    <root level="INFO">
        <appender-ref ref="Console" />
        <appender-ref ref="Sentry" />
    </root>
</log4j:configuration>
```

A continuación, **debes configurar tu DSN** (clave de cliente) y, opcionalmente, otros valores como `environment` y `release`. [Consulta la página de configuración](/es/platforms/java/legacy/configuration/#setting-the-dsn) para ver cómo hacerlo.

{/* <!-- TODO-AÑADIR EJEMPLO DE VERIFICACIÓN --> */}

<div id="additional-data">
  ### Datos adicionales
</div>

Es posible añadir datos adicionales a los eventos gracias a los sistemas [MDC](https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/MDC.html) y [NDC](https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/NDC.html) proporcionados por Log4j 1.x.

<div id="mapped-tags">
  #### Etiquetas asignadas
</div>

De forma predeterminada, todos los parámetros de MDC se almacenan en la pestaña “Additional Data” de Sentry. Al especificar la opción `mdctags` en tu configuración, puedes elegir qué claves de MDC enviar como etiquetas, lo que permite usarlas como filtros en la interfaz de Sentry.

```java
void logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development");
  MDC.put("OS", "Linux");

  // Esto envía un evento donde los valores de MDC Environment y OS se establecen como datos adicionales
  logger.error("Esta es una prueba");
}
```

```kotlin
fun logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development")
  MDC.put("OS", "Linux")

  // Esto envía un evento donde los valores de MDC Environment y OS se establecen como datos adicionales
  logger.error("Esta es una prueba")
}
```

<div id="in-practice">
  ### En la práctica
</div>

```java
import org.apache.log4j.Logger;
import org.apache.log4j.MDC;
import org.apache.log4j.NDC;

public class MyClass {
  private static final Logger logger = Logger.getLogger(MyClass.class);

  void logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con los siguientes eventos,
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.record(
        new BreadcrumbBuilder().setMessage("El usuario realizó una acción").build()
    );

    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value");
    // Los extras de NDC se envían bajo 'log4J-NDC'
    NDC.push("Extra_details");
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esto es una prueba");
  }

  void logException() {
    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Excepción capturada", e);
    }
  }

  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!");
  }
}
```

```kotlin
import org.apache.log4j.Logger
import org.apache.log4j.MDC
import org.apache.log4j.NDC

class MyClass {
  fun logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esta es una prueba")
  }

  fun logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con los siguientes eventos,
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.record(
      BreadcrumbBuilder().setMessage("El usuario realizó una acción").build()
    )

    // Esto envía un evento simple a Sentry
    logger.error("Esta es una prueba")
  }

  fun logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value")
    // Los extras de NDC se envían bajo 'log4J-NDC'
    NDC.push("Extra_details")
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esta es una prueba")
  }

  fun logException() {
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Excepción capturada", e)
    }
  }

  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }

  companion object {
    private val logger: Logger = Logger.getLogger(MyClass::class.java)
  }
}
```

<div id="asynchronous-logging">
  ### Registro asíncrono
</div>

Sentry usa comunicación asíncrona de forma predeterminada, por lo que no es necesario usar un [AsyncAppender](https://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/AsyncAppender.html).