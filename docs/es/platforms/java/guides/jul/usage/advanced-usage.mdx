---
title: Uso avanzado
sidebar_order: 20
description: "Aprende a añadir datos adicionales con el sistema MDC proporcionado por SLF4J."
---

Puedes añadir datos adicionales a los eventos usando [el sistema MDC](https://www.slf4j.org/api/org/slf4j/helpers/BasicMDCAdapter.html) en cualquier implementación de SLF4J con soporte para MDC que esté en el classpath (por ejemplo, Logback, Log4j2, JUL).

```xml {tabTitle:Maven}
<dependency>
    <groupId>org.slf4j</groupId>
    <artifactId>slf4j-jdk14</artifactId>
    <version>1.7.30</version>
</dependency>
```

```groovy {tabTitle:Gradle}
implementation 'org.slf4j:slf4j-jdk14:1.7.30'
```

```scala {tabTitle: SBT}
libraryDependencies += "org.slf4j" % "slf4j-jdk14" % "1.7.30"
```


<div id="mapped-tags">
  #### Etiquetas asignadas
</div>

De forma predeterminada, todos los parámetros de MDC se almacenan en la pestaña “MDC” de Sentry.

```java {tabTitle:Java}
import java.util.logging.Level;
import org.slf4j.MDC;

void logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development");
  MDC.put("OS", "Linux");

  // Esto envía un evento donde los valores de Environment y OS del MDC se establecen como entradas MDC
  logger.log(Level.SEVERE, "Esta es una prueba");
}
```

```kotlin {tabTitle:Kotlin}
import java.util.logging.Level
import org.slf4j.MDC

fun logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development")
  MDC.put("OS", "Linux")

  // Esto envía un evento donde los valores de MDC de Environment y OS se establecen como entradas de MDC
  logger.log(Level.SEVERE, "Esta es una prueba")
}
```

Ten en cuenta que MDC gestiona los datos por hilo y que un hilo secundario no hereda automáticamente las propiedades de MDC de su hilo principal.


<div id="in-practice">
  ### En la práctica
</div>

```java {tabTitle:Java}
import io.sentry.Sentry;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.slf4j.MDC;

public class MyClass {
  private final Logger logger = Logger.getLogger(MyClass.class.getName());

  void logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.severe("Esto es una prueba");
  }

  void logWithBreadcrumbs() {
    // Registra una breadcrumb que se enviará con el/los próximo(s) evento(s);
    // de forma predeterminada, se conservan las últimas 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción");

    // Las entradas de registro por debajo de `minimumEventLevel` y por encima o iguales a `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción");

    // Esto envía un evento simple a Sentry
    logger.severe("Esto es una prueba");
  }

  void logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value");
    // Esto envía un evento con datos adicionales a Sentry
    logger.severe("Esto es una prueba");
  }

  void logException() {
    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry
      logger.log(Level.SEVERE, "Excepción capturada", e);
    }
  }

  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!");
  }
}
```

```kotlin {tabTitle:Kotlin}
import io.sentry.Sentry
import java.util.logging.Level
import java.util.logging.Logger
import org.slf4j.MDC

class MyClass {
  private val logger = Logger.getLogger(Main::class.java.name)

  fun logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.severe("Esto es una prueba")
  }

  fun logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con el/los siguiente(s) evento(s),
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción")

    // Las entradas de log por debajo de `minimumEventLevel` y por encima o igual a `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción")

    // Esto envía un evento simple a Sentry
    logger.severe("Esto es una prueba")
  }

  fun logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value")
    // Esto envía un evento con datos adicionales a Sentry
    logger.severe("Esto es una prueba")
  }

  fun logException() {
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry
      logger.log(Level.SEVERE, "Excepción capturada", e)
    }
  }

  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }
}
```


<div id="context-tags">
  ## Etiquetas de contexto
</div>

A partir de la versión 6.0.0 de Sentry y posteriores, puedes definir una lista de `MDC tags` que serán visibles como `Tags` en la interfaz de Sentry. Los `MDC tags` que no estén en esta lista serán visibles como `Context Data`.

Desde la versión 8.24.0 del SDK de Sentry para Java, `contextTags` también se aplica a los [logs estructurados](https://docs.sentry.io/product/explore/logs/). Las propiedades de MDC que coincidan con los `contextTags` configurados se adjuntarán a las entradas del log como atributos, con el prefijo &quot;mdc.&quot;.

Para definir una etiqueta que se envíe con eventos y logs, añade una entrada `context-tags` con las etiquetas separadas por comas en el archivo `sentry.properties`.

```properties {tabTitle:Properties}
dsn=___PUBLIC_DSN___
context-tags=userId,requestId
```

Cuando llamas a `MDC.put("userId", "myUserId")` con la configuración anterior, `userId` aparecerá como una etiqueta en el evento en la interfaz de Sentry.
