---
title: Uso avanzado
sidebar_order: 20
description: "Aprende a añadir datos adicionales usando el sistema MDC de Logback."
---

Es posible añadir datos adicionales a los eventos gracias al [sistema MDC de Logback](https://logback.qos.ch/manual/mdc.html).

<div id="mapped-tags">
  #### Etiquetas asignadas
</div>

De forma predeterminada, todos los parámetros de MDC se almacenan en la pestaña “MDC” de Sentry.

```java {tabTitle:Java}
import org.slf4j.MDC;

void logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development");
  MDC.put("OS", "Linux");

  // Esto envía un evento donde los valores de MDC Environment y OS se establecen como entradas MDC
  logger.error("Esta es una prueba");
}
```

```kotlin {tabTitle:Kotlin}
import org.slf4j.MDC

fun logWithExtras() {
  // Extras de MDC
  MDC.put("Environment", "Development")
  MDC.put("OS", "Linux")

  // Esto envía un evento donde los valores de MDC de Environment y OS se establecen como entradas de MDC
  logger.error("Esta es una prueba")
}
```

Ten en cuenta que MDC gestiona los datos por hilo y que un hilo hijo no hereda automáticamente las propiedades de MDC de su hilo padre.


<div id="in-practice">
  ### En la práctica
</div>

```java {tabTitle:Java}
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.slf4j.MDC;

public class MyClass {
  private static final Logger logger = LoggerFactory.getLogger(MyClass.class);

  void logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con el/los siguiente(s) evento(s),
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción");

    // Las entradas de log por debajo de `minimumEventLevel` y por encima o igual a `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción");

    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value");
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esto es una prueba");
  }

  void logException() {
    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Exception caught", e);
    }
  }

  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!");
  }
}
```

```kotlin {tabTitle:Kotlin}
import io.sentry.core.Sentry
import org.slf4j.LoggerFactory
import org.slf4j.MDC

class MyClass {
  companion object {
    private val logger = LoggerFactory.getLogger(Main::class.java)
  }

  fun logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba")
  }

  fun logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con el/los siguiente(s) evento(s),
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción")

    // Las entradas de log por debajo de `minimumEventLevel` y por encima o igual a `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción")

    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba")
  }

  fun logWithExtras() {
    // Extras de MDC
    MDC.put("extra_key", "extra_value")
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esto es una prueba")
  }

  fun logException() {
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Excepción capturada", e)
    }
  }

  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }
}
```


<div id="context-tags">
  ## Etiquetas de contexto
</div>

A partir de la versión 6.0.0 de Sentry, puedes definir una lista de `MDC tags` que serán visibles como `Tags` en la interfaz de Sentry. Las `MDC tags` que no estén en esta lista serán visibles como `Context Data`.

Desde la versión 8.24.0 del SDK de Sentry para Java, `contextTags` también se aplica a los [registros estructurados](https://docs.sentry.io/product/explore/logs/). Las propiedades de MDC que coincidan con los `contextTags` configurados se adjuntarán a las entradas de log como atributos, con el prefijo &quot;mdc.&quot;.

Para definir una etiqueta que se enviará con eventos y logs, agrega una entrada `<contextTag>` dentro de `<options>` en la configuración del appender de Sentry en `logback.xml`.

```xml {tabTitle:XML}
  <appender name="sentry" class="io.sentry.logback.SentryAppender">
    <options>
      <!-- NOTA: Reemplaza el DSN de prueba a continuación con TU PROPIO DSN para ver los eventos de esta app en tu proyecto/dashboard de Sentry -->
      <dsn>___PUBLIC_DSN___</dsn>
      <contextTag>userId</contextTag>
      <contextTag>requestId</contextTag>
    </options>
  </appender>
```

Cuando llamas a `MDC.put("userId", "myUserId")` con la configuración anterior aplicada, `userId` aparecerá como una `tag` del evento en la interfaz de Sentry.
