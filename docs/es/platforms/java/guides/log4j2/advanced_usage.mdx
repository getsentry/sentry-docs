---
title: Uso avanzado
sidebar_order: 6
description: "Conoce los parámetros de ThreadContext que se muestran en sentry.io."
---

De forma predeterminada, todos los parámetros de `ThreadContext` se almacenan en la pestaña “Context Data” de sentry.io.

```java {tabTitle:Java}
import org.apache.logging.log4j.ThreadContext;

void logWithExtras() {
  // Extras de ThreadContext ("MDC")
  ThreadContext.put("Environment", "Development");
  ThreadContext.put("OS", "Linux");

  // Esto envía un evento donde los valores de ThreadContext Environment y OS se establecen como entradas de datos de contexto
  logger.error("Esta es una prueba");
}
```

```kotlin {tabTitle:Kotlin}
import org.apache.logging.log4j.ThreadContext

fun logWithExtras() {
  // Extras de ThreadContext ("MDC")
  ThreadContext.put("Environment", "Development")
  ThreadContext.put("OS", "Linux")

  // Esto envía un evento donde los valores de ThreadContext Environment y OS se establecen como entradas de datos de contexto
  logger.error("Esta es una prueba")
}
```

Ten en cuenta que `ThreadContext` gestiona los datos por hilo y que un hilo secundario no hereda automáticamente las propiedades de `ThreadContext` de su hilo principal.


<div id="in-practice">
  ### En la práctica
</div>

```java {tabTitle:Java}
import io.sentry.core.Sentry;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.ThreadContext;

public class MyClass {
  private static final Logger logger = LogManager.getLogger(MyClass.class);

  void logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con el/los siguiente(s) evento(s),
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción");

    // Las entradas de log por debajo de `minimumEventLevel` y en o por encima de `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción");

    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba");
  }

  void logWithExtras() {
    // Extras MDC
    ThreadContext.put("extra_key", "extra_value");
    // Los extras NDC se envían bajo 'log4j2-NDC'
    ThreadContext.push("Extra_details");
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esto es una prueba");
  }

  void logException() {
    try {
      unsafeMethod();
    } catch (Exception e) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Excepción capturada", e);
    }
  }

  void unsafeMethod() {
    throw new UnsupportedOperationException("¡No deberías llamar a esto!");
  }
}
```

```kotlin {tabTitle:Kotlin}
import io.sentry.core.Sentry
import org.apache.logging.log4j.LogManager
import org.apache.logging.log4j.ThreadContext

class MyClass {
  companion object {
    private val logger = LogManager.getLogger(MyClass::class.java)
  }

  fun logSimpleMessage() {
    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba")
  }

  fun logWithBreadcrumbs() {
    // Registra un breadcrumb que se enviará con el/los siguiente(s) evento(s),
    // por defecto se conservan los últimos 100 breadcrumbs.
    Sentry.addBreadcrumb("El usuario realizó una acción")

    // Las entradas de log por debajo de `minimumEventLevel` y por encima o igual a `minimumBreadcrumbLevel`
    // se registran como breadcrumbs
    logger.info("El usuario realizó otra acción")

    // Esto envía un evento simple a Sentry
    logger.error("Esto es una prueba")
  }

  fun logWithExtras() {
    // Extras de MDC
    ThreadContext.put("extra_key", "extra_value")
    // Los extras de NDC se envían bajo 'log4j2-NDC'
    ThreadContext.push("Extra_details")
    // Esto envía un evento con datos adicionales a Sentry
    logger.error("Esto es una prueba")
  }

  fun logException() {
    try {
      unsafeMethod()
    } catch (e: Exception) {
      // Esto envía un evento de excepción a Sentry
      logger.error("Excepción capturada", e)
    }
  }

  fun unsafeMethod() {
    throw UnsupportedOperationException("¡No deberías llamar a esto!")
  }
}
```


<div id="context-tags">
  ## Etiquetas de contexto
</div>

A partir de la versión 6.0.0 de Sentry, puedes definir una lista de `MDC tags` que serán visibles como `Tags` en la interfaz de Sentry. Las `MDC tags` que no estén en esta lista serán visibles como `Context Data`.

Desde la versión 8.24.0 del SDK de Sentry para Java, `contextTags` también se aplica a los [logs estructurados](https://docs.sentry.io/product/explore/logs/). Las propiedades de MDC que coincidan con los `contextTags` configurados se adjuntarán a las entradas de log como atributos, con el prefijo &quot;mdc.&quot;.

Para definir una etiqueta que se enviará con eventos y logs, agrega un atributo `contextTags` a la etiqueta `<Sentry>` en tu `log4j2.xml`, con las etiquetas separadas por comas.

```xml {tabTitle:XML}
<Sentry name="Sentry"
  dsn="___PUBLIC_DSN___"
  contextTags="userId,requestId"
/>
```

Cuando llamas a `ThreadContext.push("userId", "myUserId")` con la configuración anterior, `userId` aparecerá como una etiqueta del evento en la interfaz de Sentry.
