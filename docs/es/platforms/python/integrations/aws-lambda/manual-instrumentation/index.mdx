---
title: Instrumentación manual de AWS Lambda
description: "Aprende a instrumentar manualmente tu función de AWS Lambda con Sentry."
sidebar_order: 2000
---

Esta guía te explica cómo agregar Sentry manualmente a tu función de AWS Lambda instalando el SDK de Sentry en los paquetes de tu función. Aunque este método requiere más esfuerzo, te da control total sobre tu configuración de Sentry y la instrumentación manual.

También puedes configurar esta función de una de estas dos maneras:

* **Sin tocar tu código:**
  Este método puede instrumentarse desde el producto de Sentry por quienes tienen acceso a la infraestructura de AWS y no requiere que hagas actualizaciones directas al código. Consulta la [guía de AWS Lambda](/es/organization/integrations/cloud-monitoring/aws-lambda/).
* **Agregando manualmente la capa de Sentry Lambda a tu función:**
  Aunque es una forma rápida de agregar Sentry a tu función de AWS Lambda, ofrece opciones de configuración limitadas con variables de entorno. Consulta <PlatformLink to="/integrations/aws-lambda/manual-layer/">AWS Lambda Layer</PlatformLink>.

<div id="install">
  ## Instalar
</div>

Crea un paquete de implementación en tu máquina local e instala las dependencias necesarias dentro de ese paquete.
Para obtener más información, consulta [Paquete de implementación de AWS Lambda en Python](https://docs.aws.amazon.com/lambda/latest/dg/python-package.html).

Instala nuestro SDK de Python en el directorio del paquete con `pip`:

```bash
pip install --target ./package --upgrade sentry-sdk
```

<div id="configure">
  ## Configurar
</div>

A continuación, te explicamos cómo usar la integración de AWS Lambda para el SDK de Python:

Además de capturar errores, puedes supervisar las interacciones entre varios servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/). También puedes recopilar y analizar perfiles de rendimiento de usuarios reales con [profiling](/es/product/explore/profiling/).

Selecciona qué funcionalidades de Sentry quieres instalar, además de Error Monitoring, para obtener a continuación las instrucciones correspondientes de instalación y configuración.

<OnboardingOptionButtons
  options={[
'error-monitoring',
'performance',
'profiling',
]}
/>

```python
import sentry_sdk
from sentry_sdk.integrations.aws_lambda import AwsLambdaIntegration

sentry_sdk.init(
    dsn="___PUBLIC_DSN___",
    # Agrega datos como encabezados de la solicitud e IP de los usuarios, si corresponde;
    # consulta https://docs.sentry.io/platforms/python/data-management/data-collected/ para obtener más información
    send_default_pii=True,
    # ___PRODUCT_OPTION_START___ performance
    # Establece traces_sample_rate en 1.0 para capturar el 100 %
    # de las transacciones en el rastreo.
    traces_sample_rate=1.0,
    # ___PRODUCT_OPTION_END___ performance
    # ___PRODUCT_OPTION_START___ profiling
    # Para recopilar perfiles de todas las sesiones,
    # establece `profile_session_sample_rate` en 1.0.
    profile_session_sample_rate=1.0,
    # Los perfiles se recopilarán automáticamente mientras
    # haya un span activo.
    profile_lifecycle="trace",
    # ___PRODUCT_OPTION_END___ profiling
    integrations=[
        AwsLambdaIntegration(),
    ],
)

def lambda_handler(event, context):
    # ...
```

<Alert title="Nota">
  Si usas otro framework web dentro de AWS Lambda, ese framework podría interceptar las excepciones antes de que lleguen a nosotros. Asegúrate de habilitar la integración específica del framework si está disponible. Consulta [*la página principal de Python*](/es/platforms/python/) para obtener más información.
</Alert>

<div id="verify">
  ## Verificar
</div>

Agrega un error a tu función y ejecútala. Si todo funciona correctamente, debería capturarse y enviarse a Sentry.io.

<div id="behavior">
  ## Comportamiento
</div>

Con la integración de AWS Lambda habilitada, el SDK de Python:

* Informará automáticamente todos los eventos de tus funciones Lambda.

* Te permitirá <PlatformLink to="/configuration/filtering/">modificar la tasa de muestreo de transacciones</PlatformLink> usando `traces_sample_rate`.

* Incluirá automáticamente los siguientes reportes de eventos:

  * Un enlace a CloudWatch Logs
  * Detalles de la función
  * `sys.argv` de la función
  * AWS Request ID
  * Tiempo de ejecución de la función
  * Versión de la función

  Puedes agregar más datos como se describe <PlatformLink to="/enriching-events/">aquí</PlatformLink>.

* Los datos de la solicitud, incluidos **método HTTP, URL, encabezados, datos de formulario y cargas JSON**, se adjuntarán a todos los eventos. Sentry excluye los cuerpos sin procesar y las cargas de archivos multiparte. Sentry también excluye información de identificación personal como IDs de usuario, nombres de usuario, cookies, encabezados de autorización y direcciones IP (a menos que configures `send_default_pii` en `True`).

* Cada solicitud tiene un ámbito independiente. Los cambios en el ámbito dentro de una vista, por ejemplo, establecer una etiqueta, solo se aplicarán a los eventos enviados como parte de la solicitud que se está procesando.

<div id="options">
  ## Opciones
</div>

Puedes cambiar el comportamiento de `AwsLambdaIntegration` configurando opciones:

* `timeout_warning`:

  La advertencia de tiempo de espera informa de un problema cuando el tiempo de ejecución de la función está cerca del [tiempo de espera configurado](https://docs.aws.amazon.com/lambda/latest/dg/configuration-console.html).

  Para habilitar la advertencia, actualiza la inicialización del SDK para establecer `timeout_warning` en `True`:

  ```python
  sentry_sdk.init(
      # ...
      integrations=[
          AwsLambdaIntegration(timeout_warning=True),
      ],
  )
  ```

  La advertencia de tiempo de espera se envía solo si el tiempo de espera en la configuración de la función Lambda está establecido en un valor mayor que un segundo.