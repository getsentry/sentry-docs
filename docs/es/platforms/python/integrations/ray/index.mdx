---
title: Ray
description: "Aprende a importar y usar la integración de Ray."
---

La integración de Ray añade compatibilidad con el framework de cómputo unificado [Ray](https://www.ray.io/).

<div id="install">
  ## Instalación
</div>

Para empezar, instala `sentry-sdk` desde PyPI.

```bash {tabTitle:pip}
pip install "sentry-sdk"
```

```bash {tabTitle:uv}
uv add "sentry-sdk"
```

<div id="configure">
  ## Configurar
</div>

Agrega `RayIntegration()` a tu lista de `integrations`:

Además de capturar errores, puedes supervisar las interacciones entre varios servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/). También puedes recopilar y analizar perfiles de rendimiento de usuarios reales con [profiling](/es/product/explore/profiling/).

Selecciona qué funcionalidades de Sentry quieres instalar, además de Error Monitoring, para obtener a continuación las instrucciones correspondientes de instalación y configuración.

<OnboardingOptionButtons options={["error-monitoring", "performance", "profiling"]} />

```python
import ray

import sentry_sdk
from sentry_sdk.integrations.ray import RayIntegration

def init_sentry():
    sentry_sdk.init(
        dsn="___PUBLIC_DSN___",
        # Agrega datos como encabezados de solicitud e IP de los usuarios, si corresponde;
        # consulta https://docs.sentry.io/platforms/python/data-management/data-collected/ para más información
        send_default_pii=True,
        # ___PRODUCT_OPTION_START___ performance
        # Establece traces_sample_rate en 1.0 para capturar el 100 %
        # de las transacciones de trazado.
        traces_sample_rate=1.0,
        # ___PRODUCT_OPTION_END___ performance
        # ___PRODUCT_OPTION_START___ profiling
        # Para recopilar perfiles en todas las sesiones de perfil,
        # establece `profile_session_sample_rate` en 1.0.
        profile_session_sample_rate=1.0,
        # Los perfiles se recopilarán automáticamente mientras
        # haya un tramo activo.
        profile_lifecycle="trace",
        # ___PRODUCT_OPTION_END___ profiling
        integrations=[
            RayIntegration(),
        ],
    )

init_sentry()

ray.init(
    runtime_env={"worker_process_setup_hook": init_sentry},
)
```

Asegúrate de llamar a `sentry_sdk.init()` antes de llamar a `ray.init()`.

Al configurar `worker_process_setup_hook`, nos aseguramos de que `sentry_sdk.init()` se ejecute dentro de los procesos de trabajo (workers) de Ray durante el arranque. Esto permite que Sentry relacione el código que se ejecuta en el worker con el código que lo invoca.

<div id="verify">
  ## Verificar
</div>

Provoca un error en tu código para comprobar que la integración está enviando eventos a Sentry.

```python
def init_sentry():
    sentry_sdk.init(...)  # igual que arriba

init_sentry()

ray.init(
    runtime_env={"worker_process_setup_hook": init_sentry},
)

@ray.remote
def divide(a, b):
    return a/b

with sentry_sdk.start_transaction(name="prueba-de-ray"):
    futures = [
        divide.remote(10, 5),
        divide.remote(10, 0),
    ]
    print(ray.get(futures))
```

Al ejecutar esto se creará un evento de error (`ZeroDivisionError`) que se enviará a [sentry.io](https://sentry.io). Además, se generará información de trazas en la sección Performance de [sentry.io](https://sentry.io).

<div id="behavior">
  ## Comportamiento
</div>

* Todas las excepciones no controladas se capturarán y podrán consultarse en [sentry.io](https://sentry.io).
* Los datos de rendimiento se capturarán y estarán disponibles en la sección Performance de [sentry.io](https://sentry.io).
* Los datos de rendimiento de [Ray Tasks](https://docs.ray.io/en/latest/ray-core/tasks.html) se capturarán y se vincularán con el código que los invoca.
* **Nota**: Actualmente, no se admite la captura de datos de rendimiento de [Ray Actors](https://docs.ray.io/en/latest/ray-core/actors.html). (Como siempre, [PRs are welcome](https://github.com/getsentry/sentry-python/blob/master/CONTRIBUTING.md))

<div id="supported-versions">
  ## Versiones compatibles
</div>

* Ray: 2.34+
* Python: 3.8+