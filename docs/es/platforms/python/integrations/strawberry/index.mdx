---
title: Strawberry
description: "Aprende a importar la integración de Strawberry GraphQL y cómo captura errores y spans de GraphQL."
---

La integración de Strawberry captura errores y operaciones de la
[biblioteca Strawberry GraphQL](https://strawberry.rocks/), que luego pueden verse
en [Sentry](https://sentry.io).

<div id="install">
  ## Instalar
</div>

Para empezar, instala `sentry-sdk` desde PyPI.

```bash {tabTitle:pip}
pip install "sentry-sdk"
```

```bash {tabTitle:uv}
uv add "sentry-sdk"
```

<div id="configure">
  ## Configurar
</div>

Además de capturar errores, puedes supervisar las interacciones entre múltiples servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/). También puedes recopilar y analizar perfiles de rendimiento de usuarios reales con [profiling](/es/product/explore/profiling/).

Selecciona qué funciones de Sentry quieres instalar, además de Error Monitoring, para obtener a continuación las instrucciones correspondientes de instalación y configuración.

Agrega `StrawberryIntegration()` a tu lista de `integrations`:

<OnboardingOptionButtons
  options={[
'error-monitoring',
'performance',
'profiling',
]}
/>

```python
import sentry_sdk
from sentry_sdk.integrations.strawberry import StrawberryIntegration

sentry_sdk.init(
    dsn="___PUBLIC_DSN___",
    # Agrega datos como encabezados de solicitud e IP de usuarios, si aplica;
    # consulta https://docs.sentry.io/platforms/python/data-management/data-collected/ para más información
    send_default_pii=True,
    # ___PRODUCT_OPTION_START___ performance
    # Establece traces_sample_rate en 1.0 para capturar el 100%
    # de las transacciones para el rastreo.
    traces_sample_rate=1.0,
    # ___PRODUCT_OPTION_END___ performance
    # ___PRODUCT_OPTION_START___ profiling
    # Para recopilar perfiles de todas las sesiones de perfilado,
    # establece `profile_session_sample_rate` en 1.0.
    profile_session_sample_rate=1.0,
    # Los perfiles se recopilarán automáticamente mientras
    # haya un span activo.
    profile_lifecycle="trace",
    # ___PRODUCT_OPTION_END___ profiling
    integrations=[
        StrawberryIntegration(
            # Establece async_execution en True si tienes
            # al menos un resolver asíncrono
            async_execution=True,
        ),
    ],
)
```

<div id="verify">
  ## Verifica
</div>

Asegúrate de tener todas las dependencias previas instaladas:

```bash
pip install 'strawberry-graphql[debug-server]'
```

Crea un archivo `schema.py` con el contenido siguiente:

```python
import strawberry

sentry_sdk.init(...)  # igual que arriba

async def resolve_hello(root) -> str:
    1 / 0
    return "¡Hola mundo!"

@strawberry.type
class Query:
    hello: str = strawberry.field(resolver=resolve_hello)

schema = strawberry.Schema(Query)
```

Para iniciar el servidor web, ejecuta:

```bash
esquema del servidor Strawberry
```

Ve a [http://127.0.0.1:8000/graphql](http://127.0.0.1:8000/graphql) en tu
navegador. Deberías ver la interfaz gráfica de GraphiQL.

Escribe `query HelloQuery { hello }` en el campo de consulta y luego presiona el
botón “Execute query”. Se consultará tu servidor web, lo que debería provocar una
excepción debido al `ZeroDivisionError` que hemos colado en el resolver `resolve_hello`.

Esto creará un `GraphQLError` en la sección Issues, así como una transacción
en la sección Performance de [sentry.io](https://sentry.io). Siempre que la consulta de GraphQL
tenga un nombre (como `HelloQuery` en nuestro ejemplo), la transacción tomará
ese nombre.

Puede tardar unos momentos en que el error y la transacción aparezcan en [sentry.io](https://sentry.io).

<div id="options">
  ## Opciones
</div>

Tendrás varias opciones para elegir:

<div id="synchronous-vs-asynchronous-execution">
  ### Ejecución síncrona vs. asíncrona
</div>

Strawberry admite la ejecución tanto síncrona como asíncrona de consultas
GraphQL. Si tienes al menos un resolver asíncrono, debes inicializar
`StrawberryIntegration` con `async_execution=True`; de lo contrario, configúralo en `False`.

De forma predeterminada, el SDK utilizará la versión síncrona de la integración.

```python
sentry_sdk.init(
    # ...
    integrations=[
        StrawberryIntegration(
            async_execution=True  # o False
        ),
    ],
)
```

<div id="capturing-request-and-response-bodies">
  ### Captura de cuerpos de solicitud y respuesta
</div>

La integración de Strawberry puede capturar los cuerpos de las solicitudes y respuestas
para cada error de GraphQL que ocurra. Dado que pueden contener datos sensibles,
este no es el comportamiento predeterminado. Para habilitar la captura de cuerpos de solicitud y respuesta, el
SDK debe inicializarse con la opción
[send&#95;default&#95;pii](/es/platforms/python/configuration/options/#send-default-pii) establecida en `True`.

```python
sentry_sdk.init(
    # ...
    send_default_pii=True,
)
```

<Alert level="warning" title="Nota">
  Dado que `send_default_pii` es una opción global del SDK, establecerla en `True` afectará a todas
  las integraciones, no solo a Strawberry. Asegúrate de
  [eliminar los datos sensibles](/es/platforms/python/data-management/sensitive-data/)
  de los eventos antes de habilitar esta opción.
</Alert>

<div id="notes">
  ## Notas
</div>

Strawberry incluye una extensión integrada de
[Sentry tracing](https://strawberry.rocks/docs/extensions/sentry-tracing) (ahora en desuso)
sobre la que se basa esta integración. Para evitar trazas duplicadas, la integración del SDK de Sentry desactivará la extensión integrada de Strawberry si estás usando ambas.

<div id="supported-versions">
  ## Versiones compatibles
</div>

* strawberry-graphql: 0.209.5+
* Python: 3.8+