---
title: Sanic
description: "Aprende a usar Sentry con Sanic."
---

La integración de Sanic añade compatibilidad con el [framework web Sanic](https://sanic.dev/).

<div id="install">
  ## Instalar
</div>

Instala `sentry-sdk` desde PyPI con el extra `sanic`:

```bash {tabTitle:pip}
pip install "sentry-sdk[sanic]"
```

```bash {tabTitle:uv}
uv add "sentry-sdk[sanic]"
```

Si usas Python 3.6, también necesitas el paquete `aiocontextvars`:

```bash {tabTitle:pip}
pip install "aiocontextvars"
```

```bash {tabTitle:uv}
uv add "aiocontextvars"
```

<div id="configure">
  ## Configurar
</div>

Si tienes el paquete `sanic` en tus dependencias, la integración de Sanic se habilitará automáticamente cuando inicialices el SDK de Sentry.

Para asegurarte de que los errores que se produzcan en tareas en segundo plano se informen a Sentry, recomendamos habilitar siempre la [`AsyncioIntegration`](/es/platforms/python/integrations/asyncio/) cuando uses la `SanicIntegration`. Para habilitar la `AsyncioIntegration`, debes agregarla explícitamente a la lista de `integrations` e inicializar el SDK dentro de un listener `before_server_start`.

El siguiente ejemplo muestra la configuración recomendada más simple.

Además de capturar errores, puedes supervisar las interacciones entre varios servicios o aplicaciones [habilitando el tracing](/es/concepts/key-terms/tracing/). También puedes recopilar y analizar perfiles de rendimiento de usuarios reales con [profiling](/es/product/explore/profiling/).

Selecciona qué funciones de Sentry quieres instalar, además del monitoreo de errores, para obtener a continuación las instrucciones de instalación y configuración correspondientes.

<OnboardingOptionButtons
  options={[
'error-monitoring',
'performance',
'profiling',
]}
/>

```python
from sanic import Sanic
import sentry_sdk
from sentry_sdk.integrations.asyncio import AsyncioIntegration

app = Sanic(__main__)

@app.listener("before_server_start")
async def init_sentry(_):
    sentry_sdk.init(
        dsn="___PUBLIC_DSN___",
        # Agrega datos como encabezados de la solicitud e IP de los usuarios;
        # consulta https://docs.sentry.io/platforms/python/data-management/data-collected/ para obtener más información
        send_default_pii=True,
        # ___PRODUCT_OPTION_START___ performance
        # Establece traces_sample_rate en 1.0 para capturar el 100 %
        # de las transacciones para el rastreo.
        traces_sample_rate=1.0,
        # ___PRODUCT_OPTION_END___ performance
        # ___PRODUCT_OPTION_START___ profiling
        # Para recopilar perfiles de todas las sesiones de perfil,
        # establece `profile_session_sample_rate` en 1.0.
        profile_session_sample_rate=1.0,
        # Los perfiles se recopilarán automáticamente mientras
        # haya un span activo.
        profile_lifecycle="trace",
        # ___PRODUCT_OPTION_END___ profiling
        integrations=[AsyncioIntegration()],
    )
```

<div id="configuration-options">
  ### Opciones de configuración
</div>

Si usas tracing, puedes configurar la integración de Sanic para que no envíe transacciones de solicitudes que hayan devuelto ciertos códigos de estado HTTP mediante la opción `unsampled_statuses`.

De forma predeterminada, la integración de Sanic genera transacciones para todas las solicitudes, excepto aquellas que devuelven un estado HTTP 404. Para generar transacciones para todos los códigos de estado HTTP, incluido el 404, o cambiar qué códigos de estado HTTP no generan transacciones, puedes instanciar manualmente la integración de Sanic al inicializar el SDK de Sentry, así:

```python
from sanic import Sanic
import sentry_sdk
from sentry_sdk.integrations.asyncio import AsyncioIntegration
from sentry_sdk.integrations.sanic import SanicIntegration

@app.listener("before_server_start")
async def init_sentry(_):
    sentry_sdk.init(
        # ...
        integrations=[
            AsyncioIntegration(),
            SanicIntegration(
                # Configura la integración de Sanic para que generemos
                # transacciones para todos los códigos de estado HTTP, incluido el 404
                unsampled_statuses=None,
            ),
        ],
    )
```

Para especificar un conjunto diferente de códigos de estado HTTP para los que no se deben generar transacciones, establece `unsampled_statuses` en un conjunto que contenga los códigos de estado que no generan transacciones. Por ejemplo, si deseas que no se generen transacciones para solicitudes que resulten en un código de estado HTTP 200 o 404, usa `SanicIntegration(unsampled_statuses={200, 404})`.

<div id="verify">
  ## Verifica
</div>

```python
from sanic import Sanic
from sanic.response import text
import sentry_sdk
from sentry_sdk.integrations.asyncio import AsyncioIntegration

app = Sanic(__name__)

@app.listener("before_server_start")
async def init_sentry(_):
    sentry_sdk.init(...)  # igual que arriba

@app.get("/")
async def hello_world(request):
    1 / 0  # lanza un error
    return text("Hola, mundo.")`
```

Cuando abras en tu navegador [http://localhost:8000/](http://localhost:8000/), se enviará un evento de error a [sentry.io](https://sentry.io).

<div id="behavior">
  ## Comportamiento
</div>

* El SDK de Sentry para Python instalará la integración de Sanic para todas tus aplicaciones.

* Se informan todas las excepciones que producen un error interno del servidor.

* Los datos de la solicitud se adjuntan a todos los eventos: **método HTTP, URL, encabezados, datos de formulario, cargas JSON**. Sentry excluye los cuerpos sin procesar y las cargas de archivos multiparte. Sentry también excluye información de identificación personal (como IDs de usuario, nombres de usuario, cookies, encabezados de autorización y direcciones IP) a menos que establezcas `send_default_pii` en `True`.

* Cada solicitud tiene un ámbito independiente. Los cambios en el ámbito dentro de una vista, por ejemplo, al establecer una etiqueta, solo se aplicarán a los eventos enviados como parte de la solicitud que se está procesando.

* Registrar con cualquier logger creará breadcrumbs cuando la integración de
  [Logging](/es/platforms/python/integrations/logging/)
  esté habilitada (activada por defecto).

<div id="supported-versions">
  ## Versiones compatibles
</div>

* Sanic: 0.8+
* Python: 3.6+ (Sanic 0.8+), 3.7+ (Sanic 21.0+)