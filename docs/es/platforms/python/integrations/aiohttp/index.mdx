---
title: AIOHTTP
description: "Aprende a usar Sentry con AIOHTTP."
---

La integración de AIOHTTP añade compatibilidad con el [framework web de servidor AIOHTTP](https://docs.aiohttp.org/en/stable/web.html).

Si usas AIOHTTP como cliente HTTP y quieres instrumentar las solicitudes HTTP salientes, consulta la <PlatformLink to="/integrations/aiohttp/aiohttp-client/">documentación del cliente de AIOHTTP</PlatformLink>.

<div id="install">
  ## Instalar
</div>

Instala `sentry-sdk` desde PyPI con el extra `aiohttp`:

```bash {tabTitle:pip}
pip install "sentry-sdk[aiohttp]"
```

```bash {tabTitle:uv}
uv add "sentry-sdk[aiohttp]"
```

Si usas Python 3.6, también necesitas el paquete `aiocontextvars`:

```bash {tabTitle:pip}
pip install "aiocontextvars"
```

```bash {tabTitle:uv}
uv add "aiocontextvars"
```

<div id="configure">
  ## Configuración
</div>

Si tienes el paquete `aiohttp` en tus dependencias, la integración de AIOHTTP se habilitará automáticamente al inicializar el SDK de Sentry.

<PlatformContent includePath="getting-started-config" />

<div id="verify">
  ## Verifica
</div>

```python
from aiohttp import web

sentry_sdk.init(...)  # igual que arriba

async def hello(request):
    1 / 0  # lanza un error
    return web.Response(text="Hola, mundo")

app = web.Application()
app.add_routes([web.get('/', hello)])

web.run_app(app)
```

Cuando accedas a [http://localhost:8080/](http://localhost:8080/), se creará una transacción en la sección Performance de [sentry.io](https://sentry.io). Además, se enviará un evento de error a [sentry.io](https://sentry.io) que quedará vinculado a la transacción.

Los datos pueden tardar unos instantes en aparecer en [sentry.io](https://sentry.io).

<div id="behavior">
  ## Comportamiento
</div>

* El SDK de Sentry para Python instalará la integración de AIOHTTP para todas tus aplicaciones.
* Se informan todas las excepciones que provocan un error interno del servidor.
* *La integración de AIOHTTP actualmente no adjunta el cuerpo de la solicitud*; consulta el [issue en GitHub](https://github.com/getsentry/sentry-python/issues/220).
* Registrar con cualquier logger generará breadcrumbs cuando la integración de [Logging](/es/platforms/python/integrations/logging/) esté habilitada (activada por defecto).

<div id="options">
  ## Opciones
</div>

Al agregar `AioHttpIntegration` explícitamente a la llamada `sentry_sdk.init()`, puedes establecer opciones para `AioHttpIntegration` y así modificar su comportamiento:

```python
import sentry_sdk
from sentry_sdk.integrations.aiohttp import AioHttpIntegration

sentry_sdk.init(
    # mismo que arriba
    integrations=[
        AioHttpIntegration(
            transaction_style="...",  # type: str
            failed_request_status_codes={...}  # type: collections.abc.Set[int]
        ),
    ],
)
```

Puedes pasar los siguientes argumentos con nombre a `AioHttpIntegration()`:

<div id="transaction_style">
  ### `transaction_style`
</div>

Configura cómo Sentry asigna nombres a las transacciones:

* `GET /path/{id}` si configuras `transaction_style="method_and_path_pattern"`
* `<module_name>.hello` si configuras `transaction_style="handler_name"`

El valor predeterminado es `"handler_name"`.

<div id="failed_request_status_codes">
  ### `failed_request_status_codes`
</div>

Un `set` de enteros que determina cuándo se debe informar una `HTTPException` a Sentry. La `HTTPException` se informa a Sentry si su código de estado está incluido en el `set` `failed_request_status_codes`.

Ejemplos de `failed_request_status_codes` válidos:

* `{500}` solo informará `HTTPException` con estado 500 (es decir, `HTTPInternalServerError`).
* `{400, *range(500, 600)}` informará `HTTPException` con estado 400 (es decir, `HTTPBadRequest`) así como las del rango 5xx.
* `set()` (el conjunto vacío) no informará ninguna `HTTPException` a Sentry.

El valor predeterminado es `{*range(500, 600)}`, lo que significa que cualquier `HTTPException` con un estado en el rango 5xx se informará a Sentry.

Independientemente de cómo se configure `failed_request_status_codes`, cualquier excepción generada por el controlador que no sea de tipo `HTTPException` (o una subclase) se informará a Sentry. Por ejemplo, si tu controlador de solicitudes lanza un `AttributeError` no controlado, el `AttributeError` se informará a Sentry, incluso si has configurado `failed_request_status_codes=set()`.

<div id="supported-versions">
  ## Versiones compatibles
</div>

* AIOHTTP: 3.5+
* Python: 3.7+