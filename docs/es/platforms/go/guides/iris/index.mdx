---
title: Iris
description: "Iris es un framework web rápido y completo para Go. Aprende a configurarlo con Sentry."
---

Como referencia rápida, hay un [ejemplo completo](https://github.com/getsentry/sentry-go/tree/master/_examples/iris) en el repositorio del código fuente del SDK de Go.

La [documentación de la API al estilo Go Dev](https://pkg.go.dev/github.com/getsentry/sentry-go/iris) también está disponible.

<div id="install">
  ## Instalación
</div>

```bash
go get github.com/getsentry/sentry-go
go get github.com/getsentry/sentry-go/iris
```

<Break />


<div id="configure">
  ## Configuración
</div>

<div id="initialize-the-sentry-sdk">
  ### Inicializa el SDK de Sentry
</div>

<PlatformContent includePath="getting-started-config" />

<div id="options">
  ### Opciones
</div>

`sentryiris` acepta una estructura `Options` que te permite configurar el comportamiento del controlador.

```go
// Si Sentry debe volver a generar pánico tras la recuperación; en la mayoría de los casos debería establecerse en true,
// ya que iris.Default incluye su propio middleware Recovery que gestiona las respuestas HTTP.
Repanic bool
// Si quieres bloquear la solicitud antes de continuar con la respuesta.
// Como el controlador `Recovery` predeterminado de Iris no reinicia la aplicación,
// es seguro omitir esta opción o establecerla en `false`.
WaitForDelivery bool
// Tiempo de espera para las solicitudes de envío de eventos.
Timeout time.Duration
```

<Break />

```go
app := iris.Default()
app.Use(sentryiris.New(sentryiris.Options{
    // modifica tu propia configuración
    Repanic:         true,
    WaitForDelivery: false,
    Timeout:         5 * time.Second,
}))
```


<div id="verify">
  ## Verifica
</div>

```go
// Crea tu app
app := iris.Default()

// Cuando esté listo, puedes añadir el handler como uno de tus middleware
app.Use(sentryiris.New(sentryiris.Options{
// especifica las opciones aquí...
}))

// Configura las rutas
app.Get("/", func(ctx iris.Context) {
	// capturando un error intencionalmente para simular el uso
	sentry.CaptureMessage("¡Funciona!")
	
	ctx.Writef("¡Hola, mundo!")
})

// Y ejecútala
app.Run(iris.Addr(":3000"))
```


<div id="usage">
  ## Uso
</div>

`sentryiris` adjunta una instancia de `*sentry.Hub` (https://pkg.go.dev/github.com/getsentry/sentry-go#Hub) a `iris.Context`, lo que la hace disponible durante el resto del ciclo de vida de la solicitud.
Puedes acceder a ella usando el método `sentryiris.GetHubFromContext()` en el propio contexto, en cualquiera de tus middlewares y rutas posteriores.
Debe usarse en lugar de las llamadas globales `sentry.CaptureMessage`, `sentry.CaptureException` u otras, ya que mantiene separada la información entre solicitudes.

**¡Ten en cuenta que `*sentry.Hub` no estará disponible en middlewares adjuntos antes de `sentryiris`!**

```go
app := iris.Default()

app.Use(sentryiris.New(sentryiris.Options{
	Repanic: true,
}))

app.Use(func(ctx iris.Context) {
	if hub := sentryiris.GetHubFromContext(ctx); hub != nil {
		hub.Scope().SetTag("someRandomTag", "quizáLoNecesites")
	}
	ctx.Next()
})

app.Get("/", func(ctx iris.Context) {
	if hub := sentryiris.GetHubFromContext(ctx); hub != nil {
		hub.WithScope(func(scope *sentry.Scope) {
			scope.SetExtra("unwantedQuery", "algúnDatoDeConsultaTalVez")
			hub.CaptureMessage("El usuario proporcionó una cadena de consulta no deseada, pero nos recuperamos sin problemas")
		})
	}
})

app.Get("/foo", func(ctx iris.Context) {
	// el handler de sentryiris lo capturará sin problemas. Además, como adjuntamos "someRandomTag"
	// en el middleware antes, también se enviará
	panic("¿por qué tho?")
})

app.Run(iris.Addr(":3000"))
```


<div id="accessing-request-in-beforesend-callback">
  ### Acceder a la solicitud en el callback `BeforeSend`
</div>

```go
sentry.Init(sentry.ClientOptions{
	Dsn: "___PUBLIC_DSN___",
	BeforeSend: func(event *sentry.Event, hint *sentry.EventHint) *sentry.Event {
		if hint.Context != nil {
			if req, ok := hint.Context.Value(sentry.RequestContextKey).(*http.Request); ok {
				// Aquí tienes acceso a la solicitud Request original
			}
		}

		return event
	},
})
```
