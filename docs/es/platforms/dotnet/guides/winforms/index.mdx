---
title: Windows Forms
description: Aprende cómo funciona el SDK de .NET de Sentry con aplicaciones de WinForms.
og_image: /og-images/platforms-dotnet-guides-winforms.png
---

El SDK de .NET de Sentry funciona con aplicaciones de WinForms a través del [paquete Sentry en NuGet](https://www.nuget.org/packages/Sentry). Es compatible con aplicaciones de WinForms que se ejecutan en .NET Framework 4.6.2, .NET Core 3.0 o versiones posteriores.

<div id="features">
  ## Funcionalidades
</div>

Además de capturar errores, puedes supervisar las interacciones entre varios servicios o aplicaciones si [habilitas el tracing](/es/concepts/key-terms/tracing/).

Selecciona qué funcionalidades de Sentry deseas instalar, además del monitoreo de errores, para obtener a continuación las instrucciones correspondientes de instalación y configuración.

<div id="install">
  ## Instalación
</div>

<OnboardingOptionButtons options={['error-monitoring', 'performance']} />

<PlatformContent includePath="getting-started-install" />

<div id="configure">
  ## Configuración
</div>

Después de agregar el paquete NuGet, el SDK debe inicializarse en el punto de entrada principal del programa, antes de iniciar cualquier formulario o realizar trabajo importante. Las opciones de inicialización varían según el lenguaje.

<div id="c-initialization">
  ### Inicialización de C#
</div>

Una aplicación de Windows Forms en C# tendrá un archivo `Program.cs`. Debes inicializar Sentry en ese archivo.

También debes configurar `Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException)` para que Sentry pueda capturar excepciones no controladas.

A continuación se muestra un ejemplo completo del inicio recomendado:

```csharp
using System;
using System.Windows.Forms;

namespace WindowsFormsApp1
{
    static class Program
    {
        /// <summary>
        /// Punto de entrada principal de la aplicación.
        /// </summary>
        [STAThread]
        static void Main()
        {

            // Estas opciones de WinForms suelen estar habilitadas por defecto
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            // Agrega esto para que Sentry pueda detectar excepciones no controladas
            Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException);

            // Configura las opciones de Sentry
            var sentryOptions = new SentryOptions
            {
                // Indica a qué proyecto de Sentry se enviarán los eventos:
                Dsn = "___PUBLIC_DSN___",

                // Al configurarlo por primera vez, para ver qué hace el SDK:
                Debug = true,

                // Agrega la URL y los encabezados de la solicitud, la IP y el nombre de los usuarios, etc.
                options.SendDefaultPii = true;

                // ___PRODUCT_OPTION_START___ performance
                // Establece traces_sample_rate en 1.0 para capturar el 100 % de las transacciones para el trazado.
                // Recomendamos ajustar este valor en producción.
                TracesSampleRate = 1.0,

                // ___PRODUCT_OPTION_END___ performance
                // Habilita el modo global dado que esta es una aplicación cliente
                IsGlobalModeEnabled = true,

                // TODO: cualquier otra opción que necesites va aquí
            };

            // Inicializa Sentry y ejecuta el formulario principal de la aplicación
            using (SentrySdk.Init(sentryOptions))
            {
                Application.Run(new YourMainApplicationForm());
            }
        }
    }
}
```

<div id="visual-basic-initialization">
  ### Inicialización en Visual Basic
</div>

Las aplicaciones de Windows Forms escritas en VB tienen dos opciones de inicialización. Elige una (no ambas).

<div id="option-1">
  #### Opción 1
</div>

Puedes inicializar Sentry de forma similar a como se muestra arriba para C#.

Primero, modifica la configuración en la página de propiedades del proyecto de la siguiente manera:

* Desmarca la casilla &quot;Enable application framework&quot;.
* Establece &quot;Startup object&quot; en &quot;Sub Main&quot;.

![Propiedades del proyecto de VB](./img/vbsettings1.png)

Luego, agrega el siguiente archivo como `Program.vb`:

```vb
Imports Sentry

Module Program

    ''' <summary>
    ''' Punto de entrada principal de la aplicación.
    ''' </summary>
    <STAThread>
    Sub Main()

        ' Estas opciones de WinForms suelen estar activadas por defecto
        Application.EnableVisualStyles()
        Application.SetCompatibleTextRenderingDefault(False)

        ' Agrega esto para que Sentry pueda capturar excepciones no controladas
        Application.SetUnhandledExceptionMode(UnhandledExceptionMode.ThrowException)

        ' Configura las opciones de Sentry
        Dim sentryOptions = New SentryOptions With
        {
            .Dsn = "___PUBLIC_DSN___",

            ' Agrega la URL y los encabezados de la solicitud, IP y nombre de los usuarios, etc.
            .SendDefaultPii = True,

            ' Habilita el modo global, ya que se trata de una aplicación cliente
            .IsGlobalModeEnabled = True,

            ' aquí van cualesquiera otras opciones que necesites
        }

        ' Inicializa Sentry y ejecuta el formulario principal de la aplicación
        Using SentrySdk.Init(sentryOptions)
            Application.Run(New YourMainApplicationForm)
        End Using
    End Sub

End Module
```

<div id="option-2">
  #### Opción 2
</div>

Si prefieres mantener habilitada la característica de WinForms &quot;Application Framework&quot;, puedes inicializar Sentry en &quot;Application Events&quot;.

Primero, asegúrate de que la configuración en la página de propiedades del proyecto sea la siguiente:

* La casilla &quot;Enable application framework&quot; debe estar marcada.
* &quot;Startup object&quot; debe establecerse en el nombre de tu formulario principal.

![Propiedades del proyecto VB](./img/vbsettings2.png)

A continuación, deberás modificar el archivo `ApplicationEvents.vb`.

* Si estás usando .NET Framework, al hacer clic en el botón &quot;View Application Events&quot; se creará y abrirá el archivo `ApplicationEvents.vb`.
* Si estás usando .NET Core, tendrás que agregar el archivo manualmente.
* Si estás usando .NET 5 o superior, el archivo ya debería estar presente. Si no, puedes agregarlo manualmente.

Una vez creado el archivo:

* Inicializa Sentry en el evento `Startup` y conserva el resultado.
* Libera Sentry en el evento `Shutdown`, usando el resultado de la inicialización.
* Usa el evento `UnhandledException` para enviar excepciones no controladas a Sentry.

Consulta el siguiente ejemplo completo:

```vb
Imports Microsoft.VisualBasic.ApplicationServices
Imports Sentry
Imports Sentry.Protocol

Namespace My
    Partial Friend Class MyApplication

        Private _sentry As IDisposable

        Private Sub MyApplication_Startup(sender As Object, e As StartupEventArgs) Handles Me.Startup

            ' Configura las opciones de Sentry
            Dim sentryOptions = New SentryOptions With
            {
                .Dsn = "___PUBLIC_DSN___",

                ' Incluye la URL y los encabezados de la solicitud, la IP y el nombre de los usuarios, etc.
                .SendDefaultPii = True,

                ' Activa el modo global, ya que esta es una aplicación cliente
                .IsGlobalModeEnabled = True,

                ' aquí van cualquier otra opción que necesites
            }

            ' Inicializa Sentry
            _sentry = SentrySdk.Init(sentryOptions)

        End Sub

        Private Sub MyApplication_Shutdown(sender As Object, e As EventArgs) Handles Me.Shutdown

            ' Libera el SDK de Sentry para asegurarte de que los eventos se vacíen y se envíen a Sentry
            _sentry.Dispose()

        End Sub

        Private Sub MyApplication_UnhandledException(sender As Object, e As UnhandledExceptionEventArgs) Handles Me.UnhandledException

            ' Añade datos adicionales a la excepción para que Sentry la reconozca como no controlada
            Dim ex = e.Exception
            ex.Data(Mechanism.HandledKey) = False
            ex.Data(Mechanism.MechanismKey) = "WindowsFormsApplicationBase.UnhandledException"

            ' Captura la excepción con Sentry
            SentrySdk.CaptureException(ex)

        End Sub

    End Class
End Namespace
```

<div id="verify">
  ## Verificación
</div>

Este fragmento incluye un error intencional para que puedas comprobar que todo funciona en cuanto lo configures.

<PlatformContent includePath="getting-started-verify" />

<div id="resources">
  ## Recursos
</div>

[Debate en GitHub sobre `Application.SetUnhandledExceptionMode`](https://github.com/getsentry/sentry-dotnet/issues/176)