---
title: Límite de error de React
excerpt: ''
description: >-
  Aprende cómo el SDK de React Native exporta un componente límite de error
  que aprovecha las API de componentes de React.
sidebar_order: 60
og_image: /og-images/platforms-react-native-integrations-error-boundary.png
---

El SDK de React Native exporta un componente límite de error que usa las [API de componentes de React](https://react.dev/reference/react/Component#catching-rendering-errors-with-an-error-boundary) para detectar y enviar automáticamente errores de JavaScript desde un árbol de componentes de React a Sentry.

<div id="prerequisites">
  ## Requisitos previos
</div>

Para usar el componente Error Boundary, debes tener el SDK de React Native [instalado y configurado para el monitoreo de errores](/es/platforms/react-native/).

<div id="use-sentryerrorboundary">
  ## Usa `Sentry.ErrorBoundary`
</div>

```javascript
import React from "react";
import * as Sentry from "@sentry/react-native";

<Sentry.ErrorBoundary fallback={<p>Ocurrió un error</p>}}>
  <Example />
</Sentry.ErrorBoundary>;
```

El límite de errores de Sentry también está disponible como un componente de orden superior.

```javascript
import React from "react";
import * as Sentry from "@sentry/react-native";

Sentry.withErrorBoundary(Example, { fallback: <p>Se ha producido un error</p> });
```

<Alert level="warning" title="Nota">
  En modo desarrollo, React volverá a relanzar los errores capturados dentro de un error boundary al manejador global de errores. Esto hará que Sentry solo informe un error desde el manejador global de errores y no desde el propio error boundary. Recomendamos probar el error boundary con una compilación de producción de React.
</Alert>

En el ejemplo siguiente, cuando el componente `<Example />` produzca un error, el componente `<Sentry.ErrorBoundary>` enviará a Sentry datos sobre ese error y el árbol de componentes, abrirá un cuadro de diálogo de comentarios de usuario y mostrará una interfaz de reserva.

```javascript
import React from "react";
import * as Sentry from "@sentry/react-native";

import { Example } from "../example";

function FallbackComponent() {
  return <div>Ha ocurrido un error</div>;
}

const myFallback = <FallbackComponent />;
// Como alternativa:
// const myFallback = () => <FallbackComponent />;

class App extends React.Component {
  render() {
    return (
      <Sentry.ErrorBoundary fallback={myFallback} showDialog>
        <Example />
      </Sentry.ErrorBoundary>
    );
  }
}

export default App;
```

<Alert level="warning" title="Nota">
  De forma predeterminada, React [registra todos los errores en la consola](https://github.com/facebook/react/blob/493f72b0a7111b601c16b8ad8bc2649d82c184a0/packages/react-reconciler/src/ReactFiberErrorLogger.js#L85), incluso si estás usando un error boundary de React. Si usas la integración `CaptureConsole`, Sentry capturará el error allí y no a través del error boundary.
</Alert>

<div id="linked-errors">
  ## Errores enlazados
</div>

En [React v17 y posteriores](https://reactjs.org/blog/2020/08/10/react-v17-rc.html#native-component-stacks), el SDK analizará automáticamente el `componentStack` del [error boundary](https://react.dev/reference/react/Component#componentdidcatch-parameters) y adjuntará la traza completa de la pila al evento mediante `error.cause`. Esto requiere tener habilitada la integración `nativeLinkedErrorsIntegration` (está activada de forma predeterminada). Para obtener el contexto completo del código fuente, te recomendamos configurar los [mapas de origen](/es/platforms/react-native/sourcemaps/) en tu proyecto.

![Traza de pila de React Error Boundary](./img/errorboundary-error.png)

<div id="options">
  ## Opciones
</div>

El componente ErrorBoundary expone varias props que se pueden pasar para una configuración adicional. No hay opciones obligatorias, pero recomendamos encarecidamente definir un componente de reserva.

`fallback` (React.ReactNode o Function)

Un elemento de React que se renderiza cuando el error boundary captura un error. Puede ser un elemento de React (por ejemplo, `<Fallback />`) o una función que devuelva un elemento de React. Si proporcionas una función, Sentry la llamará con información adicional y utilidades (consulta el ejemplo a continuación).

`onError` (Function)

Una función que se ejecuta cuando el ErrorBoundary encuentra un error. `onError` es útil si quieres propagar el error a una biblioteca de gestión de estado como Redux o si quieres comprobar efectos secundarios que podrían haberse producido debido al error.

`onMount` (Function)

Una función que se ejecuta en `componentDidMount()` de ErrorBoundary.

`onUnmount` (Function)

Una función que se ejecuta en `componentWillUnmount()` de ErrorBoundary.

`beforeCapture` (Function)

Una función que se ejecuta antes de enviar un error a Sentry, lo que permite añadir etiquetas o contexto adicionales al error.

<div id="examples">
  ## Ejemplos
</div>

<div id="setting-a-fallback-function-render-props">
  ### Configurar una función de respaldo (render props)
</div>

A continuación se muestra un ejemplo en el que se utiliza una prop de respaldo, siguiendo el [enfoque de render props](https://react.dev/reference/react/cloneElement#passing-data-with-a-render-prop), para mostrar una interfaz de respaldo cuando ocurre un error. La interfaz de respaldo vuelve al estado estándar del componente al restablecerse con la API `resetError()`, proporcionada por el componente mediante render props.

```javascript
import React from "react";
import { Button, Text } from "react-native"
import * as Sentry from "@sentry/react-native";

class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      message: "Esta es mi app",
    };
  }

  render() {
    return (
      <Sentry.ErrorBoundary
        fallback={({ error, componentStack, resetError }) => (
          <React.Fragment>
            <Text>Se produjo un error</Text>
            <Text>{error.toString()}</Text>
            <Text>{componentStack}</Text>
            <Button
              title="Haz clic aquí para restablecer"
              onPress={() => {
                this.setState({ message: "Esta es mi app" });
                // Cuando se llama a resetError(),
                // se elimina el componente de respaldo (Fallback) y se renderizan
                // los hijos de Sentry ErrorBoundary
                // en su estado inicial
                resetError();
              }}
            />
          </React.Fragment>
        )}
      >
        <Text>{this.state.message}</Text>
        {/* al hacer clic, este botón establece un objeto */}
        {/* como mensaje, no una cadena. Lo cual provocará */}
        {/* un error en el árbol de componentes */}
        <Button
          title="Haz clic aquí para cambiar el mensaje"
          onPress={() => this.setState({ message: { text: "Hola mundo" } })}
        />
      </Sentry.ErrorBoundary>
    );
  }
}

export default MyComponent;
```

<div id="using-multiple-error-boundaries">
  ### Uso de varios límites de error
</div>

Cuando utilices varios límites de error, recomendamos usar `beforeCapture` para establecer etiquetas y contexto, de modo que puedas identificar en cuál límite de error se produjo el problema. En el ejemplo siguiente, añadimos etiquetas a los errores según la ruta en la que se renderizaron:

```javascript
import React from "react";
import { View, Text } from "react-native"
import * as Sentry from "@sentry/react-native";

function MyComponent({ props }) {
  return (
    <React.Fragment>
      <Sentry.ErrorBoundary
        beforeCapture={(scope) => {
          scope.setTag("location", "first");
          scope.setTag("anotherTag", "anotherValue");
        }}
      >
        <View><Text>Primera</Text></View>
      </Sentry.ErrorBoundary>
      <Sentry.ErrorBoundary
        beforeCapture={(scope) => {
          scope.setTag("location", "second");
        }}
      >
        <View><Text>Segunda</Text></View>
      </Sentry.ErrorBoundary>
    </React.Fragment>
  );
}

export default MyComponent;
```
