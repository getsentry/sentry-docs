---
title: Metro
description: "Conoce el empaquetador Metro y cómo configurarlo para tu aplicación con el SDK de Sentry para React Native."
sidebar_order: 3
---

El paquete del SDK de Sentry para React Native incluye un complemento de Metro que te permite generar automáticamente Debug IDs para los paquetes (bundles) de tus aplicaciones. Esto es fundamental para que los mapas de origen (source maps) funcionen correctamente con Sentry. El complemento también te ayuda a anotar los nombres de los componentes de React para que estén disponibles en los breadcrumbs y a reducir el tamaño del bundle eliminando funciones del SDK que no se usan.
Esta página te guiará en el proceso de configuración del complemento de Metro para tu aplicación.

<div id="prerequisities">
  ## Requisitos previos
</div>

* [Crea una cuenta](https://sentry.io/signup/)
* [Instala el SDK de Sentry para React Native](/es/platforms/react-native) versión 5.17.0 o posterior
  * Expo es compatible a partir de la versión 5.16.0-alpha.1 del SDK

<div id="configuration">
  ## Configuración
</div>

El SDK de Sentry para React Native ofrece varias formas de configurar el complemento de Metro de Sentry, según cómo estés usando actualmente la configuración de Metro.

<div id="use-the-sentry-metro-plugin">
  ### Usa el complemento Sentry Metro
</div>

El siguiente ejemplo muestra cómo usar el complemento Sentry Metro con la configuración predeterminada.

```javascript {tabTitle:React Native} {filename:metro.config.js}
const { getDefaultConfig } = require("@react-native/metro-config");
const { withSentryConfig } = require('@sentry/react-native/metro');

const config = getDefaultConfig(__dirname);
module.exports = withSentryConfig(config);
```

```javascript {tabTitle:Expo} {filename:metro.config.js}
// const { getDefaultConfig } = require("expo/metro-config");
const { getSentryExpoConfig } = require("@sentry/react-native/metro");

// const config = getDefaultConfig(__dirname);
const config = getSentryExpoConfig(__dirname);
```

<div id="add-a-custom-babel-transformer">
  ### Agrega un transformador de Babel personalizado
</div>

Si ya cuentas con un transformador personalizado, asegúrate de aplicar el Sentry Metro Plugin como último paso. El Sentry Metro Plugin no sobrescribe la configuración existente; la amplía o envuelve las propiedades existentes.

```javascript {tabTitle:React Native} {filename:metro.config.js}
const { getDefaultConfig } = require("@react-native/metro-config");
const { withSentryConfig } = require('@sentry/react-native/metro');

const config = getDefaultConfig(__dirname);

config.transformer = {
  ...config.transformer,
  babelTransformerPath: require.resolve('react-native-custom-transformer'),
};

module.exports = withSentryConfig(config);
```

```javascript {tabTitle:Expo} {filename:metro.config.js}
const { getDefaultConfig } = require('@expo/metro-config');
const { getSentryExpoConfig } = require('@sentry/react-native/metro');

const config = getSentryExpoConfig(__dirname, {
  getDefaultConfig: (projectRoot, options) => {
    const config = getDefaultConfig(projectRoot, options);

    config.transformer = {
      ...config.transformer,
      babelTransformerPath: require.resolve('react-native-custom-transformer/expo'),
    };
    return config;
  },
});
```

<div id="wrap-your-custom-serializer">
  ### Envuelve tu serializador personalizado
</div>

Si ya cuentas con un serializador personalizado, puedes envolverlo con Sentry Metro Serializer y llamar a `options.sentryBundleCallback` antes de serializar el contenido del bundle.

```javascript {tabTitle:React Native} {filename:metro.config.js}
const { getDefaultConfig, mergeConfig } = require("@react-native/metro-config");
const { withSentryConfig } = require('@sentry/react-native/metro');

const myCustomSerializer = (entryPoint, preModules, graph, options) => {
  let bundle = prepareBundle(entryPoint, preModules, graph, options);
  if (options.sentryBundleCallback) {
    // El callback agrega el módulo de IDs de depuración de Sentry al bundle
    bundle = options.sentryBundleCallback(bundle);
  }
  const code = createCode(bundle);
  const map = createSourceMap();
  return { code, map };
};

const config = {
  serializer: {
    customSerializer: myCustomSerializer,
  },
};

module.exports = withSentryConfig(mergeConfig(getDefaultConfig(__dirname), config));
```

Estructura intermedia esperada del paquete:

```typescript
export type Bundle = {
  modules: Array<[id: number, code: string]>;
  post: string;
  pre: string;
};
```

<div id="troubleshooting">
  ## Solución de problemas
</div>

* Sentry Metro Serializer no puede agregar el Debug ID a los Hermes Composed Source Maps. Consulta la guía [Manual Upload With Hermes](/es/platforms/react-native/sourcemaps#manual-upload-with-hermes) para saber cómo agregar el Debug ID a los Hermes Composed Source Maps.
* Si ves el mensaje de error `Debug ID was not found in the bundle.`, significa que `sentryBundleCallback` no fue llamado por tu serializador personalizado.
* Si falta la configuración de Metro en tu proyecto de Expo, créala con `npx expo customize metro.config.js`. Lee más sobre [Customizing Expo Metro Configuration](https://docs.expo.dev/guides/customizing-metro/).