---
title: Guía de migración
sidebar_order: 8000
description: "Migra entre versiones del SDK de Sentry para Dart."
---

<div id="migrating-from-sentry-8x-to-sentry-9x">
  ## Migrar de `sentry` `8.x` a `sentry` `9.x`
</div>

<div id="dart-version">
  #### Versión de Dart
</div>

La versión mínima de Dart requerida ahora es `3.5.0`. 
Este cambio nos permite usar API más seguras y ofrecer mejor compatibilidad con funciones como la compilación a WASM.

<div id="api-removals-and-renames">
  #### Eliminaciones y cambios de nombre en la API
</div>

- `LoadImagesListIntegration` pasó a llamarse `LoadNativeDebugImagesIntegration`.
- Se eliminó la opción `enableTracing`. Usa `options.traceSampleRate` o `options.tracesSampler` en su lugar.
- `BeforeSendTransactionCallback` ahora recibe un parámetro `Hint`.
- Se dejó de usar `dart:html` en favor de `package:web`. El SDK ahora se distribuye con la dependencia `package:web` para una mejor interoperabilidad con las API web.
- Se eliminó el campo `segment` de `SentryUser`.
- La API anterior de comentarios de usuario se eliminó y fue reemplazada por `Sentry.captureFeedback`.

<div id="logging">
  #### Registro
</div>

El nivel de registro predeterminado ahora es `warning` cuando `debug = true`. 
Puedes ajustarlo estableciendo `options.diagnosticLevel = SentryLevel.info` en `Sentry.init`.

<div id="sdk-data-classes">
  #### Clases de datos del SDK
</div>

Las clases de datos del SDK ahora son mutables, lo que facilita su manipulación.
Por compatibilidad con versiones anteriores, `copyWith` y `clone` aún se pueden usar, pero están oficialmente obsoletos.

```dart
// antiguo
options.beforeSend = (event, hint) {
  event = event.copyWith(release: 'my-release')
  return event
}

// nuevo
options.beforeSend = (event, hint) {
  event.release = 'my-release'
  return event
}
```


<div id="response-body-handling">
  #### Manejo del cuerpo de la respuesta
</div>

Por motivos de PII, el SDK ya no añadirá automáticamente los cuerpos de respuesta a los eventos de Sentry. 
Ahora las respuestas se adjuntan al objeto `Hint`, que puede leerse en los callbacks `beforeSend`/`beforeSendTransaction` mediante `hint.response`, para que puedas adjuntar manualmente la respuesta a tu evento.
Los cuerpos de respuesta de más de 0.15 MB no se agregan al objeto `Hint`.
Actualmente, a partir de la versión `9.0.0`, solo se admite la integración con `dio`.

<div id="migrating-from-sentry-618x-to-sentry-700">
  ## Migración de `sentry` `6.18.x` a `sentry` `7.0.0`
</div>

Cambios en la API:

- Las versiones 7.0.0 y posteriores del SDK de Dart de Sentry requieren Dart `2.17.0`.
- El paquete `sentry_file` de Sentry en la versión 7.0.0 y posteriores requiere Dart `2.19.0`.
- Los métodos que antes aceptaban el parámetro opcional `dynamic hint` ahora aceptan `Hint? hint`.
- Se han eliminado los siguientes campos obsoletos de la clase `SentryDevice` y se han reemplazado:
  - `screenResolution`, reemplazado por `screenHeightPixels` y `screenWidthPixels`.
  - `timezone`, reemplazado por `SentryCulture#timezone`.
  - `language`, reemplazado por `SentryCulture#locale`.
  - `theme`, reemplazado por `SentryOperatingSystem#theme`.
- Se ha eliminado el siguiente campo obsoleto del databag `Contexts#dart_context` y se ha reemplazado:
  - `isolate`, reemplazado por `SentryThread#name`.
- Se han eliminado los siguientes campos de la clase `Scope` y se han reemplazado:
  - `user(SentryUser? user)`, reemplazado por `setUser(SentryUser? user)`.
  - `attachements`, reemplazado por `attachments`.
- Las clases o métodos que antes aceptaban los siguientes parámetros opcionales se han movido a la clase `SentryOptions` y se han reemplazado:
  - `captureFailedRequests`, reemplazado por `SentryOptions#captureFailedRequests`.
  - `sendDefaultPii`, reemplazado por `SentryOptions#sendDefaultPii`.
  - `maxRequestBodySize`, reemplazado por `SentryOptions#maxRequestBodySize`.
  - `networkTracing`, reemplazado por `SentryOptions#tracesSampleRate` o `SentryOptions#tracesSampler`.
  - `recordBreadcrumbs`, reemplazado por `SentryOptions#recordHttpBreadcrumbs`.
- Los siguientes `SentryMeasurementUnits` ahora son de tipo estricto:
  - `DurationSentryMeasurementUnit`
  - `InformationSentryMeasurementUnit`
  - `FractionSentryMeasurementUnit`
  - `CustomSentryMeasurementUnit`
  - `NoneSentryMeasurementUnit`

Cambios de comportamiento:

- Las versiones 7.0.0 y posteriores del SDK de Dart de Sentry son compatibles con Dart `3.0.0`.
- Cuando ocurre un error no controlado y hay una transacción en ejecución, el estado de la transacción se establecerá en `internal_error`.
- La función `captureFailedRequests` ahora está habilitada de forma predeterminada.
- La función `enableStructuredDataTracing` ahora está habilitada de forma predeterminada.
- La función `enableUserInteractionTracing` ahora está habilitada de forma predeterminada.

<div id="migrating-from-sentry-65x-to-sentry-66x">
  ## Migración de `sentry` `6.5.x` a `sentry` `6.6.x`
</div>

* `SentryOptions#sendClientReports` ahora está habilitado de forma predeterminada. Para deshabilitarlo, usa el siguiente fragmento de código:

```dart
import 'package:sentry/sentry.dart';

Future<void> main() async {
  await Sentry.init((options) => options.sendClientReports = false;
}
```

* El setter `Scope.user` quedó obsoleto en favor de `Scope.setUser`, y se eliminará en una actualización futura.

* El getter `Scope.attachements` quedó obsoleto en favor de `attachments`, y se eliminará en una actualización futura.

* Los siguientes métodos de `Scope` ahora devuelven `Future<void>` en lugar de `void`:
  * `setContexts`
  * `removeContexts`
  * `setUser`
  * `addBreadcrumb`
  * `clearBreadcrumbs`
  * `setExtra`
  * `removeExtra`
  * `setTag`
  * `removeTag`


### Compatibilidad con Sentry autohospedado

- A partir de la versión `6.6.0` de `sentry`, se requiere [Sentry versión >= v21.9.0](https://github.com/getsentry/self-hosted/releases) o deberás desactivar manualmente el envío de informes del cliente mediante la opción `sendClientReports`. Esto solo aplica a Sentry autohospedado. Si usas [sentry.io](https://sentry.io), no tienes que hacer nada.

<div id="migrating-from-sentry-51x-to-sentry-600">
  ## Migrating From `sentry` `5.1.x` to `sentry` `6.0.0`
</div>

- `Sentry.currentHub` fue eliminado. Usa los métodos estáticos de `Sentry`.
- `SentryOptions.cacheDirSize` se renombró a `SentryOptions.maxCacheItems`.
- `EventProcessor` pasó de ser un callback a ser una interfaz.
- El tipo de dato de las siguientes opciones cambió de `int` a `Duration`. Las opciones anteriores siguen presentes, pero están obsoletas y se eliminarán en una versión futura.
  - `SentryOptions.autoSessionTrackingIntervalMillis` a `SentryOptions.autoSessionTrackingInterval`
  - `SentryOptions.anrTimeoutIntervalMillis` a `SentryOptions.anrTimeoutInterval`
- El callback `beforeSend` ahora admite código asíncrono. La firma del método cambió de `SentryEvent? Function(SentryEvent event, {dynamic hint});` a `FutureOr<SentryEvent?> Function(SentryEvent event, {dynamic hint});`. Aunque técnicamente es un cambio con ruptura, probablemente tu código siga siendo válido.
- Sentry acepta múltiples excepciones y múltiples hilos. Si no has configurado excepciones, no necesitas hacer nada.

<div id="sentry-self-hosted-compatibility">
  ### Compatibilidad con Sentry autogestionado
</div>

- A partir de la versión `6.0.0` de `sentry`, se requiere [Sentry en la versión >= v20.6.0](https://github.com/getsentry/self-hosted/releases). Esto solo aplica a Sentry autogestionado. Si usas [sentry.io](https://sentry.io), no necesitas hacer nada.

<div id="migrating-from-sentry-40x-to-sentry-500">
  ## Migración de `sentry` `4.0.x` a `sentry` `5.0.0`
</div>

- El SDK de Dart de Sentry a partir de la versión 5.0.0 requiere Dart 1.12.0
- Corrección: prefijar clases con Sentry
  - Un par de clases entraban a menudo en conflicto con el código del usuario.
    Como resultado, este cambio renombra las siguientes clases:
    - `App` -> `SentryApp`
    - `Browser` -> `SentryBrowser`
    - `Device` -> `SentryDevice`
    - `Gpu` -> `SentryGpu`
    - `Integration` -> `SentryIntegration`
    - `Message` -> `SentryMessage`
    - `OperatingSystem` -> `SentryOperatingSystem`
    - `Orientation` -> `SentryOrientation`
    - `Request` -> `SentryRequest`
    - `User` -> `SentryUser`
- El tipo de retorno de `Sentry.close()` cambió de `void` a `Future<void>` y el de `Integration.close()` cambió de `void` a `FutureOr<void>`