---
title: Guía de migración
sidebar_order: 8000
---

<div id="migrating-from-sentry_flutter-8x-to-sentry_flutter-9x">
  ## Migración de `sentry_flutter` `8.x` a `sentry_flutter` `9.x`
</div>

<div id="general">
  ### General
</div>

<div id="dart-and-flutter-versions">
  #### Versiones de Dart y Flutter
</div>

Las versiones mínimas requeridas de Dart y Flutter ahora son `3.5.0` y `3.24.0`, respectivamente.
Este cambio nos permite usar API más seguras y brindar mejor compatibilidad con funciones como Session Replay y la compilación a WASM.

<div id="android-api-version">
  #### Versión de la API de Android
</div>

La versión mínima requerida de la API de Android ahora es la `21`.

<div id="api-removals-and-renames">
  #### Eliminaciones y cambios de nombre en la API
</div>

* El método `beforeScreenshot` se ha reemplazado por `beforeCaptureScreenshot`.
* Se eliminó la implementación manual de TTID, ya que la instrumentación automática de TTID ha demostrado ser suficientemente precisa, por lo que ya no se requiere una manual.
* `LoadImagesListIntegration` pasó a llamarse `LoadNativeDebugImagesIntegration`.
* Se eliminó la opción `enableTracing`. Usa `options.traceSampleRate` u `options.tracesSampler` en su lugar.
* Se eliminaron tanto `options.autoAppStart` como `setAppStartEnd`. La [instrumentación de inicio de la app](/es/platforms/dart/guides/flutter/integrations/app-start-instrumentation/) ahora determina el final del inicio de la app y está habilitada de forma predeterminada.
* Se dejó de usar `dart:html` en favor de `package:web`. El SDK ahora se distribuye con la dependencia `package:web` para una mejor interoperabilidad con las API web.
* El callback `beforeSendTransaction` ahora recibe un parámetro `Hint`.
* Se eliminó la opción `attachScreenshotOnlyWhenResumed`.
* Se eliminó el campo `segment` de `SentryUser`.
* La API anterior de comentarios de usuario se eliminó y se reemplazó por `Sentry.captureFeedback`.

<div id="response-body-handling">
  #### Manejo del cuerpo de la respuesta
</div>

Debido a preocupaciones sobre la PII, los cuerpos de respuesta ya no se agregarán automáticamente a los eventos de Sentry por el SDK.
Las respuestas ahora se adjuntan al objeto `Hint`, que puede leerse en los callbacks `beforeSend`/`beforeSendTransaction` mediante `hint.response`, para que puedas adjuntar manualmente la respuesta a tu evento.
Los cuerpos de respuesta con un tamaño superior a 0.15 MB no se agregan al objeto `Hint`.
Actualmente, a partir de la versión `9.0.0`, solo se admite la integración con `dio`.

<div id="screenshots">
  #### Capturas de pantalla
</div>

Las capturas de pantalla ahora se ocultan de forma predeterminada por motivos de privacidad.
Por ejemplo, los campos de texto se ocultan automáticamente para evitar la filtración de información sensible.
Consulta la guía [aquí](/es/platforms/dart/guides/flutter/enriching-events/screenshots/#redact-screenshots-via-masking) para obtener más información sobre cómo personalizar el enmascarado.

<div id="logging">
  #### Registro
</div>

El nivel de registro predeterminado ahora es `warning` cuando `debug = true`.
Puedes ajustarlo estableciendo `options.diagnosticLevel = SentryLevel.info` en `SentryFlutter.init`.

<div id="sdk-data-classes">
  #### Clases de datos del SDK
</div>

Las clases de datos del SDK ahora son mutables, lo que facilita su manipulación.
Por compatibilidad con versiones anteriores, `copyWith` y `clone` aún se pueden usar, pero están oficialmente obsoletos.

```dart
// antiguo
options.beforeSend = (event, hint) {
  event = event.copyWith(release: 'my-release');
  return event;
}

// nuevo
options.beforeSend = (event, hint) {
  event.release = 'my-release';
  return event;
}
```

<div id="flutter-desktop">
  ### Flutter Desktop
</div>

El manejo de fallos nativos ahora está habilitado de forma predeterminada para Flutter Desktop.
Windows ARM64 usa [breakpad](https://chromium.googlesource.com/breakpad/breakpad) y las demás plataformas de escritorio usan [crashpad](https://chromium.googlesource.com/crashpad/crashpad).
Puedes desactivar esta función estableciendo la variable de entorno `SENTRY_NATIVE_BACKEND` en &quot;none&quot;. p. ej., `export SENTRY_NATIVE_BACKEND=none`

Si tienes algún problema, consulta la [guía de solución de problemas](/es/platforms/dart/guides/flutter/troubleshooting/#issues-with-native-crashes-on-linux-andor-windows).

<div id="flutter-web">
  ### Flutter Web
</div>

La interoperabilidad con el [Sentry Browser JavaScript SDK](/es/platforms/javascript/) ahora está habilitada de forma predeterminada.
Durante `SentryFlutter.init`, el SDK inyectará el script del CDN en la sección head del HTML.
Este cambio nos permite aprovechar funcionalidades existentes del SDK, como los errores nativos de JS, incorporar nuevas características como el estado de salud de las versiones y facilita desarrollar funciones como los IDs de depuración en el futuro.

Si inicializas los SDK nativos por separado con `options.autoInitializeNativeSdk = false`, también tendrás que agregar el Sentry Browser JavaScript SDK a la sección head del HTML de tu sitio web.
[Lee esta guía](/es/platforms/javascript/install/loader/#cdn) sobre cómo instalar el SDK en tu aplicación mediante paquetes de CDN.

<div id="drift-integration">
  ### Integración con Drift
</div>

Hemos actualizado la versión requerida de Drift a `2.24.0` y hemos cambiado la API para usar la integración.
En lugar de un `SentryQueryExecutor`, Sentry ahora proporciona un `SentryQueryInterceptor` que puedes usar de la siguiente manera:

```dart
final executor = NativeDatabase.memory().interceptWith(
  SentryQueryInterceptor(databaseName: 'nombre_de_tu_bd')
);
```

Para más información sobre cómo usar `QueryInterceptor`, consulta la [documentación de Drift](https://drift.simonbinder.eu/examples/tracing/).

<div id="migrating-from-sentry_flutter-618x-to-sentry_flutter-700">
  ## Migración de `sentry_flutter` `6.18.x` a `sentry_flutter` `7.0.0`
</div>

Además de los cambios introducidos en [sentry](/es/platforms/dart/migration/):

Cambios en la API:

* La versión 7.0.0 y posteriores del SDK de Flutter de Sentry requiere Flutter `3.0.0`.
* [`sentry_dio`](https://pub.dev/packages/sentry_dio), versión 7.0.0, requiere [`dio 5.0.0`](https://pub.dev/packages/dio).
* El SDK de Cocoa de Sentry se actualizó a la versión `8.0.0`, lo que introduce cambios incompatibles; consulta la [guía de migración](/es/platforms/apple/migration/#migrating-from-7x-to-8x).
* Se eliminaron los siguientes campos de la clase `SentryFlutterOptions` y se reemplazaron:
  * `enableAutoPerformanceTracking` se reemplazó por `enableAutoPerformanceTracing`.
  * `enableOutOfMemoryTracking` se reemplazó por `enableWatchdogTerminationTracking`.
  * `anrTimeoutIntervalMillis` se reemplazó por `anrTimeoutInterval`.
  * `autoSessionTrackingIntervalMillis` se reemplazó por `autoSessionTrackingInterval`.
* La opción `enableNdkScopeSync` ahora está habilitada de forma predeterminada.

<div id="migrating-from-sentry_flutter-612x-to-sentry_flutter-613x">
  ## Migración de `sentry_flutter` `6.12.x` a `sentry_flutter` `6.13.x`
</div>

El SDK ya ejecuta tu `callback` de inicialización en un controlador de errores, como [`runZonedGuarded`](https://api.flutter.dev/flutter/dart-async/runZonedGuarded.html) en versiones de Flutter anteriores a `3.3`, o [`PlatformDispatcher.onError`](https://api.flutter.dev/flutter/dart-ui/PlatformDispatcher/onError.html) en Flutter `3.3` y posteriores, para capturar automáticamente los errores. No necesitas hacer cambios en tu código.

<div id="migrating-from-sentry_flutter-65x-to-sentry_flutter-66x">
  ## Migrar de `sentry_flutter` `6.5.x` a `sentry_flutter` `6.6.x`
</div>

No hay cambios disruptivos específicos de Flutter. Sin embargo, sí los hay en [Sentry](/es/platforms/dart/migration/) para Dart.

<div id="migrating-from-sentry_flutter-63x-to-sentry_flutter-64x">
  ## Migración de `sentry_flutter` `6.3.x` a `sentry_flutter` `6.4.x`
</div>

Para compilar una app de Flutter para Android, se requiere Kotlin 1.5.31 o superior.
Si tu app usa una versión anterior, recibirás el siguiente [mensaje de error](https://docs.flutter.dev/release/breaking-changes/kotlin-version#summary).

<div id="migrating-from-sentry_flutter-51x-to-sentry_flutter-600">
  ## Migración de `sentry_flutter` `5.1.x` a `sentry_flutter` `6.0.0`
</div>

No hay cambios de ruptura específicos de Flutter. Sin embargo, sí los hay en [sentry](/es/platforms/dart/migration/) para Dart.

<div id="migrating-from-sentry_flutter-500-to-sentry_flutter-510">
  ## Migración de `sentry_flutter` `5.0.0` a `sentry_flutter` `5.1.0`
</div>

<div id="android-specific-changes">
  # Cambios específicos de Android
</div>

Puedes eliminar los metadatos `android:extractNativeLibs="true"` en el archivo `AndroidManifest` o `android.bundle.enableUncompressedNativeLibs=false` en el archivo `gradle.properties` si usas el [Android Native Development Kit](/es/platforms/android/configuration/using-ndk/). Sentry ahora puede simbolizar eventos con el valor predeterminado de [extractNativeLibs](https://developer.android.com/studio/releases/gradle-plugin#extractNativeLibs) y [android.bundle.enableUncompressedNativeLibs](https://developer.android.com/studio/releases/gradle-plugin#behavior-changes).

Un installationId generado aleatoriamente reemplaza [Settings.Secure.ANDROID&#95;ID](https://developer.android.com/reference/android/provider/Settings.Secure#ANDROID_ID), que se ha eliminado. Esto puede afectar la cantidad de usuarios únicos que se muestran en la página de Issues y en Alerts. Si siempre asignas un usuario personalizado con Sentry.setUser(customUser), el comportamiento no ha cambiado. Aunque no necesitas realizar ninguna actualización, si quieres mantener el comportamiento anterior, usa el siguiente fragmento de código.
Hace uso del plugin [device&#95;info&#95;plus](https://pub.dev/packages/device_info_plus):

```dart
import 'package:flutter/foundation.dart';
import 'package:device_info_plus/device_info_plus.dart';
import 'package:sentry_flutter/sentry_flutter.dart';

Future<void> main() async {
  await SentryFlutter.init(
    (options) {
      options.dsn = '___PUBLIC_DSN___';
      // volver al comportamiento anterior en Android
      if (defaultTargetPlatform == TargetPlatform.android && !kIsWeb) {
        options.addEventProcessor(addAndroidDeviceId);
      }
    },
    // Inicializa tu aplicación.
    appRunner: () => runApp(MyApp()),
  );
}

FutureOr<SentryEvent?> addAndroidId(
  SentryEvent event, {
  Hint? hint,
}) async {
  var info = await DeviceInfoPlugin().androidInfo;
  var user = (event.user ?? SentryUser()).copyWith(id: info.androidId);

  return event.copyWith(
    user: user,
  );
}
```

<div id="migrating-from-sentry_flutter-40x-to-sentry_flutter-500">
  ## Migración de `sentry_flutter` `4.0.x` a `sentry_flutter` `5.0.0`
</div>

Además de los cambios introducidos en [sentry](/es/platforms/dart/migration/):

* `SentryFlutterOptions.enableLifecycleBreadcrumbs` se reemplazó por `SentryFlutterOptions.enableAppLifecycleBreadcrumbs`.
* La importación de Web Plugin Registrant cambió de `import 'package:sentry_flutter/src/sentry_flutter_web.dart';` a `import 'package:sentry_flutter/sentry_flutter_web.dart';`
  * Este cambio podría introducir incompatibilidades. No obstante, en la mayoría de los casos no será así, ya que el archivo que lo referencia se genera automáticamente.