---
title: Opciones de Symfony
description: "Conoce la integración de Sentry con Symfony y sus opciones."
sidebar_order: 1
---

Además de la [configuración disponible en el SDK de PHP](../options/), hay algunas opciones específicas de Symfony.

Toda la configuración de Symfony se realiza en `config/packages/sentry.yaml`.

{/* <!-- prettier-ignore --> */}

```yaml {filename:config/packages/sentry.yaml}
sentry:
    dsn: "___PUBLIC_DSN___"
    register_error_listener: true
    register_error_handler: true
    options:
        integrations:
            - "sentry.integration.my_custom_integration"
        prefixes:
            - "/local_dir/"
        sample_rate: 1
        traces_sample_rate: 1
        traces_sampler: "sentry.callback.traces_sampler"
        profiles_sample_rate: 1
        attach_stacktrace: true
        attach_metric_code_locations: true
        context_lines: 5
        environment: "%kernel.environment%"
        logger: "php"
        spotlight: true
        spotlight_url: "http://localhost:8969"
        release: "5.0.x-dev"
        server_name: "localhost"
        ignore_exceptions:
            - "Symfony\\Component\\HttpKernel\\Exception\\BadRequestHttpException"
        ignore_transactions:
            - "GET /health"
        enable_logs: true
        before_send_log: "sentry.callback.before_send_log"
        before_send: "sentry.callback.before_send"
        before_send_transaction: "sentry.callback.before_send_transaction"
        trace_propagation_targets:
          - 'example.com'
        tags:
            tag1: "value1"
            tag2: "value2"
        error_types: "E_ALL & ~E_NOTICE"
        max_breadcrumbs: 50
        before_breadcrumb: "sentry.callback.before_breadcrumb"
        in_app_exclude:
            - '%kernel.cache_dir%'
        in_app_include:
            - '%kernel.project_dir%'
        send_default_pii: true
        max_value_length: 1024
        transport: "sentry.transport"
        transport: "sentry.http_client"
        http_proxy: "proxy.example.com:8080"
        http_proxy_authentication: "user:password"
        http_connect_timeout: 15
        http_timeout: 10
        http_ssl_verify_peer: true
        http_compression: true
        capture_silenced_errors: true
        max_request_body_size: "medium"
        class_serializers:
            App\User: "App\\Sentry\\Serializer\\UserSerializer"
    messenger:
        enabled: true
        capture_soft_fails: false
        isolate_breadcrumbs_by_message: false

    tracing:
        enabled: true
        dbal:
            enabled: true
            connections:
                - default
        twig:
            enabled: true
        cache:
            enabled: true
        http_client:
            enabled: true
        console:
            excluded_commands:
                - app:command
```

La opción DSN es la única obligatoria: establece el DSN de Sentry y, por tanto, envía todos los eventos al proyecto correspondiente. Si se deja vacía, desactiva el envío de informes a Sentry.

Todas las configuraciones posibles bajo la clave `options` se mapean directamente a las opciones correspondientes del SDK base; puedes leer más al respecto en la [documentación de configuración general](../options/).

A continuación encontrarás documentación adicional específica para el uso del bundle, así como información sobre los valores predeterminados adecuados que puedes usar en algunos casos.


<div id="environment">
  ## `environment`
</div>

La opción `environment` usa, por defecto, el mismo entorno que tu aplicación de Symfony.

<div id="in_app_exclude">
  ## `in_app_exclude`
</div>

La opción `in_app_exclude` se usa para marcar archivos como ajenos al código fuente de tu aplicación en las trazas de pila de los eventos.
En este paquete tiene tres valores predeterminados:

- `%kernel.build_dir%`, para excluir el directorio de compilación de Symfony
- `%kernel.cache_dir%`, para excluir el directorio de caché de Symfony
- `%kernel.project_dir%/vendor`, para excluir las dependencias de Composer

<div id="callables">
  ## Callables
</div>

Las opciones `before_breadcrumb`, `before_send`, `before_send_transaction` y `traces_sampler` aceptan un `callable`; por lo tanto, no puedes proporcionarlo directamente en un archivo YAML. El bundle acepta una referencia de servicio, que puedes definir en tu contenedor DIC así:

{/* <!-- prettier-ignore --> */}

```yaml {filename:config/packages/sentry.yaml}
sentry:
    options:
        before_send: 'sentry.callback.before_send'

services:
    sentry.callback.before_send:
        class: 'App\Service\Sentry'
        factory: [ '@App\Service\Sentry', 'getBeforeSend' ]
```

El servicio necesario para la opción `before_breadcrumb` puede implementarse de la siguiente manera:

```php {filename:src/Service/Sentry.php}
<?php

namespace App\Service;

class Sentry
{
    public function getBeforeSend(): callable
    {
        return function(\Sentry\Event $event, ?\Sentry\EventHint $hint): ?\Sentry\Event {
            return $event;
        };
    }
}
```
