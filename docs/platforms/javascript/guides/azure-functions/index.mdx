---
title: Azure Functions
description: Learn how to manually set up Sentry in your Azure Functions and capture your first errors.
sdk: sentry.javascript.astro
categories:
  - javascript
  - server
  - server-node
  - serverless
---

<PlatformContent includePath="getting-started-prerequisites" />

## Step 1: Install

Choose the features you want to configure, and this guide will show you how:

<OnboardingOptionButtons
  options={["error-monitoring", "performance", "profiling", "logs"]}
/>

<PlatformContent includePath="getting-started-features-expandable" />

### Install the Sentry SDK

Run the command for your preferred package manager to add `@sentry/node` as a runtime dependency to your application:

<PlatformContent includePath="getting-started-install" />

## Step 2: Configure

Make sure to initialize Sentry at the top of your function file before importing any other modules:

```javascript {tabTitle:async}
const Sentry = require("@sentry/node");
// ___PRODUCT_OPTION_START___ profiling
const { nodeProfilingIntegration } = require("@sentry/profiling-node");

// ___PRODUCT_OPTION_END___ profiling
Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Adds request headers and IP for users, for more info visit:
  // https://docs.sentry.io/platforms/javascript/guides/azure-functions/configuration/options/#sendDefaultPii
  sendDefaultPii: true,
  // ___PRODUCT_OPTION_START___ profiling

  integrations: [nodeProfilingIntegration()],
  // ___PRODUCT_OPTION_END___ profiling
  // ___PRODUCT_OPTION_START___ performance

  // Add Performance Monitoring by setting tracesSampleRate
  // Set tracesSampleRate to 1.0 to capture 100% of transactions
  // We recommend adjusting this value in production
  // Learn more at
  // https://docs.sentry.io/platforms/javascript/configuration/options/#traces-sample-rate
  tracesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ performance
  // ___PRODUCT_OPTION_START___ profiling

  // Set sampling rate for profiling - this is relative to tracesSampleRate
  profilesSampleRate: 1.0,
  // ___PRODUCT_OPTION_END___ profiling
  // ___PRODUCT_OPTION_START___ logs

  // Enable logs to be sent to Sentry
  enableLogs: true,
  // ___PRODUCT_OPTION_END___ logs
});

// your function code
```

### Capture Errors

Because Azure Functions are short-lived, you have to explicitly `flush` Sentry events after calling `captureException`, or they may be lost before being sent to Sentry.

```javascript {tabTitle:async}
const Sentry = require("@sentry/node");

// your Sentry init code

module.exports = async function (context, req) {
  try {
    // Your function code
  } catch (e) {
    // use Sentry.withScope to enrich the event with request data
    Sentry.withScope((scope) => {
      // Attach request context (requires sendDefaultPii: true)
      scope.setSDKProcessingMetadata({ request: req });
      Sentry.captureException(e);
    });
    await Sentry.flush(2000);
  }
  // ...
};
```

## Step 3: Add Readable Stack Traces With Source Maps (Optional)

<PlatformContent includePath="getting-started-sourcemaps-short-version" />

## Step 4: Verify Your Setup

Let's test your setup and confirm that Sentry is working correctly and sending data to your Sentry project.

### Issues

First, let's verify that Sentry captures errors and creates issues in your Sentry project. Add an intentional error in your function:

```javascript {tabTitle:async}
const Sentry = require("@sentry/node");

module.exports = async function (context, req) {
  try {
    // This function does not exist, triggering an error
    await notExistFunction();
  } catch (e) {
    Sentry.withScope((scope) => {
      scope.setSDKProcessingMetadata({ request: req });
      Sentry.captureException(e);
    });
  }

  // Wait for the event to be sent before the function execution ends
  await Sentry.flush(2000);

  context.res = {
    status: 500,
    body: "Test error sent to Sentry.",
  };
};
```

Deploy and trigger your function to throw an error.

<OnboardingOption optionId="performance">
### Tracing
To test tracing, update your function to include a custom span:

```javascript {tabTitle:async}
const Sentry = require("@sentry/node");

module.exports = async function (context, req) {
  await Sentry.startSpan({ name: "My Custom Span", op: "task" }, async () => {
    // Simulate some work
    await new Promise((resolve) => setTimeout(resolve, 100));
  });

  // Wait for the event to be sent before the function execution ends
  await Sentry.flush(2000);

  context.res = {
    status: 200,
    body: "Hello world!",
  };
};
```

Deploy and trigger your function to start a child span.

</OnboardingOption>

### View Captured Data in Sentry

Now, head over to your project on [Sentry.io](https://sentry.io/) to view the collected data (it takes a couple of moments for the data to appear).

<PlatformContent includePath="getting-started-verify-locate-data" />

## Next Steps

At this point, you should have integrated Sentry into your Azure Function and should already be sending data to your Sentry project.

Now's a good time to customize your setup and look into more advanced topics. Our next recommended steps for you are:

- Continue to <PlatformLink to="/configuration">customize your configuration</PlatformLink>
- Learn how to <PlatformLink to="/usage">manually capture errors</PlatformLink>
- Get familiar with [Sentry's product features](/) like tracing, insights, and alerts

<Expandable permalink={false} title="Are you having problems setting up the SDK?">
- Find various topics in <PlatformLink to="/troubleshooting">Troubleshooting</PlatformLink>
- [Get support](https://sentry.zendesk.com/hc/en-us/)

</Expandable>
