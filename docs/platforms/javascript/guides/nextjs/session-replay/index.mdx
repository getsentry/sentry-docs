---
title: Set Up Session Replay
sidebar_title: Session Replay
sidebar_order: 5
sidebar_section: features
description: "Learn how to enable Session Replay in your Next.js app."
---

<Include name="session-replay-web-report-bug.mdx" />

[Session Replay](/product/explore/session-replay/) helps you get to the root cause of an error or latency issue faster by providing you with a video-like reproduction of what was happening in the user's browser before, during, and after the issue.

By default, Session Replay masks all DOM text content, images, and user input. See <PlatformLink to="/session-replay/privacy">Session Replay Privacy</PlatformLink> for customization options.

## Pre-requisites

<PlatformContent includePath="session-replay/pre-requisites" />

## Install

<PlatformContent includePath="session-replay/install" />

### Canvas Recording

<Alert level="warning">
  There is currently no PII scrubbing in canvas recordings!
</Alert>

<SplitLayout>

<SplitSection>
<SplitSectionText>

#### Enable Canvas Recording

Add `replayCanvasIntegration()` to record HTML canvas elements. This is opt-in and tree-shaken if not used.

</SplitSectionText>
<SplitSectionCode>

<PlatformContent includePath="session-replay/setup-canvas" />

</SplitSectionCode>
</SplitSection>

<SplitSection>
<SplitSectionText>

#### 3D and WebGL Canvases

For 3D/WebGL canvases, enable manual snapshotting to avoid performance issues from `preserveDrawingBuffer`.

Call `snapshot()` inside your paint loop, in the same execution loop as draw commands.

</SplitSectionText>
<SplitSectionCode>

```typescript {filename:instrumentation-client.ts}
// Step 1: Enable manual snapshotting
Sentry.replayCanvasIntegration({
  enableManualSnapshot: true,
});

// Step 2: Call snapshot in your paint loop
function paint() {
  const canvasRef = document.querySelector("#my-canvas");
  Sentry.getClient()
    ?.getIntegrationByName("ReplayCanvas")
    ?.snapshot(canvasRef);
}
```

</SplitSectionCode>
</SplitSection>

</SplitLayout>

### Content Security Policy (CSP)

<SplitLayout>

<SplitSection>
<SplitSectionText>

#### Configure CSP for Replay

Session Replay uses a WebWorker for compression. Add these CSP entries to allow workers to load.

Safari versions â‰¤ 15.4 also need `child-src`.

</SplitSectionText>
<SplitSectionCode>

```text
worker-src 'self' blob:
child-src 'self' blob:
```

</SplitSectionCode>
</SplitSection>

</SplitLayout>

If you can't update CSP, see [custom compression worker](/platforms/javascript/session-replay/configuration/#using-a-custom-compression-worker).

## Sampling

Sampling controls how much traffic results in a Session Replay.

<SplitLayout>

<SplitSection>
<SplitSectionText>

#### Configure Sample Rates

- **`replaysSessionSampleRate`** - Percentage of sessions to record fully
- **`replaysOnErrorSampleRate`** - Percentage of sessions to record when an error occurs (buffers 1 minute before the error)

**Tip:** Keep `replaysOnErrorSampleRate` at `1.0` - error sessions provide the most debugging value.

</SplitSectionText>
<SplitSectionCode>

```typescript {filename:instrumentation-client.ts}
Sentry.init({
  dsn: "___PUBLIC_DSN___",

  // Capture 10% of all sessions
  replaysSessionSampleRate: 0.1,

  // Capture 100% of sessions with errors
  replaysOnErrorSampleRate: 1.0,

  integrations: [Sentry.replayIntegration()],
});
```

</SplitSectionCode>
</SplitSection>

</SplitLayout>

### Recommended Production Sample Rates

| Traffic Volume             | Session Rate | Error Rate |
| -------------------------- | ------------ | ---------- |
| **High** (100k+/day)       | `0.01` (1%)  | `1.0`      |
| **Medium** (10k-100k/day)  | `0.1` (10%)  | `1.0`      |
| **Low** (under 10k/day)    | `0.25` (25%) | `1.0`      |

## Verify

Set `replaysSessionSampleRate: 1.0` during testing. Open your app, interact with it, then check [**Replays**](https://sentry.io/orgredirect/organizations/:orgslug/replays/) in Sentry.

**For production:** Lower `replaysSessionSampleRate` but keep `replaysOnErrorSampleRate` at `1.0`.

## Next Steps

<PageGrid />
