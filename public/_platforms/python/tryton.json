{"key":"python.tryton","type":"framework","doc_link":"https://docs.sentry.io/platforms/python/guides/tryton/","name":"Tryton","aliases":[],"categories":[],"body":"<p>The Tryton integration adds support for the <a href=\"https://www.tryton.org/\">Tryton Framework Server</a>.</p>\n<p>To configure the SDK, initialize it with the integration in a custom wsgi.py script:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python highlight\"><code class=\"language-python\"><span class=\"token comment\"># wsgi.py</span>\n<span class=\"token keyword\">import</span> sentry_sdk\n<span class=\"token keyword\">import</span> sentry_sdk<span class=\"token punctuation\">.</span>integrations<span class=\"token punctuation\">.</span>trytond\n\nsentry_sdk<span class=\"token punctuation\">.</span>init<span class=\"token punctuation\">(</span>\n    dsn<span class=\"token operator\">=</span><span class=\"token string\">\"___PUBLIC_DSN___\"</span><span class=\"token punctuation\">,</span>\n    integrations<span class=\"token operator\">=</span><span class=\"token punctuation\">[</span>\n        sentry_sdk<span class=\"token punctuation\">.</span>integrations<span class=\"token punctuation\">.</span>trytond<span class=\"token punctuation\">.</span>TrytondWSGIIntegration<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n\n    <span class=\"token comment\"># Set traces_sample_rate to 1.0 to capture 100%</span>\n    <span class=\"token comment\"># of transactions for performance monitoring.</span>\n    <span class=\"token comment\"># We recommend adjusting this value in production,</span>\n    traces_sample_rate<span class=\"token operator\">=</span><span class=\"token number\">1.0</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">from</span> trytond<span class=\"token punctuation\">.</span>application <span class=\"token keyword\">import</span> app <span class=\"token keyword\">as</span> application\n\n<span class=\"token comment\"># ...</span></code></pre></div>\n<p>In Tryton&gt;=5.4 an error handler can be registered to respond the client\nwith a custom error message including the Sentry event id instead of a traceback.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python highlight\"><code class=\"language-python\"><span class=\"token comment\"># wsgi.py</span>\n<span class=\"token comment\"># ...</span>\n\n<span class=\"token keyword\">from</span> trytond<span class=\"token punctuation\">.</span>exceptions <span class=\"token keyword\">import</span> TrytonException\n<span class=\"token keyword\">from</span> trytond<span class=\"token punctuation\">.</span>exceptions <span class=\"token keyword\">import</span> UserError\n\n<span class=\"token decorator annotation punctuation\">@application<span class=\"token punctuation\">.</span>error_handler</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">_</span><span class=\"token punctuation\">(</span>app<span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token builtin\">isinstance</span><span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">,</span> TrytonException<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span>\n    <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n        event_id <span class=\"token operator\">=</span> sentry_sdk<span class=\"token punctuation\">.</span>last_event_id<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        data <span class=\"token operator\">=</span> UserError<span class=\"token punctuation\">(</span><span class=\"token string\">'Custom message'</span><span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>event_id<span class=\"token punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>e<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span> app<span class=\"token punctuation\">.</span>make_response<span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">)</span>\n</code></pre></div>"}