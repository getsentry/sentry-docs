{"key":"python.tracing","type":"language","doc_link":"https://docs.sentry.io/platforms/python/performance/","name":"Python","aliases":[],"categories":[],"body":"<p>The Sentry SDK for Python does a very good job of auto instrumenting your application. Here a short introduction on how to do custom performance instrumentation. If you'd like to learn more, read our <a href=\"https://docs.sentry.io/platforms/python/performance/instrumentation/custom-instrumentation/\">custom instrumentation</a> documentation.</p>\n<p><strong>Adding a Transaction</strong></p>\n<p>Adding transactions will allow you to instrument and capture certain regions of your code.</p>\n<note>\n<p>If you're using one of Sentry's SDK integrations, transactions will be created for you automatically.</p>\n</note>\n<p>The following example creates a transaction for an expensive operation (in this case,<code>eat_pizza</code>), and then sends the result to Sentry:</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python highlight\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sentry_sdk\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_slice</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_pizza</span><span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> sentry_sdk<span class=\"token punctuation\">.</span>start_transaction<span class=\"token punctuation\">(</span>op<span class=\"token operator\">=</span><span class=\"token string\">\"task\"</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Eat Pizza\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> pizza<span class=\"token punctuation\">.</span>slices <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            eat_slice<span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">.</span>slices<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><strong>Adding More Spans to the Transaction</strong></p>\n<p>If you want to have more fine-grained performance monitoring, you can add child spans to your transaction, which can be done by either:</p>\n<ul>\n<li>Using a context manager or</li>\n<li>Using a decorator, (this works on sync and <code>async</code> functions)</li>\n</ul>\n<p>Calling a <code>sentry_sdk.start_span()</code> will find the current active transaction and attach the span to it.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python highlight\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sentry_sdk\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_slice</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_pizza</span><span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> sentry_sdk<span class=\"token punctuation\">.</span>start_transaction<span class=\"token punctuation\">(</span>op<span class=\"token operator\">=</span><span class=\"token string\">\"task\"</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Eat Pizza\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> pizza<span class=\"token punctuation\">.</span>slices <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            <span class=\"token keyword\">with</span> sentry_sdk<span class=\"token punctuation\">.</span>start_span<span class=\"token punctuation\">(</span>description<span class=\"token operator\">=</span><span class=\"token string\">\"Eat Slice\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                eat_slice<span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">.</span>slices<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python highlight\"><code class=\"language-python\"><span class=\"token keyword\">import</span> sentry_sdk\n\n<span class=\"token decorator annotation punctuation\">@sentry_sdk<span class=\"token punctuation\">.</span>trace</span>\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_slice</span><span class=\"token punctuation\">(</span><span class=\"token builtin\">slice</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">.</span>\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">eat_pizza</span><span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">with</span> sentry_sdk<span class=\"token punctuation\">.</span>start_transaction<span class=\"token punctuation\">(</span>op<span class=\"token operator\">=</span><span class=\"token string\">\"task\"</span><span class=\"token punctuation\">,</span> name<span class=\"token operator\">=</span><span class=\"token string\">\"Eat Pizza\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">while</span> pizza<span class=\"token punctuation\">.</span>slices <span class=\"token operator\">&gt;</span> <span class=\"token number\">0</span><span class=\"token punctuation\">:</span>\n            eat_slice<span class=\"token punctuation\">(</span>pizza<span class=\"token punctuation\">.</span>slices<span class=\"token punctuation\">.</span>pop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n</code></pre></div>"}